
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="褚成志">
      
      
        <link rel="canonical" href="http://blog.chucz.asia/Spring%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/Spring/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Spring - 褚成志的技术博客</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spring" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="褚成志的技术博客" class="md-header__button md-logo" aria-label="褚成志的技术博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            褚成志的技术博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Spring
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="褚成志的技术博客" class="md-nav__button md-logo" aria-label="褚成志的技术博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    褚成志的技术博客
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spring_1" class="md-nav__link">
    <span class="md-ellipsis">
      Spring系列 — 工厂
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring系列 — 工厂">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      第一章 引言
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第一章 引言">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ejb" class="md-nav__link">
    <span class="md-ellipsis">
      1. EJB存在的问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-spring" class="md-nav__link">
    <span class="md-ellipsis">
      2. 什么是Spring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 设计模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 工厂设计模式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 工厂设计模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 什么是工厂设计模式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 简单工厂的设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 通用工厂的设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 通用工厂的使用方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      5.总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_2" class="md-nav__link">
    <span class="md-ellipsis">
      第二章、第一个Spring程序
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章、第一个Spring程序">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 软件版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 环境搭建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-springapi" class="md-nav__link">
    <span class="md-ellipsis">
      3. Spring的核心API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_1" class="md-nav__link">
    <span class="md-ellipsis">
      4. 程序开发
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_1" class="md-nav__link">
    <span class="md-ellipsis">
      5. 细节分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-spring" class="md-nav__link">
    <span class="md-ellipsis">
      6. Spring工厂的底层实现原理(简易版)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      7. 思考
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring5x" class="md-nav__link">
    <span class="md-ellipsis">
      第三章、Spring5.x与日志框架的整合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#injection" class="md-nav__link">
    <span class="md-ellipsis">
      第四章、注入(Injection)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第四章、注入(Injection)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是注入
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 什么是注入">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 为什么需要注入
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 如何进行注入[开发步骤]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 注入好处
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-spring_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Spring注入的原理分析(简易版)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set" class="md-nav__link">
    <span class="md-ellipsis">
      第五章、Set注入详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第五章、Set注入详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-jdk" class="md-nav__link">
    <span class="md-ellipsis">
      1. JDK内置类型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. JDK内置类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-string8" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 String+8种基本类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 数组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-set" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Set集合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-list" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 List集合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-map" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 Map集合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-properites" class="md-nav__link">
    <span class="md-ellipsis">
      1.6 Properites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-jdk-date" class="md-nav__link">
    <span class="md-ellipsis">
      1.7 复杂的JDK类型 (Date)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. 用户自定义类型
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 用户自定义类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 第一种方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 第二种方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-set" class="md-nav__link">
    <span class="md-ellipsis">
      3. Set注入的简化写法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Set注入的简化写法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 基于属性简化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-p" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 基于p命名空间简化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      第六章、构造注入
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第六章、构造注入">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_2" class="md-nav__link">
    <span class="md-ellipsis">
      1. 开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 构造方法重载
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 构造方法重载">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_1" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 参数个数不同时
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21_2" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 构造参数个数相同时
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      3. 注入的总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      第七章、反转控制 与 依赖注入
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第七章、反转控制 与 依赖注入">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ioc-inverse-of-control" class="md-nav__link">
    <span class="md-ellipsis">
      1. 反转(转移)控制(IOC Inverse of Control)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-dependency-injection-di" class="md-nav__link">
    <span class="md-ellipsis">
      2. 依赖注入 (Dependency Injection DI)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_3" class="md-nav__link">
    <span class="md-ellipsis">
      第八章、Spring工厂创建复杂对象
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第八章、Spring工厂创建复杂对象">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_3" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是复杂对象
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-spring3" class="md-nav__link">
    <span class="md-ellipsis">
      2. Spring工厂创建复杂对象的3种方式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Spring工厂创建复杂对象的3种方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-factorybean" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 FactoryBean接口
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_1" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 实例工厂
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 静态工厂
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-spring" class="md-nav__link">
    <span class="md-ellipsis">
      3. Spring工厂创建对象的总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_4" class="md-nav__link">
    <span class="md-ellipsis">
      第九章、控制Spring工厂创建对象的次数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第九章、控制Spring工厂创建对象的次数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_4" class="md-nav__link">
    <span class="md-ellipsis">
      1. 如何控制简单对象的创建次数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_3" class="md-nav__link">
    <span class="md-ellipsis">
      2. 如何控制复杂对象的创建次数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      3. 为什么要控制对象的创建次数？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring_5" class="md-nav__link">
    <span class="md-ellipsis">
      Spring系列— 工厂高级特性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring系列— 工厂高级特性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      第十章、对象的生命周期
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第十章、对象的生命周期">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_5" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是对象的生命周期
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_4" class="md-nav__link">
    <span class="md-ellipsis">
      2. 为什么要学习对象的生命周期
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 生命周期的3个阶段
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      第十一章、配置文件参数化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第十一章、配置文件参数化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_6" class="md-nav__link">
    <span class="md-ellipsis">
      1. 配置文件参数的开发步骤
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      第十二章、自定义类型转换器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第十二章、自定义类型转换器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_7" class="md-nav__link">
    <span class="md-ellipsis">
      1. 类型转换器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_5" class="md-nav__link">
    <span class="md-ellipsis">
      2. 自定义类型转换器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 细节
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bean" class="md-nav__link">
    <span class="md-ellipsis">
      第十三章、后置处理Bean
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-aop" class="md-nav__link">
    <span class="md-ellipsis">
      Spring系列课程 — AOP编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring系列课程 — AOP编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      第一章、静态代理设计模式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第一章、静态代理设计模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_8" class="md-nav__link">
    <span class="md-ellipsis">
      1. 为什么需要代理设计模式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 为什么需要代理设计模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_6" class="md-nav__link">
    <span class="md-ellipsis">
      2. 代理设计模式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 代理设计模式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11_2" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12_2" class="md-nav__link">
    <span class="md-ellipsis">
      1.2名词解释
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13_1" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 代理开发的核心要素
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 编码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 静态代理存在的问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_6" class="md-nav__link">
    <span class="md-ellipsis">
      第二章、Spring的动态代理开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章、Spring的动态代理开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-spring" class="md-nav__link">
    <span class="md-ellipsis">
      1. Spring动态代理的概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_7" class="md-nav__link">
    <span class="md-ellipsis">
      2. 搭建开发环境
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-spring_1" class="md-nav__link">
    <span class="md-ellipsis">
      3. Spring动态代理的开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_2" class="md-nav__link">
    <span class="md-ellipsis">
      4. 动态代理细节分析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_7" class="md-nav__link">
    <span class="md-ellipsis">
      第三章、Spring动态代理详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第三章、Spring动态代理详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_9" class="md-nav__link">
    <span class="md-ellipsis">
      1. 额外功能的详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 额外功能的详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_3" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 切入点表达式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_2" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 切入点函数
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aop" class="md-nav__link">
    <span class="md-ellipsis">
      第四章、AOP编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第四章、AOP编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-aop" class="md-nav__link">
    <span class="md-ellipsis">
      1. AOP概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-aop" class="md-nav__link">
    <span class="md-ellipsis">
      2. AOP编程的开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_4" class="md-nav__link">
    <span class="md-ellipsis">
      3. 切面的名词解释
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aop_1" class="md-nav__link">
    <span class="md-ellipsis">
      第五章、AOP的底层实现原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第五章、AOP的底层实现原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_10" class="md-nav__link">
    <span class="md-ellipsis">
      1. 核心问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_8" class="md-nav__link">
    <span class="md-ellipsis">
      2. 动态代理类的创建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 动态代理类的创建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-jdk" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 JDK的动态代理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-cglib" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 CGlib的动态代理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-spring_2" class="md-nav__link">
    <span class="md-ellipsis">
      3. Spring工厂如何加工原始对象
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aop_2" class="md-nav__link">
    <span class="md-ellipsis">
      第六章、基于注解的AOP编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第六章、基于注解的AOP编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-aop_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 基于注解的AOP编程的开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_9" class="md-nav__link">
    <span class="md-ellipsis">
      2. 细节
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aop_3" class="md-nav__link">
    <span class="md-ellipsis">
      第七章、AOP开发中的一个坑
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aop_4" class="md-nav__link">
    <span class="md-ellipsis">
      第八章、AOP阶段知识总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring-" class="md-nav__link">
    <span class="md-ellipsis">
      Spring系列--- 注解编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring系列--- 注解编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      第一章、注解基础概念
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第一章、注解基础概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_11" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是注解编程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_10" class="md-nav__link">
    <span class="md-ellipsis">
      2. 为什么要讲解注解编程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_5" class="md-nav__link">
    <span class="md-ellipsis">
      3. 注解的作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-spring" class="md-nav__link">
    <span class="md-ellipsis">
      4. Spring注解的发展历程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-spring" class="md-nav__link">
    <span class="md-ellipsis">
      5. Spring注解开发的一个问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#springspring2x" class="md-nav__link">
    <span class="md-ellipsis">
      第二章、Spring的基础注解（Spring2.x）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章、Spring的基础注解（Spring2.x）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_12" class="md-nav__link">
    <span class="md-ellipsis">
      1. 对象创建相关注解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_11" class="md-nav__link">
    <span class="md-ellipsis">
      2. 注入相关注解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_6" class="md-nav__link">
    <span class="md-ellipsis">
      3. 注解扫描详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 注解扫描详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_13" class="md-nav__link">
    <span class="md-ellipsis">
      1. 排除方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_12" class="md-nav__link">
    <span class="md-ellipsis">
      2. 包含方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_3" class="md-nav__link">
    <span class="md-ellipsis">
      4. 对于注解开发的思考
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-ssm" class="md-nav__link">
    <span class="md-ellipsis">
      5. SSM整合开发（半注解开发）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#springspring3x" class="md-nav__link">
    <span class="md-ellipsis">
      第三章、Spring的高级注解（Spring3.x 及以上)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第三章、Spring的高级注解（Spring3.x 及以上)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bean" class="md-nav__link">
    <span class="md-ellipsis">
      1. 配置Bean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bean" class="md-nav__link">
    <span class="md-ellipsis">
      2. @Bean注解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. @Bean注解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bean_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. @Bean注解的基本使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bean_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. @Bean注解的注入
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-componentscan" class="md-nav__link">
    <span class="md-ellipsis">
      3. @ComponentScan注解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. @ComponentScan注解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_14" class="md-nav__link">
    <span class="md-ellipsis">
      1. 基本使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_13" class="md-nav__link">
    <span class="md-ellipsis">
      2. 排除、包含的使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-spring_1" class="md-nav__link">
    <span class="md-ellipsis">
      4. Spring工厂创建对象的多种配置方式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Spring工厂创建对象的多种配置方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_15" class="md-nav__link">
    <span class="md-ellipsis">
      1. 多种配置方式的应用场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_14" class="md-nav__link">
    <span class="md-ellipsis">
      2. 配置优先级
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_2" class="md-nav__link">
    <span class="md-ellipsis">
      5. 整合多个配置信息
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. 整合多个配置信息">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bean_2" class="md-nav__link">
    <span class="md-ellipsis">
      1. 多个配置Bean的整合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-beancomponent" class="md-nav__link">
    <span class="md-ellipsis">
      2. 配置Bean与@Component相关注解的整合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bean" class="md-nav__link">
    <span class="md-ellipsis">
      3. 配置Bean与配置文件整合
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-bean" class="md-nav__link">
    <span class="md-ellipsis">
      6. 配置Bean底层实现原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7_1" class="md-nav__link">
    <span class="md-ellipsis">
      7. 四维一体的开发思想
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. 四维一体的开发思想">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_16" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是四维一体
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_15" class="md-nav__link">
    <span class="md-ellipsis">
      2. 四维一体的开发案例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-aop" class="md-nav__link">
    <span class="md-ellipsis">
      8. 纯注解版AOP编程
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. 纯注解版AOP编程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_17" class="md-nav__link">
    <span class="md-ellipsis">
      1. 搭建环境
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_16" class="md-nav__link">
    <span class="md-ellipsis">
      2. 开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-aop" class="md-nav__link">
    <span class="md-ellipsis">
      3. 注解AOP细节分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aop" class="md-nav__link">
    <span class="md-ellipsis">
      4. 自定义注解实现AOP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      9. 纯注解版Spring+MyBatis整合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. 纯注解版Spring+MyBatis整合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-mapperlocations" class="md-nav__link">
    <span class="md-ellipsis">
      1. MapperLocations编码时通配的写法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bean_2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 配置Bean数据耦合的问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      10. 纯注解版事务编程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-springyml" class="md-nav__link">
    <span class="md-ellipsis">
      11. Spring框架中YML的使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11. Spring框架中YML的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-yml" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是YML
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-properties" class="md-nav__link">
    <span class="md-ellipsis">
      2. Properties进行配置问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-yml" class="md-nav__link">
    <span class="md-ellipsis">
      3. YML语法简介
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-springyml" class="md-nav__link">
    <span class="md-ellipsis">
      4. Spring与YML集成思路的分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-springyml" class="md-nav__link">
    <span class="md-ellipsis">
      5. Spring与YML集成编码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-springyml" class="md-nav__link">
    <span class="md-ellipsis">
      6. Spring与YML集成的问题
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional" class="md-nav__link">
    <span class="md-ellipsis">
      @Conditional注解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="@Conditional注解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditionalonbean-beanbean" class="md-nav__link">
    <span class="md-ellipsis">
      @ConditionalOnBean : 给定的在bean存在时,则实例化当前Bean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditionalonmissingbean-beanbean" class="md-nav__link">
    <span class="md-ellipsis">
      @ConditionalOnMissingBean: 当给定的在bean不存在时,则实例化当前Bean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditionalonclass-bean" class="md-nav__link">
    <span class="md-ellipsis">
      @ConditionalOnClass: 当给定的类名在类路径上存在，则实例化当前Bean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditionalonmissingclass-bean" class="md-nav__link">
    <span class="md-ellipsis">
      @ConditionalOnMissingClass :当给定的类名在类路径上不存在，则实例化当前Bean
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import" class="md-nav__link">
    <span class="md-ellipsis">
      @Import注解:给容器中注册组
    </span>
  </a>
  
    <nav class="md-nav" aria-label="@Import注解:给容器中注册组">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#import-importselector" class="md-nav__link">
    <span class="md-ellipsis">
      @import 中的属性 importselector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importbeandefinitionregistrar" class="md-nav__link">
    <span class="md-ellipsis">
      ImportBeanDefinitionRegistrar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#factorybean" class="md-nav__link">
    <span class="md-ellipsis">
      FactoryBean
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#springboot" class="md-nav__link">
    <span class="md-ellipsis">
      第四章 SpringBoot中的注解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第四章 SpringBoot中的注解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-enableconfigurationproperties" class="md-nav__link">
    <span class="md-ellipsis">
      1. @EnableConfigurationProperties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-configurationproperties" class="md-nav__link">
    <span class="md-ellipsis">
      2. @ConfigurationProperties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configurationpropertiesscan" class="md-nav__link">
    <span class="md-ellipsis">
      3. @ConfigurationPropertiesScan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-importresourcespring" class="md-nav__link">
    <span class="md-ellipsis">
      底层注解-@ImportResource导入Spring配置文件
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spring_8" class="md-nav__link">
    <span class="md-ellipsis">
      Spring系列 — 持久层整合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spring系列 — 持久层整合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      第一章、持久层整合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第一章、持久层整合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1spring" class="md-nav__link">
    <span class="md-ellipsis">
      1.Spring框架为什么要与持久层技术进行整合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-spring_2" class="md-nav__link">
    <span class="md-ellipsis">
      2. Spring可以与那些持久层技术进行整合？
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      第二章、Spring与MyBatis整合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第二章、Spring与MyBatis整合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-mybatis" class="md-nav__link">
    <span class="md-ellipsis">
      1. MyBatis开发步骤的回顾
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-mybatis" class="md-nav__link">
    <span class="md-ellipsis">
      2. Mybatis在开发过程中存在问题
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      3. Spring与Mybatis整合思路分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      4. Spring与Mybatis整合的开发步骤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      5. Spring与Mybatis整合编码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-springmybatis" class="md-nav__link">
    <span class="md-ellipsis">
      6. Spring与Mybatis整合细节
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spring_9" class="md-nav__link">
    <span class="md-ellipsis">
      第三章、Spring的事务处理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第三章、Spring的事务处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_18" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是事务？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_17" class="md-nav__link">
    <span class="md-ellipsis">
      2. 如何控制事务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3spring" class="md-nav__link">
    <span class="md-ellipsis">
      3.Spring控制事务的开发
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.Spring控制事务的开发">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_19" class="md-nav__link">
    <span class="md-ellipsis">
      1. 原始对象
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_18" class="md-nav__link">
    <span class="md-ellipsis">
      2. 额外功能
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_7" class="md-nav__link">
    <span class="md-ellipsis">
      3. 切入点
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_4" class="md-nav__link">
    <span class="md-ellipsis">
      4 组装切面
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-spring_2" class="md-nav__link">
    <span class="md-ellipsis">
      4. Spring控制事务的编码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#springtransaction-attribute" class="md-nav__link">
    <span class="md-ellipsis">
      第四章、 Spring中的事务属性(Transaction Attribute)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第四章、 Spring中的事务属性(Transaction Attribute)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_20" class="md-nav__link">
    <span class="md-ellipsis">
      1. 什么是事务属性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_19" class="md-nav__link">
    <span class="md-ellipsis">
      2. 如何添加事务属性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_8" class="md-nav__link">
    <span class="md-ellipsis">
      3. 事务属性详解
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 事务属性详解">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      1. 隔离属性 (ISOLATION)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-propagation" class="md-nav__link">
    <span class="md-ellipsis">
      2. 传播属性(PROPAGATION)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-readonly" class="md-nav__link">
    <span class="md-ellipsis">
      3. 只读属性(readOnly)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      4. 超时属性(timeout)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_3" class="md-nav__link">
    <span class="md-ellipsis">
      5. 异常属性
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4_5" class="md-nav__link">
    <span class="md-ellipsis">
      4. 事务属性常见配置总结
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5_4" class="md-nav__link">
    <span class="md-ellipsis">
      5. 基于标签的事务配置方式(事务开发的第二种形式)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. 基于标签的事务配置方式(事务开发的第二种形式)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="spring">Spring<a class="headerlink" href="#spring" title="Permanent link">&para;</a></h1>
<h3 id="spring_1">Spring系列 — 工厂<a class="headerlink" href="#spring_1" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="_1">第一章 引言<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<h5 id="1-ejb">1. EJB存在的问题<a class="headerlink" href="#1-ejb" title="Permanent link">&para;</a></h5>
<p><img alt="1641187076309-d53369a6-6c4c-4249-9a61-7eff0c209f70.png" src="../img/OXFJdF09t3S74GG_/1641187076309-d53369a6-6c4c-4249-9a61-7eff0c209f70-466065.png" /></p>
<h5 id="2-spring">2. 什么是Spring<a class="headerlink" href="#2-spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>Spring是一个轻量级的JavaEE解决方案，整合众多优秀的设计模式
</code></pre></div>
<ul>
<li>轻量级  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 对于运行环境是没有额外要求的
   开源 tomcat resion jetty 
   收费 weblogic  websphere 
<span class="k">2.</span> 代码移植性高
   不需要实现额外接口
</code></pre></div>
<ul>
<li>JavaEE的解决方案 </li>
</ul>
<p><img alt="1641187094024-4a43dd8f-9d31-424d-87d5-21e48554b58e.png" src="../img/OXFJdF09t3S74GG_/1641187094024-4a43dd8f-9d31-424d-87d5-21e48554b58e-279631.png" /></p>
<ul>
<li>整合设计模式</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 工厂
<span class="k">2.</span> 代理
<span class="k">3.</span> 模板
<span class="k">4.</span> 策略
</code></pre></div>
<h5 id="3">3. 设计模式<a class="headerlink" href="#3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 广义概念
面向对象设计中，解决特定问题的经典代码
<span class="k">2.</span> 狭义概念
GOF4人帮定义的23种设计模式：工厂、适配器、装饰器、门面、代理、模板...
</code></pre></div>
<h5 id="4">4. 工厂设计模式<a class="headerlink" href="#4" title="Permanent link">&para;</a></h5>
<h6 id="41">4.1 什么是工厂设计模式<a class="headerlink" href="#41" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 概念：通过工厂类，创建对象
        User user = new User();
        UserDAO userDAO = new UserDAOImpl();
<span class="k">2.</span> 好处：解耦合
   耦合：指定是代码间的强关联关系，一方的改变会影响到另一方
   问题：不利于代码维护
   简单：把接口的实现类，硬编码在程序中
        UserService userService = new UserServiceImpl();
</code></pre></div>
<h6 id="42">4.2 简单工厂的设计<a class="headerlink" href="#42" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.baizhiedu.basic</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.InputStream</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Properties</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BeanFactory</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Properties</span><span class="w"> </span><span class="n">env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>

<span class="w">    </span><span class="kd">static</span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//第一步 获得IO输入流</span>
<span class="w">            </span><span class="n">InputStream</span><span class="w"> </span><span class="n">inputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BeanFactory</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getResourceAsStream</span><span class="p">(</span><span class="s">&quot;/applicationContext.properties&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="c1">//第二步 文件内容 封装 Properties集合中 key = userService value = com.baizhixx.UserServiceImpl</span>
<span class="w">            </span><span class="n">env</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">inputStream</span><span class="p">);</span>

<span class="w">            </span><span class="n">inputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        对象的创建方式：</span>
<span class="cm">           1. 直接调用构造方法 创建对象  UserService userService = new UserServiceImpl();</span>
<span class="cm">           2. 通过反射的形式 创建对象 解耦合</span>
<span class="cm">               Class clazz = Class.forName(&quot;com.baizhiedu.basic.UserServiceImpl&quot;);</span>
<span class="cm">               UserService userService = (UserService)clazz.newInstance();</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="nf">getUserService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                         </span><span class="c1">//com.baizhiedu.basic.UserServiceImpl</span>
<span class="w">            </span><span class="n">Class</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;userService&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">userService</span><span class="p">;</span>

<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="nf">getUserDAO</span><span class="p">(){</span>

<span class="w">        </span><span class="n">UserDAO</span><span class="w"> </span><span class="n">userDAO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Class</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;userDAO&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">userDAO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserDAO</span><span class="p">)</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ClassNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">userDAO</span><span class="p">;</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h6 id="43">4.3 通用工厂的设计<a class="headerlink" href="#43" title="Permanent link">&para;</a></h6>
<ul>
<li>问题 <br />
<img alt="1641187126322-cd9321f7-58c0-46b2-a540-b630fc1941a2.png" src="../img/OXFJdF09t3S74GG_/1641187126322-cd9321f7-58c0-46b2-a540-b630fc1941a2-602839.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code>简单工厂会存在大量的代码冗余
</code></pre></div>
<ul>
<li>通用工厂的代码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">创建一切想要的对象</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BeanFactory</span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">key</span><span class="p">){</span>
<span class="w">         </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">         </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="n">Class</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">env</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
<span class="w">             </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">newInstance</span><span class="p">();</span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">         </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">     </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<h6 id="44">4.4 通用工厂的使用方式<a class="headerlink" href="#44" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 定义类型 (类)
<span class="k">2.</span> 通过配置文件的配置告知工厂(applicationContext.properties)
   key = value
<span class="k">3.</span> 通过工厂获得类的对象
   Object ret = BeanFactory.getBean(&quot;key&quot;)
</code></pre></div>
<h5 id="5">5.总结<a class="headerlink" href="#5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>Spring本质：工厂 ApplicationContext (applicationContext.xml)
</code></pre></div>
<h4 id="spring_2">第二章、第一个Spring程序<a class="headerlink" href="#spring_2" title="Permanent link">&para;</a></h4>
<h5 id="1">1. 软件版本<a class="headerlink" href="#1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> JDK1.8+
<span class="k">2.</span> Maven3.5+
<span class="k">3.</span> IDEA2018+
<span class="k">4.</span> SpringFramework 5.1.4 
   官方网站 www.spring.io
</code></pre></div>
<h5 id="2">2. 环境搭建<a class="headerlink" href="#2" title="Permanent link">&para;</a></h5>
<ul>
<li>Spring的jar包  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="gh">#设置pom 依赖</span>
&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-context --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework&lt;/groupId&gt;
  &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
  &lt;version&gt;5.1.4.RELEASE&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div>
<ul>
<li>Spring的配置文件 <br />
<img alt="1641187174783-2d807016-0907-488b-b349-bb1a4415a5f3.png" src="../img/OXFJdF09t3S74GG_/1641187174783-2d807016-0907-488b-b349-bb1a4415a5f3-145144.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 配置文件的放置位置：任意位置 没有硬性要求
<span class="k">2.</span> 配置文件的命名   ：没有硬性要求  建议：applicationContext.xml

思考：日后应用Spring框架时，需要进行配置文件路径的设置。
</code></pre></div>
<h5 id="3-springapi">3. Spring的核心API<a class="headerlink" href="#3-springapi" title="Permanent link">&para;</a></h5>
<ul>
<li>ApplicationContext  </li>
</ul>
<div class="highlight"><pre><span></span><code>作用：Spring提供的ApplicationContext这个工厂，用于对象的创建
好处：解耦合
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  ApplicationContext接口类型
</code></pre></div>
<p><img alt="1641187196099-71352767-9df4-44e2-8b4c-30bbf01c1887.png" src="../img/OXFJdF09t3S74GG_/1641187196099-71352767-9df4-44e2-8b4c-30bbf01c1887-401742.png" /></p>
<div class="highlight"><pre><span></span><code>接口：屏蔽实现的差异
非web环境 ： ClassPathXmlApplicationContext (main junit)
web环境  ：  XmlWebApplicationContext
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  重量级资源
</code></pre></div>
<div class="highlight"><pre><span></span><code>ApplicationContext工厂的对象占用大量内存。
不会频繁的创建对象 ： 一个应用只会创建一个工厂对象。
ApplicationContext工厂：一定是线程安全的(多线程并发访问)
</code></pre></div>
<h5 id="4_1">4. 程序开发<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 创建类型
<span class="k">2.</span> 配置文件的配置 applicationContext.xml
   &lt;bean id=&quot;person&quot; class=&quot;com.baizhiedu.basic.Person&quot;/&gt;
<span class="k">3.</span> 通过工厂类，获得对象
   ApplicationContext
          |- ClassPathXmlApplicationContext 
   ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;/applicationContext.xml&quot;);
   Person person = (Person)ctx.getBean(&quot;person&quot;);
</code></pre></div>
<h5 id="5_1">5. 细节分析<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h5>
<ul>
<li>名词解释  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring工厂创建的对象，叫做bean或者组件(componet)
</code></pre></div>
<ul>
<li>Spring工厂的相关的方法  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">//通过这种方式获得对象，就不需要强制类型转换</span>
<span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;person&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Person</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;person = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">person</span><span class="p">);</span>


<span class="c1">//当前Spring的配置文件中 只能有一个&lt;bean class是Person类型</span>
<span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">Person</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;person = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">person</span><span class="p">);</span>


<span class="c1">//获取的是 Spring工厂配置文件中所有bean标签的id值  person person1</span>
<span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beanDefinitionName = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="p">);</span>
<span class="p">}</span>


<span class="c1">//根据类型获得Spring配置文件中对应的id值</span>
<span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanNamesForType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">Person</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanNamesForType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;id = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="p">}</span>


<span class="c1">//用于判断是否存在指定id值得bean</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">containsBeanDefinition</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;true = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;false = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>


<span class="c1">//用于判断是否存在指定id值得bean</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="s">&quot;person&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;true = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;false = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>配置文件中需要注意的细节  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 只配置class属性
&lt;bean  class=&quot;com.baizhiedu.basic.Person&quot;/&gt;
a) 上述这种配置 有没有id值 com.baizhiedu.basic.Person#0
b) 应用场景： 如果这个bean只需要使用一次，那么就可以省略id值
            如果这个bean会使用多次，或者被其他bean引用则需要设置id值


<span class="k">2.</span> name属性
作用：用于在Spring的配置文件中，为bean对象定义别名(小名)
相同：
<span class="w">   </span><span class="k">1.</span> ctx.getBean(&quot;id|name&quot;)--&gt;object
<span class="w">   </span><span class="k">2.</span> &lt;bean id=&quot;&quot; class=&quot;&quot;
      等效
      &lt;bean name=&quot;&quot; class=&quot;&quot;
区别：
<span class="w">   </span><span class="k">1.</span> 别名可以定义多个,但是id属性只能有一个值
<span class="w">   </span><span class="k">2.</span> XML的id属性的值，命名要求：必须以字母开头，字母 数字 下划线 连字符 不能以特殊字符开头 /person
         name属性的值，命名没有要求 /person
      name属性会应用在特殊命名的场景下：/person (spring+struts1)

      XML发展到了今天：ID属性的限制，不存在 /person
<span class="w">   </span><span class="k">3.</span> 代码
         //用于判断是否存在指定id值得bean,不能判断name值
        if (ctx.containsBeanDefinition(&quot;person&quot;)) {
            System.out.println(&quot;true = &quot; + true);
        }else{
            System.out.println(&quot;false = &quot; + false);
        }


        //用于判断是否存在指定id值得bean,也可以判断name值
        if (ctx.containsBean(&quot;p&quot;)) {
            System.out.println(&quot;true = &quot; + true);
        }else{
            System.out.println(&quot;false = &quot; + false);
        }
</code></pre></div>
<h5 id="6-spring">6. Spring工厂的底层实现原理(简易版)<a class="headerlink" href="#6-spring" title="Permanent link">&para;</a></h5>
<p><strong>Spring工厂是可以调用对象私有的构造方法创建对象</strong></p>
<p><img alt="1641187213689-ff5a25a1-e35f-4c3a-9ed9-6202fbb27f98.png" src="../img/OXFJdF09t3S74GG_/1641187213689-ff5a25a1-e35f-4c3a-9ed9-6202fbb27f98-831626.png" /></p>
<h5 id="7">7. 思考<a class="headerlink" href="#7" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>问题：未来在开发过程中，是不是所有的对象，都会交给Spring工厂来创建呢？
回答：理论上 是的，但是有特例 ：实体对象(entity)是不会交给Spring创建，它是由持久层框架进行创建。
</code></pre></div>
<h4 id="spring5x">第三章、Spring5.x与日志框架的整合<a class="headerlink" href="#spring5x" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>Spring与日志框架进行整合，日志框架就可以在控制台中，输出Spring框架运行过程中的一些重要的信息。
好处：便于了解Spring框架的运行过程，利于程序的调试
</code></pre></div>
<ul>
<li>Spring如何整合日志框架  </li>
</ul>
<div class="highlight"><pre><span></span><code>默认
  Spring1.2.3早期都是于commons-logging.jar
  Spring5.x默认整合的日志框架 logback log4j2

Spring5.x整合log4j 
<span class="w">  </span><span class="k">1.</span> 引入log4j jar包
<span class="w">  </span><span class="k">2.</span> 引入log4.properties配置文件
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  pom
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.7.25<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>log4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>log4j<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.2.17<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  log4j.properties
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="gh"># resources文件夹根目录下</span>
<span class="gu">### 配置根</span>
log4j.rootLogger = debug,console

<span class="gu">### 日志输出到控制台显示</span>
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.Target=System.out
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n
</code></pre></div>
<h4 id="injection">第四章、注入(Injection)<a class="headerlink" href="#injection" title="Permanent link">&para;</a></h4>
<h5 id="1_1">1. 什么是注入<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>通过Spring工厂及配置文件，为所创建对象的成员变量赋值
</code></pre></div>
<h6 id="11">1.1 为什么需要注入<a class="headerlink" href="#11" title="Permanent link">&para;</a></h6>
<p><strong>通过编码的方式，为成员变量进行赋值，存在耦合</strong></p>
<p><img alt="1641187254314-6b7b11de-e574-4fee-ab0c-6c261af25fd9.png" src="../img/OXFJdF09t3S74GG_/1641187254314-6b7b11de-e574-4fee-ab0c-6c261af25fd9-936775.png" /></p>
<h6 id="12">1.2 如何进行注入[开发步骤]<a class="headerlink" href="#12" title="Permanent link">&para;</a></h6>
<ul>
<li>类的成员变量提供set get方法 </li>
<li>配置spring的配置文件  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;person&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.basic.Person&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;id&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;value&gt;</span>10<span class="nt">&lt;/value&gt;</span>
<span class="w">   </span><span class="nt">&lt;/property&gt;</span>
<span class="w">   </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;value&gt;</span>xiaojr<span class="nt">&lt;/value&gt;</span>
<span class="w">   </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<h6 id="13">1.3 注入好处<a class="headerlink" href="#13" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>解耦合
</code></pre></div>
<h5 id="2-spring_1">2. Spring注入的原理分析(简易版)<a class="headerlink" href="#2-spring_1" title="Permanent link">&para;</a></h5>
<p><strong>Spring通过底层调用对象属性对应的set方法，完成成员变量的赋值，这种方式我们也称之为set注入</strong></p>
<p><img alt="1641187275681-74d00444-ca5b-4c35-9d51-691613450d13.png" src="../img/OXFJdF09t3S74GG_/1641187275681-74d00444-ca5b-4c35-9d51-691613450d13-171406.png" /></p>
<h4 id="set">第五章、Set注入详解<a class="headerlink" href="#set" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>针对于不同类型的成员变量，在&lt;property&gt;标签，需要嵌套其他标签

&lt;property&gt;
    xxxxx
&lt;/property&gt;
</code></pre></div>
<p><img alt="1641187294550-64152dc7-3648-46db-82a4-929666d0d0df.png" src="../img/OXFJdF09t3S74GG_/1641187294550-64152dc7-3648-46db-82a4-929666d0d0df-625975.png" /></p>
<h5 id="1-jdk">1. JDK内置类型<a class="headerlink" href="#1-jdk" title="Permanent link">&para;</a></h5>
<h6 id="11-string8">1.1 String+8种基本类型<a class="headerlink" href="#11-string8" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>&lt;value&gt;suns&lt;/value&gt;
</code></pre></div>
<h6 id="12_1">1.2 数组<a class="headerlink" href="#12_1" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>&lt;list&gt;
  &lt;value&gt;suns@zparkhr.com.cn&lt;/value&gt;
  &lt;value&gt;liucy@zparkhr.com.cn&lt;/value&gt;
  &lt;value&gt;chenyn@zparkhr.com.cn&lt;/value&gt;
&lt;/list&gt;
</code></pre></div>
<h6 id="13-set">1.3 Set集合<a class="headerlink" href="#13-set" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;set&gt;</span>
<span class="w">   </span><span class="nt">&lt;value&gt;</span>11111<span class="nt">&lt;/value&gt;</span>
<span class="w">   </span><span class="nt">&lt;value&gt;</span>112222<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/set&gt;</span>

<span class="nt">&lt;set&gt;</span>
<span class="w">   </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="err">bean</span>
<span class="w">   </span><span class="err">&lt;set</span><span class="w"> </span>
<span class="err">&lt;/set</span><span class="nt">&gt;</span>
</code></pre></div>
<h6 id="14-list">1.4 List集合<a class="headerlink" href="#14-list" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;list&gt;</span>
<span class="w">   </span><span class="nt">&lt;value&gt;</span>11111<span class="nt">&lt;/value&gt;</span>
<span class="w">   </span><span class="nt">&lt;value&gt;</span>2222<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/list&gt;</span>

<span class="nt">&lt;list&gt;</span>
<span class="w">   </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="err">bean</span>
<span class="w">   </span><span class="err">&lt;set</span><span class="w"> </span>
<span class="err">&lt;/list</span><span class="nt">&gt;</span>
</code></pre></div>
<h6 id="15-map">1.5 Map集合<a class="headerlink" href="#15-map" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>注意：<span class="w"> </span>map<span class="w"> </span>--<span class="w"> </span>entry<span class="w">  </span>--<span class="w"> </span>key有特定的标签<span class="w">  </span><span class="nt">&lt;key&gt;&lt;/key&gt;</span>
<span class="w">                       </span>值根据对应类型选择对应类型的标签
<span class="nt">&lt;map&gt;</span>
<span class="w">  </span><span class="nt">&lt;entry&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;&lt;value&gt;</span>suns<span class="nt">&lt;/value&gt;&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>3434334343<span class="nt">&lt;/value&gt;</span>
<span class="w">  </span><span class="nt">&lt;/entry&gt;</span>
<span class="w">  </span><span class="nt">&lt;entry&gt;</span>
<span class="w">    </span><span class="nt">&lt;key&gt;&lt;value&gt;</span>chenyn<span class="nt">&lt;/value&gt;&lt;/key&gt;</span>
<span class="w">    </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="err">bean</span>
<span class="w">  </span><span class="err">&lt;/entry</span><span class="nt">&gt;</span>
<span class="nt">&lt;/map&gt;</span>
</code></pre></div>
<h6 id="16-properites">1.6 Properites<a class="headerlink" href="#16-properites" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>Properties类型 特殊的Map key=String value=String
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;props&gt;</span>
<span class="w">  </span><span class="nt">&lt;prop</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;key1&quot;</span><span class="nt">&gt;</span>value1<span class="nt">&lt;/prop&gt;</span>
<span class="w">  </span><span class="nt">&lt;prop</span><span class="w"> </span><span class="na">key=</span><span class="s">&quot;key2&quot;</span><span class="nt">&gt;</span>value2<span class="nt">&lt;/prop&gt;</span>
<span class="nt">&lt;/props&gt;</span>
</code></pre></div>
<h6 id="17-jdk-date">1.7 复杂的JDK类型 (Date)<a class="headerlink" href="#17-jdk-date" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>需要程序员自定义类型转换器，处理。
</code></pre></div>
<h5 id="2_1">2. 用户自定义类型<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h5>
<h6 id="21">2.1 第一种方式<a class="headerlink" href="#21" title="Permanent link">&para;</a></h6>
<ul>
<li>为成员变量提供set get方法 </li>
<li>配置文件中进行注入(赋值)  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxxx.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">&gt;</span>
<span class="w">       </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.UserDAOImpl&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<h6 id="22">2.2 第二种方式<a class="headerlink" href="#22" title="Permanent link">&para;</a></h6>
<ul>
<li>第一种赋值方式存在的问题  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 配置文件代码冗余
<span class="k">2.</span> 被注入的对象(UserDAO),多次创建，浪费（JVM)内存资源
</code></pre></div>
<ul>
<li>为成员变量提供set get方法 </li>
<li>配置文件中进行配置       </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.UserDAOImpl&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

#Spring4.x<span class="w"> </span>废除了<span class="w"> </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">local=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span><span class="w"> </span>基本等效<span class="w"> </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h5 id="3-set">3. Set注入的简化写法<a class="headerlink" href="#3-set" title="Permanent link">&para;</a></h5>
<h6 id="31">3.1 基于属性简化<a class="headerlink" href="#31" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>JDK类型注入<span class="w"> </span>
<span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;value&gt;</span>suns<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>

<span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;suns&quot;</span><span class="nt">/&gt;</span>
注意：value属性<span class="w"> </span>只能简化<span class="w"> </span>8种基本类型+String<span class="w"> </span>注入标签

用户自定义类型
<span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/property&gt;</span>

<span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h6 id="32-p">3.2 基于p命名空间简化<a class="headerlink" href="#32-p" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>JDK类型注入<span class="w"> </span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;person&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxxx.Person&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;value&gt;</span>suns<span class="nt">&lt;/value&gt;</span>
<span class="w">  </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;person&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.Person&quot;</span><span class="w"> </span><span class="na">p:name=</span><span class="s">&quot;suns&quot;</span><span class="nt">/&gt;</span>
注意：value属性<span class="w"> </span>只能简化<span class="w"> </span>8种基本类型+String<span class="w"> </span>注入标签

用户自定义类型
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xx.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.UserServiceImpl&quot;</span><span class="w"> </span><span class="na">p:userDAO-ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h4 id="_2">第六章、构造注入<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>注入：通过Spring的配置文件，为成员变量赋值
Set注入：Spring调用Set方法 通过配置文件 为成员变量赋值
构造注入：Spring调用构造方法 通过配置文件 为成员变量赋值
</code></pre></div>
<h5 id="1_2">1. 开发步骤<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h5>
<ul>
<li>提供有参构造方法  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Customer</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serializable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Customer</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">age</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>Spring的配置文件  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;customer&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.basic.constructer.Customer&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;constructor-arg&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>suns<span class="nt">&lt;/value&gt;</span>
<span class="w">  </span><span class="nt">&lt;/constructor-arg&gt;</span>
<span class="w">  </span><span class="nt">&lt;constructor-arg&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>102<span class="nt">&lt;/value&gt;</span>
<span class="w">  </span><span class="nt">&lt;/constructor-arg&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<h5 id="2_2">2. 构造方法重载<a class="headerlink" href="#2_2" title="Permanent link">&para;</a></h5>
<h6 id="21_1">2.1 参数个数不同时<a class="headerlink" href="#21_1" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>通过控制&lt;constructor-arg&gt;标签的数量进行区分
</code></pre></div>
<h6 id="21_2">2.1 构造参数个数相同时<a class="headerlink" href="#21_2" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>通过在标签引入 type属性 进行类型的区分 &lt;constructor-arg type=&quot;&quot;&gt;
</code></pre></div>
<h5 id="3_1">3. 注入的总结<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>未来的实战中，应用set注入还是构造注入？
答案：set注入更多 
<span class="w">       </span><span class="k">1.</span> 构造注入麻烦 (重载)
<span class="w">       </span><span class="k">2.</span> Spring框架底层 大量应用了 set注入
</code></pre></div>
<p><img alt="1641191561101-2094e326-82ee-4826-902b-3e391c8a010a.png" src="../img/OXFJdF09t3S74GG_/1641191561101-2094e326-82ee-4826-902b-3e391c8a010a-279974.png" /></p>
<h4 id="_3">第七章、反转控制 与 依赖注入<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<h5 id="1-ioc-inverse-of-control">1. 反转(转移)控制(IOC Inverse of Control)<a class="headerlink" href="#1-ioc-inverse-of-control" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>控制：对于成员变量赋值的控制权
反转控制：把对于成员变量赋值的控制权，从代码中反转(转移)到Spring工厂和配置文件中完成
   好处：解耦合
底层实现：工厂设计模式
</code></pre></div>
<p><img alt="1641191273492-c8a275c6-77f3-4712-a64e-c067987b478d.png" src="../img/OXFJdF09t3S74GG_/1641191273492-c8a275c6-77f3-4712-a64e-c067987b478d-925051.png" /></p>
<h5 id="2-dependency-injection-di">2. 依赖注入 (Dependency Injection  DI)<a class="headerlink" href="#2-dependency-injection-di" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>注入：通过Spring的工厂及配置文件，为对象（bean，组件）的成员变量赋值

依赖注入：当一个类需要另一个类时，就意味着依赖，一旦出现依赖，就可以把另一个类作为本类的成员变量，最终通过Spring配置文件进行注入(赋值)。
   好处：解耦合
</code></pre></div>
<p><img alt="1641191285271-12fb568a-9acc-4dd2-a8c0-4d4f7a3a1801.png" src="../img/OXFJdF09t3S74GG_/1641191285271-12fb568a-9acc-4dd2-a8c0-4d4f7a3a1801-485921.png" /></p>
<h4 id="spring_3">第八章、Spring工厂创建复杂对象<a class="headerlink" href="#spring_3" title="Permanent link">&para;</a></h4>
<p><img alt="1641191292838-bee78694-7ac1-4b3f-81d7-a3e53f812ecb.png" src="../img/OXFJdF09t3S74GG_/1641191292838-bee78694-7ac1-4b3f-81d7-a3e53f812ecb-994814.png" /></p>
<h5 id="1_3">1. 什么是复杂对象<a class="headerlink" href="#1_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>复杂对象：指的就是不能直接通过new构造方法创建的对象
  Connection
  SqlSessionFactory
</code></pre></div>
<h5 id="2-spring3">2. Spring工厂创建复杂对象的3种方式<a class="headerlink" href="#2-spring3" title="Permanent link">&para;</a></h5>
<h6 id="21-factorybean">2.1 FactoryBean接口<a class="headerlink" href="#21-factorybean" title="Permanent link">&para;</a></h6>
<ul>
<li>开发步骤 <ul>
<li>实现FactoryBean接口<br />
<img alt="1641191445084-7ddfff74-b3a7-4f9e-a4a2-9e54cdcef30d.png" src="../img/OXFJdF09t3S74GG_/1641191445084-7ddfff74-b3a7-4f9e-a4a2-9e54cdcef30d-515121.png" /></li>
<li>Spring配置文件的配置  </li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span>如果Class中指定的类型<span class="w"> </span>是FactoryBean接口的实现类，那么通过id值获得的是这个类所创建的复杂对象<span class="w">  </span>Connection
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;conn&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.factorybean.ConnectionFactoryBean&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ul>
<li>细节 <ul>
<li>如果就想获得FactoryBean类型的对象   ctx.getBean("&amp;conn")<br />
获得就是ConnectionFactoryBean对象 </li>
<li>isSingleton方法<br />
返回  true 只会创建一个复杂对象<br />
返回 false 每一次都会创建新的对象<br />
问题：根据这个对象的特点 ，决定是返回true (SqlSessionFactory) 还是 false  (Connection) </li>
<li>mysql高版本连接创建时，需要制定SSL证书，解决问题的方式  </li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code>url = &quot;jdbc:mysql://localhost:3306/suns?useSSL=false&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  依赖注入的体会(DI)
</code></pre></div>
<div class="highlight"><pre><span></span><code>把ConnectionFactoryBean中依赖的4个字符串信息 ，进行配置文件的注入 
好处：解耦合
&lt;bean id=&quot;conn&quot; class=&quot;com.baizhiedu.factorybean.ConnectionFactoryBean&quot;&gt;
  &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
  &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/suns?useSSL=false&quot;/&gt;
  &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
  &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;
&lt;/bean&gt;
</code></pre></div>
<ul>
<li>FactoryBean的实现原理[简易版] <br />
<img alt="1641191497756-f7a09498-526c-4860-9ead-16e0609ec292.png" src="../img/OXFJdF09t3S74GG_/1641191497756-f7a09498-526c-4860-9ead-16e0609ec292-630192.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code>接口回调
1.<span class="w"> </span>为什么Spring规定FactoryBean接口<span class="w"> </span>实现<span class="w"> </span>并且<span class="w"> </span>getObject()?
2.<span class="w"> </span>ctx.getBean(&quot;conn&quot;)<span class="w"> </span>获得是复杂对象<span class="w"> </span>Connection<span class="w"> </span>而没有<span class="w"> </span>获得<span class="w"> </span>ConnectionFactoryBean(<span class="err">&amp;</span>)

Spring内部运行流程
1.<span class="w"> </span>通过conn获得<span class="w"> </span>ConnectionFactoryBean类的对象<span class="w"> </span>，进而通过instanceof<span class="w"> </span>判断出是FactoryBean接口的实现类
2.<span class="w"> </span>Spring按照规定<span class="w"> </span>getObject()<span class="w"> </span>---&gt;<span class="w"> </span>Connection
3.<span class="w"> </span>返回Connection
</code></pre></div>
<ul>
<li>FactoryBean总结  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring中用于创建复杂对象的一种方式，也是Spring原生提供的，后续讲解Spring整合其他框架，大量应用FactoryBean
</code></pre></div>
<h6 id="22_1">2.2 实例工厂<a class="headerlink" href="#22_1" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 避免Spring框架的侵入 
<span class="k">2.</span> 整合遗留系统
</code></pre></div>
<ul>
<li>开发步骤</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;connFactory&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.factorybean.ConnectionFactory&quot;</span><span class="nt">&gt;&lt;/bean&gt;</span>

<span class="w"> </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;conn&quot;</span><span class="w">  </span><span class="na">factory-bean=</span><span class="s">&quot;connFactory&quot;</span><span class="w"> </span><span class="na">factory-method=</span><span class="s">&quot;getConnection&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h6 id="23">2.3 静态工厂<a class="headerlink" href="#23" title="Permanent link">&para;</a></h6>
<ul>
<li>开发步骤  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;conn&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.factorybean.StaticConnectionFactory&quot;</span><span class="w"> </span><span class="na">factory-method=</span><span class="s">&quot;getConnection&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h5 id="3-spring">3. Spring工厂创建对象的总结<a class="headerlink" href="#3-spring" title="Permanent link">&para;</a></h5>
<p><img alt="1641191536457-42256956-5608-4d4b-ae12-e128e16f5fdb.png" src="../img/OXFJdF09t3S74GG_/1641191536457-42256956-5608-4d4b-ae12-e128e16f5fdb-705327.png" /></p>
<h4 id="spring_4">第九章、控制Spring工厂创建对象的次数<a class="headerlink" href="#spring_4" title="Permanent link">&para;</a></h4>
<h5 id="1_4">1. 如何控制简单对象的创建次数<a class="headerlink" href="#1_4" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;account&quot;</span><span class="w"> </span><span class="na">scope=</span><span class="s">&quot;singleton|prototype&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxxx.Account&quot;</span><span class="nt">/&gt;</span>
sigleton:只会创建一次简单对象<span class="w"> </span>默认值
prototype:每一次都会创建新的对象
</code></pre></div>
<h5 id="2_3">2. 如何控制复杂对象的创建次数<a class="headerlink" href="#2_3" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>FactoryBean{
   isSingleton(){
      return true  只会创建一次
      return false 每一次都会创建新的
   }

}
如没有isSingleton方法 还是通过scope属性 进行对象创建次数的控制
</code></pre></div>
<h5 id="3_2">3. 为什么要控制对象的创建次数？<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>好处：节省不别要的内存浪费
</code></pre></div>
<ul>
<li>什么样的对象只创建一次？  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> SqlSessionFactory
<span class="k">2.</span> DAO
<span class="k">3.</span> Service
</code></pre></div>
<ul>
<li>什么样的对象 每一次都要创建新的？  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> Connection
<span class="k">2.</span> SqlSession | Session
<span class="k">3.</span> Struts2 Action
</code></pre></div>
<h3 id="spring_5">Spring系列— 工厂高级特性<a class="headerlink" href="#spring_5" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="_4">第十章、对象的生命周期<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p><img alt="1641191720610-87c903df-8180-4796-98f0-2143ee795bf6.png" src="../img/OXFJdF09t3S74GG_/1641191720610-87c903df-8180-4796-98f0-2143ee795bf6-378517.png" /></p>
<h5 id="1_5">1. 什么是对象的生命周期<a class="headerlink" href="#1_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>指的是一个对象创建、存活、消亡的一个完整过程
</code></pre></div>
<h5 id="2_4">2. 为什么要学习对象的生命周期<a class="headerlink" href="#2_4" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>由Spring负责对象的创建、存活、销毁，了解生命周期，有利于我们使用好Spring为我们创建的对象
</code></pre></div>
<h5 id="3-3">3. 生命周期的3个阶段<a class="headerlink" href="#3-3" title="Permanent link">&para;</a></h5>
<ul>
<li>创建阶段  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring工厂何时创建对象
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  scope=&quot;singleton&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code>Spring工厂创建的同时，对象的创建

注意：设置scope=singleton 这种情况下 也需要在获取对象的同时，创建对象 
&lt;bean lazy-init=&quot;true&quot;/&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  scope=&quot;prototype&quot;
</code></pre></div>
<div class="highlight"><pre><span></span><code>Spring工厂会在获取对象的同时，创建对象
ctx.getBean(&quot;&quot;)
</code></pre></div>
<ul>
<li>初始化阶段  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring工厂在创建完对象后，调用对象的初始化方法，完成对应的初始化操作

<span class="k">1.</span> 初始化方法提供：程序员根据需求，提供初始化方法，最终完成初始化操作
<span class="k">2.</span> 初始化方法调用：Spring工厂进行调用
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  InitializingBean接口
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">//程序员根据需求，实现的方法，完成初始化操作</span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">afterProperitesSet</span><span class="p">(){</span>

<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  对象中提供一个普通的方法
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">myInit</span><span class="p">(){</span>

<span class="p">}</span>

<span class="o">&lt;</span><span class="n">bean</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&quot;product&quot;</span><span class="w"> </span><span class="kd">class</span><span class="err">=&quot;</span><span class="nc">xxx</span><span class="p">.</span><span class="na">Product</span><span class="s">&quot; init-method=&quot;</span><span class="n">myInit</span><span class="s">&quot;/&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  细节分析 
    1.  如果一个对象即实现InitializingBean 同时又提供的 普通的初始化方法  顺序
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> InitializingBean 
<span class="k">2.</span> 普通初始化方法
</code></pre></div>
<div class="highlight"><pre><span></span><code>    2.  注入一定发生在初始化操作的前面 
    3.  什么叫做初始化操作
</code></pre></div>
<div class="highlight"><pre><span></span><code>资源的初始化：数据库 IO 网络 .....
</code></pre></div>
<ul>
<li>销毁阶段  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring销毁对象前，会调用对象的销毁方法，完成销毁操作

<span class="k">1.</span> Spring什么时候销毁所创建的对象？
   ctx.close();
<span class="k">2.</span> 销毁方法：程序员根据自己的需求，定义销毁方法，完成销毁操作
      调用：Spring工厂完成调用
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  DisposableBean
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">destroy</span><span class="p">()</span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  定义一个普通的销毁方法
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">myDestroy</span><span class="p">()</span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">{</span>

<span class="p">}</span>
<span class="o">&lt;</span><span class="n">bean</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="kd">class</span><span class="err">=&quot;&quot;</span> <span class="nc">init</span><span class="o">-</span><span class="n">method</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="n">destroy</span><span class="o">-</span><span class="n">method</span><span class="o">=</span><span class="s">&quot;myDestroy&quot;</span><span class="o">/&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  细节分析 
    1.  销毁方法的操作只适用于 scope=&quot;singleton&quot; 
    2.  什么叫做销毁操作
</code></pre></div>
<div class="highlight"><pre><span></span><code>主要指的就是 资源的释放操作  io.close() connection.close();
</code></pre></div>
<h4 id="_5">第十一章、配置文件参数化<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>把Spring配置文件中需要经常修改的字符串信息，转移到一个更小的配置文件中

<span class="k">1.</span> Spring的配置文件中存在需要经常修改的字符串？
   存在 以数据库连接相关的参数 代表
<span class="k">2.</span> 经常变化字符串，在Spring的配置文件中，直接修改
   不利于项目维护(修改)
<span class="k">3.</span> 转移到一个小的配置文件(.properties)
   利于维护(修改)

配置文件参数化：利于Spring配置文件的维护(修改)
</code></pre></div>
<h5 id="1_6">1. 配置文件参数的开发步骤<a class="headerlink" href="#1_6" title="Permanent link">&para;</a></h5>
<ul>
<li>提供一个小的配置文件(.properities)  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="na">名字：随便</span>
<span class="na">放置位置：随便</span>

<span class="na">jdbc.driverClassName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">com.mysql.jdbc.Driver</span>
<span class="na">jdbc.url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">jdbc:mysql://localhost:3306/suns?useSSL=false</span>
<span class="na">jdbc.username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">root</span>
<span class="na">jdbc.password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">123456</span>
</code></pre></div>
<ul>
<li>Spring的配置文件与小配置文件进行整合  </li>
</ul>
<div class="highlight"><pre><span></span><code>applicationContext.xml
<span class="nt">&lt;context:property-placeholder</span><span class="w"> </span><span class="na">location=</span><span class="s">&quot;classpath:/db.properties&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ul>
<li>在Spring配置文件中通过${key}获取小配置文件中对应的值<br />
<img alt="1641191805166-5172ebe1-32bd-4cd7-a29d-bca4e28032b5.png" src="../img/OXFJdF09t3S74GG_/1641191805166-5172ebe1-32bd-4cd7-a29d-bca4e28032b5-432111.png" /></li>
</ul>
<h4 id="_6">第十二章、自定义类型转换器<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<h5 id="1_7">1. 类型转换器<a class="headerlink" href="#1_7" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>作用：Spring通过类型转换器把配置文件中字符串类型的数据，转换成了对象中成员变量对应类型的数据，进而完成了注入
</code></pre></div>
<p><img alt="1641191825136-73ef847c-8f5f-4f6d-af81-992c7d88f3de.png" src="../img/OXFJdF09t3S74GG_/1641191825136-73ef847c-8f5f-4f6d-af81-992c7d88f3de-402038.png" /></p>
<h5 id="2_5">2. 自定义类型转换器<a class="headerlink" href="#2_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>原因：当Spring内部没有提供特定类型转换器时，而程序员在应用的过程中还需要使用，那么就需要程序员自己定义类型转换器
</code></pre></div>
<ul>
<li>类 implements Converter接口  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyDateConverter</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Converter</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Date</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="cm">/*</span>
<span class="cm">       convert方法作用：String ---&gt;  Date</span>
<span class="cm">                      SimpleDateFormat sdf = new SimpleDateFormat();</span>
<span class="cm">                      sdf.parset(String) ---&gt; Date</span>
<span class="cm">       param:source 代表的是配置文件中 日期字符串 &lt;value&gt;2020-10-11&lt;/value&gt;</span>

<span class="cm">       return : 当把转换好的Date作为convert方法的返回值后，Spring自动的为birthday属性进行注入（赋值）</span>

<span class="cm">     */</span>

<span class="w">  </span><span class="nd">@Override</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">SimpleDateFormat</span><span class="w"> </span><span class="n">sdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleDateFormat</span><span class="p">(</span><span class="s">&quot;yyyy-MM-dd&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdf</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">date</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>在Spring的配置文件中进行配置 <ul>
<li>MyDateConverter对象创建出来  </li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;myDateConverter&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxxx.MyDateConverter&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  类型转换器的注册
</code></pre></div>
<div class="highlight"><pre><span></span><code>目的：告知Spring框架，我们所创建的MyDateConverter是一个类型转换器
<span class="cm">&lt;!--用于注册类型转换器--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;conversionService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;converters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;set&gt;</span>
<span class="w">      </span><span class="nt">&lt;ref</span><span class="w"> </span><span class="na">bean=</span><span class="s">&quot;myDateConverter&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/set&gt;</span>
<span class="w">  </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<h5 id="3_3">3. 细节<a class="headerlink" href="#3_3" title="Permanent link">&para;</a></h5>
<ul>
<li>MyDateConverter中的日期的格式，通过依赖注入的方式，由配置文件完成赋值。   </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyDateConverter</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Converter</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Date</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">pattern</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getPattern</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pattern</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPattern</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">pattern</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pattern</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">       convert方法作用：String ---&gt;  Date</span>
<span class="cm">                      SimpleDateFormat sdf = new SimpleDateFormat();</span>
<span class="cm">                      sdf.parset(String) ---&gt; Date</span>
<span class="cm">       param:source 代表的是配置文件中 日期字符串 &lt;value&gt;2020-10-11&lt;/value&gt;</span>

<span class="cm">       return : 当把转换好的Date作为convert方法的返回值后，Spring自动的为birthday属性进行注入（赋值）</span>

<span class="cm">     */</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">Date</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SimpleDateFormat</span><span class="w"> </span><span class="n">sdf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleDateFormat</span><span class="p">(</span><span class="n">pattern</span><span class="p">);</span>
<span class="w">            </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sdf</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">date</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!--Spring创建MyDateConverter类型对象--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;myDateConverter&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.converter.MyDateConverter&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;pattern&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;yyyy-MM-dd&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<ul>
<li>ConversionSeviceFactoryBean 定义 id属性 值必须 conversionService </li>
<li>Spring框架内置日期类型的转换器  </li>
</ul>
<div class="highlight"><pre><span></span><code>日期格式：2020/05/01 (不支持 ：2020-05-01)
</code></pre></div>
<h4 id="bean">第十三章、后置处理Bean<a class="headerlink" href="#bean" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>BeanPostProcessor作用：对Spring工厂所创建的对象，进行再加工。

AOP底层实现：

注意：BeanPostProcessor接口
          xxxx(){


          }
</code></pre></div>
<ul>
<li>后置处理Bean的运行原理分析<br />
<img alt="1641191857446-f68c5c75-4b35-4d2e-917d-1e7da478a34b.png" src="../img/OXFJdF09t3S74GG_/1641191857446-f68c5c75-4b35-4d2e-917d-1e7da478a34b-380695.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code>程序员实现BeanPostProcessor规定接口中的方法：

Object postProcessBeforeInitiallization(Object bean String beanName)
作用：Spring创建完对象，并进行注入后，可以运行Before方法进行加工
获得Spring创建好的对象 ：通过方法的参数
最终通过返回值交给Spring框架 

Object postProcessAfterInitiallization(Object bean String beanName)
作用：Spring执行完对象的初始化操作后，可以运行After方法进行加工
获得Spring创建好的对象 ：通过方法的参数
最终通过返回值交给Spring框架 

实战中：
很少处理Spring的初始化操作：没有必要区分Before After。只需要实现其中的一个After方法即可
注意：
    postProcessBeforeInitiallization
    return bean对象
</code></pre></div>
<ul>
<li>BeanPostProcessor的开发步骤 <ol>
<li>类 实现 BeanPostProcessor接口  </li>
</ol>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyBeanPostProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">postProcessBeforeInitialization</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">postProcessAfterInitialization</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">Categroy</span><span class="w"> </span><span class="n">categroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Categroy</span><span class="p">)</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
<span class="w">        </span><span class="n">categroy</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;xiaowb&quot;</span><span class="p">);</span>


<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">categroy</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>2.  Spring的配置文件中进行配置
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;myBeanPostProcessor&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;xxx.MyBeanPostProcessor&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>3.  BeanPostProcessor细节
</code></pre></div>
<div class="highlight"><pre><span></span><code>BeanPostProcessor会对Spring工厂中所有创建的对象进行加工。
</code></pre></div>
<h3 id="spring-aop">Spring系列课程 — AOP编程<a class="headerlink" href="#spring-aop" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="_7">第一章、静态代理设计模式<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<h5 id="1_8">1. 为什么需要代理设计模式<a class="headerlink" href="#1_8" title="Permanent link">&para;</a></h5>
<h6 id="11_1">1.1 问题<a class="headerlink" href="#11_1" title="Permanent link">&para;</a></h6>
<ul>
<li>在JavaEE分层开发开发中，那个层次对于我们来讲最重要  </li>
</ul>
<div class="highlight"><pre><span></span><code>DAO ---&gt; Service --&gt; Controller 

JavaEE分层开发中，最为重要的是Service层
</code></pre></div>
<ul>
<li>Service层中包含了哪些代码？  </li>
</ul>
<div class="highlight"><pre><span></span><code>Service层中 = 核心功能(几十行 上百代码) + 额外功能(附加功能)
<span class="k">1.</span> 核心功能
   业务运算
   DAO调用
<span class="k">2.</span> 额外功能 
<span class="w">   </span><span class="k">1.</span> 不属于业务
<span class="w">   </span><span class="k">2.</span> 可有可无
<span class="w">   </span><span class="k">3.</span> 代码量很小 

   事务、日志、性能...
</code></pre></div>
<ul>
<li>额外功能书写在Service层中好不好？  </li>
</ul>
<div class="highlight"><pre><span></span><code>Service层的调用者的角度（Controller):需要在Service层书写额外功能。
                         软件设计者：Service层不需要额外功能
</code></pre></div>
<ul>
<li>现实生活中的解决方式<br />
<img alt="1641192046925-24f98b5c-cffb-4577-97c3-b3f5390d48a8.png" src="../img/OXFJdF09t3S74GG_/1641192046925-24f98b5c-cffb-4577-97c3-b3f5390d48a8-705872.png" /></li>
</ul>
<h5 id="2_6">2. 代理设计模式<a class="headerlink" href="#2_6" title="Permanent link">&para;</a></h5>
<h6 id="11_2">1.1 概念<a class="headerlink" href="#11_2" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>通过代理类，为原始类（目标）增加额外的功能
好处：利于原始类(目标)的维护
</code></pre></div>
<h6 id="12_2">1.2名词解释<a class="headerlink" href="#12_2" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 目标类 原始类 
   指的是 业务类 (核心功能 --&gt; 业务运算 DAO调用)
<span class="k">2.</span> 目标方法，原始方法
   目标类(原始类)中的方法 就是目标方法(原始方法)
<span class="k">3.</span> 额外功能 (附加功能)
   日志，事务，性能
</code></pre></div>
<h6 id="13_1">1.3 代理开发的核心要素<a class="headerlink" href="#13_1" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>代理类 = 目标类(原始类) + 额外功能 + 原始类(目标类)实现相同的接口

房东 ---&gt; public interface UserService{
               m1
               m2
          }
          UserServiceImpl implements UserService{
               m1 ---&gt; 业务运算 DAO调用
               m2 
          }
          UserServiceProxy implements UserService
               m1
               m2
</code></pre></div>
<h6 id="14">1.4 编码<a class="headerlink" href="#14" title="Permanent link">&para;</a></h6>
<p><strong>静态代理</strong>：为每一个原始类，手工编写一个代理类 (.java .class)</p>
<p><img alt="1641192076991-308a5833-52ce-4d23-b1bd-b77b5191d178.png" src="../img/OXFJdF09t3S74GG_/1641192076991-308a5833-52ce-4d23-b1bd-b77b5191d178-577645.png" /></p>
<h6 id="15">1.5 静态代理存在的问题<a class="headerlink" href="#15" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 静态类文件数量过多，不利于项目管理
   UserServiceImpl  UserServiceProxy
   OrderServiceImpl OrderServiceProxy
<span class="k">2.</span> 额外功能维护性差
   代理类中 额外功能修改复杂(麻烦)
</code></pre></div>
<h4 id="spring_6">第二章、Spring的动态代理开发<a class="headerlink" href="#spring_6" title="Permanent link">&para;</a></h4>
<h5 id="1-spring">1. Spring动态代理的概念<a class="headerlink" href="#1-spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>概念：通过代理类为原始类(目标类)增加额外功能
好处：利于原始类(目标类)的维护
</code></pre></div>
<h5 id="2_7">2. 搭建开发环境<a class="headerlink" href="#2_7" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>spring-aop<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>5.1.14.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.aspectj<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>aspectjrt<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.8.8<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.aspectj<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>aspectjweaver<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.8.3<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<h5 id="3-spring_1">3. Spring动态代理的开发步骤<a class="headerlink" href="#3-spring_1" title="Permanent link">&para;</a></h5>
<ol>
<li>创建原始对象(目标对象)   </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;UserServiceImpl.register 业务运算 + DAO &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;UserServiceImpl.login&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.proxy.UserServiceImpl&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ol>
<li>额外功能<br />
MethodBeforeAdvice接口    </li>
</ol>
<div class="highlight"><pre><span></span><code>额外的功能书写在接口的实现中，运行在原始方法执行之前运行额外功能。
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Before</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">MethodBeforeAdvice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">      作用：需要把运行在原始方法执行之前运行的额外功能，书写在before方法中</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">before</span><span class="p">(</span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----method before advice log------&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;before&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.dynamic.Before&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ol>
<li>定义切入点   </li>
</ol>
<div class="highlight"><pre><span></span><code>切入点：额外功能加入的位置

目的：由程序员根据自己的需要，决定额外功能加入给那个原始方法
register
login

简单的测试：所有方法都做为切入点，都加入额外的功能。
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;aop:config&gt;</span>
<span class="w">   </span><span class="nt">&lt;aop:pointcut</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;pc&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;execution(* *(..))&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/aop:config&gt;</span>
</code></pre></div>
<ol>
<li>组装 (2 3整合)  </li>
</ol>
<div class="highlight"><pre><span></span><code>表达的含义：所有的方法<span class="w"> </span>都加入<span class="w"> </span>before的额外功能
<span class="nt">&lt;aop:advisor</span><span class="w"> </span><span class="na">advice-ref=</span><span class="s">&quot;before&quot;</span><span class="w"> </span><span class="na">pointcut-ref=</span><span class="s">&quot;pc&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ol>
<li>调用  </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">目的</span><span class="err">：</span><span class="n">获得Spring工厂创建的动态代理对象</span><span class="err">，</span><span class="n">并进行调用</span>
<span class="n">ApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassPathXmlApplicationContext</span><span class="p">(</span><span class="s">&quot;/applicationContext.xml&quot;</span><span class="p">);</span>
<span class="n">注意</span><span class="err">：</span>
<span class="w">   </span><span class="mf">1.</span><span class="w"> </span><span class="n">Spring的工厂通过原始对象的id值获得的是代理对象</span>
<span class="w">   </span><span class="mf">2.</span><span class="w"> </span><span class="n">获得代理对象后</span><span class="err">，</span><span class="n">可以通过声明接口类型</span><span class="err">，</span><span class="n">进行对象的存储</span>

<span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="o">=</span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;userService&quot;</span><span class="p">);</span>

<span class="n">userService</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">userService</span><span class="p">.</span><span class="na">register</span><span class="p">()</span>
</code></pre></div>
<h5 id="4_2">4. 动态代理细节分析<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h5>
<ol>
<li>Spring创建的动态代理类在哪里？ <br />
<img alt="1641192116208-9d3b69bd-a1dc-4c7c-b463-ee7bb5c37053.png" src="../img/OXFJdF09t3S74GG_/1641192116208-9d3b69bd-a1dc-4c7c-b463-ee7bb5c37053-194015.png" /></li>
</ol>
<div class="highlight"><pre><span></span><code>Spring框架在运行时，通过动态字节码技术，在JVM创建的，运行在JVM内部，等程序结束后，会和JVM一起消失

什么叫动态字节码技术:通过第三个动态字节码框架，在JVM中创建对应类的字节码，进而创建对象，当虚拟机结束，动态字节码跟着消失。

结论：动态代理不需要定义类文件，都是JVM运行过程中动态创建的，所以不会造成静态代理，类文件数量过多，影响项目管理的问题。
</code></pre></div>
<div class="highlight"><pre><span></span><code>2.  动态代理编程简化代理的开发
</code></pre></div>
<div class="highlight"><pre><span></span><code>在额外功能不改变的前提下，创建其他目标类（原始类）的代理对象时，只需要指定原始(目标)对象即可。
</code></pre></div>
<div class="highlight"><pre><span></span><code>3.  动态代理额外功能的维护性大大增强
</code></pre></div>
<h4 id="spring_7">第三章、Spring动态代理详解<a class="headerlink" href="#spring_7" title="Permanent link">&para;</a></h4>
<h5 id="1_9">1. 额外功能的详解<a class="headerlink" href="#1_9" title="Permanent link">&para;</a></h5>
<ul>
<li>MethodBeforeAdvice分析  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">MethodBeforeAdvice接口作用</span><span class="err">：</span><span class="n">额外功能运行在原始方法执行之前</span><span class="err">，</span><span class="n">进行额外功能操作</span><span class="err">。</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Before1</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">MethodBeforeAdvice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">      作用：需要把运行在原始方法执行之前运行的额外功能，书写在before方法中</span>

<span class="cm">      Method: 额外功能所增加给的那个原始方法</span>
<span class="cm">              login方法</span>

<span class="cm">              register方法</span>

<span class="cm">              showOrder方法</span>

<span class="cm">      Object[]: 额外功能所增加给的那个原始方法的参数。String name,String password</span>
<span class="cm">                                               User</span>

<span class="cm">       Object: 额外功能所增加给的那个原始对象  UserServiceImpl</span>
<span class="cm">                                          OrderServiceImpl</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">before</span><span class="p">(</span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----new method before advice log------&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">before方法的3个参数在实战中</span><span class="err">，</span><span class="n">该如何使用</span><span class="err">。</span>
<span class="w">   </span><span class="n">before方法的参数</span><span class="err">，</span><span class="n">在实战中</span><span class="err">，</span><span class="n">会根据需要进行使用</span><span class="err">，</span><span class="n">不一定都会用到</span><span class="err">，</span><span class="n">也有可能都不用</span><span class="err">。</span>

<span class="w">   </span><span class="n">Servlet</span><span class="p">{</span>
<span class="w">       </span><span class="n">service</span><span class="p">(</span><span class="n">HttpRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="n">HttpResponse</span><span class="w"> </span><span class="n">response</span><span class="p">){</span>
<span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="na">getParameter</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">--&gt;</span>

<span class="w">            </span><span class="n">response</span><span class="p">.</span><span class="na">getWriter</span><span class="p">()</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span>

<span class="w">       </span><span class="p">}</span>

<span class="w">   </span><span class="p">}</span>
</code></pre></div>
<ul>
<li>MethodInterceptor(方法拦截器)  <br />
额外功能运行在原始方法执行之后 <br />
额外功能运行在原始方法执行之前，之后   <br />
额外功能运行在原始方法抛出异常的时候 <br />
MethodInterceptor影响原始方法的返回值  </li>
</ul>
<div class="highlight"><pre><span></span><code>methodinterceptor接口：额外功能可以根据需要运行在原始方法执行 前、后、前后。

环绕通知
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Arround</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">MethodInterceptor</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">         invoke方法的作用:额外功能书写在invoke</span>
<span class="cm">                        额外功能  原始方法之前</span>
<span class="cm">                                 原始方法之后</span>
<span class="cm">                                 原始方法执行之前 之后</span>
<span class="cm">         确定：原始方法怎么运行</span>

<span class="cm">         参数：MethodInvocation （Method):额外功能所增加给的那个原始方法</span>
<span class="cm">                    login</span>
<span class="cm">                    register</span>
<span class="cm">              invocation.proceed() ---&gt; login运行</span>
<span class="cm">                                        register运行</span>

<span class="cm">          返回值：Object: 原始方法的返回值</span>

<span class="cm">         Date convert(String name)</span>
<span class="cm">     */</span>



<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">MethodInvocation</span><span class="w"> </span><span class="n">invocation</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----额外功能 log----&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocation</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>

<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">MethodInvocation</span><span class="w"> </span><span class="n">invocation</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocation</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----额外功能运行在原始方法执行之后----&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">什么样的额外功能</span><span class="w"> </span><span class="n">运行在原始方法执行之前</span><span class="err">，</span><span class="n">之后都要添加</span><span class="err">？</span>
<span class="n">事务</span>

<span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">MethodInvocation</span><span class="w"> </span><span class="n">invocation</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----额外功能运行在原始方法执行之前----&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocation</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>
<span class="w">  </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----额外功能运行在原始方法执行之后----&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">MethodInvocation</span><span class="w"> </span><span class="n">invocation</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocation</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">throwable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;-----原始方法抛出异常 执行的额外功能 ---- &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">throwable</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>


<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<p>原始方法的返回值，直接作为invoke方法的返回值返回，MethodInterceptor不会影响原始方法的返回值</p>
<p>MethodInterceptor影响原始方法的返回值<br />
Invoke方法的返回值，不要直接返回原始方法的运行结果即可。</p>
<p><a href="/Override">@Override </a> <br />
public Object invoke(MethodInvocation invocation) throws Throwable {<br />
System.out.println("------log-----");<br />
Object ret = invocation.proceed();<br />
return false;<br />
}</p>
<div class="highlight"><pre><span></span><code>##### 2. 切入点详解

~~~xml
切入点决定额外功能加入位置(方法)

&lt;aop:pointcut id=&quot;pc&quot; expression=&quot;execution(* *(..))&quot;/&gt;
exection(* *(..)) ---&gt; 匹配了所有方法    a  b  c 

1. execution()  切入点函数
2. * *(..)      切入点表达式
</code></pre></div>
<h6 id="21_3">2.1 切入点表达式<a class="headerlink" href="#21_3" title="Permanent link">&para;</a></h6>
<ol>
<li>方法切入点表达式<br />
<img alt="1641192149562-72ee6252-8d0c-4709-bda3-30dcf507a6a3.png" src="../img/OXFJdF09t3S74GG_/1641192149562-72ee6252-8d0c-4709-bda3-30dcf507a6a3-113069.png" /></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">*</span><span class="w"> </span> *(..)  --&gt; 所有方法

<span class="k">*</span><span class="w"> </span>---&gt; 修饰符 返回值
<span class="k">*</span><span class="w"> </span>---&gt; 方法名
()---&gt; 参数表
..---&gt; 对于参数没有要求 (参数有没有，参数有几个都行，参数是什么类型的都行)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  定义login方法作为切入点
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">*</span><span class="w"> </span>login(..)

<span class="gh"># 定义register作为切入点</span>
<span class="k">*</span><span class="w"> </span>register(..)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  定义login方法且login方法有两个字符串类型的参数 作为切入点
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">*</span><span class="w"> </span>login(String,String)

<span class="gh">#注意：非java.lang包中的类型，必须要写全限定名</span>
<span class="k">*</span><span class="w"> </span>register(com.baizhiedu.proxy.User)

<span class="gh"># ..可以和具体的参数类型连用</span>
<span class="k">*</span><span class="w"> </span>login(String,..)  --&gt; login(String),login(String,String),login(String,com.baizhiedu.proxy.User)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  精准方法切入点限定
</code></pre></div>
<div class="highlight"><pre><span></span><code>修饰符 返回值         包.类.方法(参数)

<span class="w">    </span><span class="k">*</span><span class="w"> </span>              com.baizhiedu.proxy.UserServiceImpl.login(..)
<span class="w">    </span><span class="k">*</span><span class="w"> </span>              com.baizhiedu.proxy.UserServiceImpl.login(String,String)
</code></pre></div>
<ol>
<li>类切入点  </li>
</ol>
<div class="highlight"><pre><span></span><code>指定特定类作为切入点(额外功能加入的位置)，自然这个类中的所有方法，都会加上对应的额外功能
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  语法1
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="gh">#类中的所有方法加入了额外功能 </span>
<span class="k">*</span><span class="w"> </span>com.baizhiedu.proxy.UserServiceImpl.*(..)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  语法2
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="gh">#忽略包</span>
<span class="k">1.</span> 类只存在一级包  com.UserServiceImpl
<span class="k">*</span><span class="w"> </span><span class="ge">*.UserServiceImpl.*</span>(..)

<span class="k">2.</span> 类存在多级包    com.baizhiedu.proxy.UserServiceImpl
<span class="k">*</span><span class="w"> </span><span class="ge">*..UserServiceImpl.*</span>(..)
</code></pre></div>
<ol>
<li>包切入点表达式 实战  </li>
</ol>
<div class="highlight"><pre><span></span><code>指定包作为额外功能加入的位置，自然包中的所有类及其方法都会加入额外的功能
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  语法1
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="gh">#切入点包中的所有类，必须在proxy中，不能在proxy包的子包中</span>
<span class="k">*</span><span class="w"> </span>com.baizhiedu.proxy.*.*(..)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  语法2
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="gh">#切入点当前包及其子包都生效 </span>
<span class="k">*</span><span class="w"> </span>com.baizhiedu.proxy..*.*(..)
</code></pre></div>
<h6 id="22_2">2.2 切入点函数<a class="headerlink" href="#22_2" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>切入点函数：用于执行切入点表达式
</code></pre></div>
<ol>
<li>execution  </li>
</ol>
<div class="highlight"><pre><span></span><code>最为重要的切入点函数，功能最全。
执行 方法切入点表达式 类切入点表达式 包切入点表达式 

弊端：execution执行切入点表达式 ，书写麻烦
     execution(* com.baizhiedu.proxy..*.*(..))

注意：其他的切入点函数 简化是execution书写复杂度，功能上完全一致
</code></pre></div>
<ol>
<li>args  </li>
</ol>
<div class="highlight"><pre><span></span><code>作用：主要用于函数(方法) 参数的匹配

切入点：方法参数必须得是2个字符串类型的参数

execution(* *(String,String))

args(String,String)
</code></pre></div>
<ol>
<li>within  </li>
</ol>
<div class="highlight"><pre><span></span><code>作用：主要用于进行类、包切入点表达式的匹配

切入点：UserServiceImpl这个类

execution(* <span class="ge">*..UserServiceImpl.*</span>(..))

within(*..UserServiceImpl)

execution(* com.baizhiedu.proxy..*.*(..))

within(com.baizhiedu.proxy..*)
</code></pre></div>
<p>4.<a href="/annotation">@annotation </a> </p>
<div class="highlight"><pre><span></span><code>作用：为具有特殊注解的方法加入额外功能

<span class="nt">&lt;aop:pointcut</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;@annotation(com.baizhiedu.Log)&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ol>
<li>切入点函数的逻辑运算  </li>
</ol>
<div class="highlight"><pre><span></span><code>指的是 整合多个切入点函数一起配合工作，进而完成更为复杂的需求
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  and与操作
</code></pre></div>
<div class="highlight"><pre><span></span><code>案例：login 同时 参数 2个字符串 

<span class="k">1.</span> execution(* login(String,String))

<span class="k">2.</span> execution(* login(..)) and args(String,String)

注意：与操作不同用于同种类型的切入点函数 

案例：register方法 和 login方法作为切入点 

execution(* login(..)) or  execution(* register(..))
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  or或操作
</code></pre></div>
<div class="highlight"><pre><span></span><code>案例：register方法 和 login方法作为切入点 

execution(* login(..)) or  execution(* register(..))
</code></pre></div>
<h4 id="aop">第四章、AOP编程<a class="headerlink" href="#aop" title="Permanent link">&para;</a></h4>
<h5 id="1-aop">1. AOP概念<a class="headerlink" href="#1-aop" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>AOP (Aspect Oriented Programing)   面向切面编程 = Spring动态代理开发
以切面为基本单位的程序开发，通过切面间的彼此协同，相互调用，完成程序的构建
切面 = 切入点 + 额外功能

OOP (Object Oritened Programing)   面向对象编程 Java
以对象为基本单位的程序开发，通过对象间的彼此协同，相互调用，完成程序的构建

POP (Producer Oriented Programing) 面向过程(方法、函数)编程 C 
以过程为基本单位的程序开发，通过过程间的彼此协同，相互调用，完成程序的构建
</code></pre></div>
<div class="highlight"><pre><span></span><code>AOP的概念：
     本质就是Spring得动态代理开发，通过代理类为原始类增加额外功能。
     好处：利于原始类的维护

注意：AOP编程不可能取代OOP，OOP编程有意补充。
</code></pre></div>
<h5 id="2-aop">2. AOP编程的开发步骤<a class="headerlink" href="#2-aop" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 原始对象
<span class="k">2.</span> 额外功能 (MethodInterceptor)
<span class="k">3.</span> 切入点
<span class="k">4.</span> 组装切面 (额外功能+切入点)
</code></pre></div>
<h5 id="3_4">3. 切面的名词解释<a class="headerlink" href="#3_4" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>切面 = 切入点 + 额外功能 

几何学
   面 = 点 + 相同的性质
</code></pre></div>
<p><img alt="1641192171414-f9a3a655-412b-4e17-842e-b5126be50688.png" src="../img/OXFJdF09t3S74GG_/1641192171414-f9a3a655-412b-4e17-842e-b5126be50688-963913.png" /></p>
<h4 id="aop_1">第五章、AOP的底层实现原理<a class="headerlink" href="#aop_1" title="Permanent link">&para;</a></h4>
<h5 id="1_10">1. 核心问题<a class="headerlink" href="#1_10" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> AOP如何创建动态代理类(动态字节码技术)
<span class="k">2.</span> Spring工厂如何加工创建代理对象
   通过原始对象的id值，获得的是代理对象
</code></pre></div>
<h5 id="2_8">2. 动态代理类的创建<a class="headerlink" href="#2_8" title="Permanent link">&para;</a></h5>
<h6 id="21-jdk">2.1 JDK的动态代理<a class="headerlink" href="#21-jdk" title="Permanent link">&para;</a></h6>
<ul>
<li>Proxy.newProxyInstance方法参数详解<br />
<img alt="1641192209351-b5bfbfbe-92fb-4bb8-a96b-6c4e3ed7ffe9.png" src="../img/OXFJdF09t3S74GG_/1641192209351-b5bfbfbe-92fb-4bb8-a96b-6c4e3ed7ffe9-843475.png" /></li>
</ul>
<p><img alt="1641192225612-0301e3db-3fee-40d5-bb3f-68e632862865.png" src="../img/OXFJdF09t3S74GG_/1641192225612-0301e3db-3fee-40d5-bb3f-68e632862865-937738.png" /></p>
<ul>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TestJDKProxy</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        1. 借用类加载器  TestJDKProxy</span>
<span class="cm">                       UserServiceImpl</span>
<span class="cm">        2. JDK8.x前</span>

<span class="cm">            final UserService userService = new UserServiceImpl();</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//1 创建原始对象</span>
<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span>

<span class="w">        </span><span class="c1">//2 JDK创建动态代理</span>
<span class="w">        </span><span class="cm">/*</span>

<span class="cm">         */</span>

<span class="w">        </span><span class="n">InvocationHandler</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InvocationHandler</span><span class="p">(){</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;------proxy  log --------&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="c1">//原始方法运行</span>
<span class="w">                </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">userService</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userServiceProxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span><span class="n">Proxy</span><span class="p">.</span><span class="na">newProxyInstance</span><span class="p">(</span><span class="n">UserServiceImpl</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">(),</span><span class="n">userService</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getInterfaces</span><span class="p">(),</span><span class="n">handler</span><span class="p">);</span>

<span class="w">        </span><span class="n">userServiceProxy</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="s">&quot;suns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;123456&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">userServiceProxy</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h6 id="22-cglib">2.2 CGlib的动态代理<a class="headerlink" href="#22-cglib" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>CGlib创建动态代理的原理：父子继承关系创建代理对象，原始类作为父类，代理类作为子类，这样既可以保证2者方法一致，同时在代理类中提供新的实现(额外功能+原始方法)
</code></pre></div>
<p><img alt="1641192263678-54fbb454-6a17-4a9a-b1af-6c3c561ccb56.png" src="../img/OXFJdF09t3S74GG_/1641192263678-54fbb454-6a17-4a9a-b1af-6c3c561ccb56-005000.png" /></p>
<ul>
<li>CGlib编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.baizhiedu.cglib</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.baizhiedu.proxy.User</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.cglib.proxy.Enhancer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.cglib.proxy.MethodInterceptor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.cglib.proxy.MethodProxy</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.reflect.Method</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TestCglib</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//1 创建原始对象</span>
<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserService</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">          2 通过cglib方式创建动态代理对象</span>
<span class="cm">            Proxy.newProxyInstance(classloader,interface,invocationhandler)</span>

<span class="cm">            Enhancer.setClassLoader()</span>
<span class="cm">            Enhancer.setSuperClass()</span>
<span class="cm">            Enhancer.setCallback();  ---&gt; MethodInterceptor(cglib)</span>
<span class="cm">            Enhancer.create() ---&gt; 代理</span>
<span class="cm">         */</span>

<span class="w">        </span><span class="n">Enhancer</span><span class="w"> </span><span class="n">enhancer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Enhancer</span><span class="p">();</span>

<span class="w">        </span><span class="n">enhancer</span><span class="p">.</span><span class="na">setClassLoader</span><span class="p">(</span><span class="n">TestCglib</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">());</span>
<span class="w">        </span><span class="n">enhancer</span><span class="p">.</span><span class="na">setSuperclass</span><span class="p">(</span><span class="n">userService</span><span class="p">.</span><span class="na">getClass</span><span class="p">());</span>


<span class="w">        </span><span class="n">MethodInterceptor</span><span class="w"> </span><span class="n">interceptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MethodInterceptor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//等同于 InvocationHandler --- invoke</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">intercept</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">MethodProxy</span><span class="w"> </span><span class="n">methodProxy</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;---cglib log----&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">userService</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="n">enhancer</span><span class="p">.</span><span class="na">setCallback</span><span class="p">(</span><span class="n">interceptor</span><span class="p">);</span>

<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userServiceProxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span><span class="w"> </span><span class="n">enhancer</span><span class="p">.</span><span class="na">create</span><span class="p">();</span>

<span class="w">        </span><span class="n">userServiceProxy</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="s">&quot;suns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;123345&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">userServiceProxy</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">User</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>总结  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> JDK动态代理   Proxy.newProxyInstance()  通过接口创建代理的实现类 
<span class="k">2.</span> Cglib动态代理 Enhancer                  通过继承父类创建的代理类
</code></pre></div>
<h5 id="3-spring_2">3. Spring工厂如何加工原始对象<a class="headerlink" href="#3-spring_2" title="Permanent link">&para;</a></h5>
<ul>
<li>思路分析<br />
<img alt="1641192305879-0e75978d-236c-4363-8837-b63c900b62f5.png" src="../img/OXFJdF09t3S74GG_/1641192305879-0e75978d-236c-4363-8837-b63c900b62f5-374146.png" /></li>
<li>编码   </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ProxyBeanPostProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">postProcessBeforeInitialization</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">         Proxy.newProxyInstance();</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">postProcessAfterInitialization</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">InvocationHandler</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InvocationHandler</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">invoke</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">proxy</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----- new Log-----&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Proxy</span><span class="p">.</span><span class="na">newProxyInstance</span><span class="p">(</span><span class="n">ProxyBeanPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">(),</span><span class="n">bean</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getInterfaces</span><span class="p">(),</span><span class="n">handler</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.factory.UserServiceImpl&quot;</span><span class="nt">/&gt;</span>


<span class="cm">&lt;!--1. 实现BeanPostProcessor 进行加工</span>
<span class="cm">        2. 配置文件中对BeanPostProcessor进行配置</span>
<span class="cm">    --&gt;</span>

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;proxyBeanPostProcessor&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.factory.ProxyBeanPostProcessor&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<h4 id="aop_2">第六章、基于注解的AOP编程<a class="headerlink" href="#aop_2" title="Permanent link">&para;</a></h4>
<h5 id="1-aop_1">1. 基于注解的AOP编程的开发步骤<a class="headerlink" href="#1-aop_1" title="Permanent link">&para;</a></h5>
<ol>
<li>原始对象 </li>
<li>额外功能 </li>
<li>切入点 </li>
<li>组装切面   </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">通过切面类</span><span class="w"> </span><span class="n">定义了</span><span class="w"> </span><span class="n">额外功能</span><span class="w"> </span><span class="nd">@Around</span>
<span class="w">           </span><span class="n">定义了</span><span class="w"> </span><span class="n">切入点</span><span class="w">   </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&quot;execution(* login(..))&quot;</span><span class="p">)</span>
<span class="w">           </span><span class="nd">@Aspect</span><span class="w"> </span><span class="n">切面类</span><span class="w"> </span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com.baizhiedu.aspect</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.annotation.Around</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="p">;</span>


<span class="cm">/*</span>
<span class="cm">       1. 额外功能</span>
<span class="cm">                 public class MyArround implements MethodInterceptor{</span>

<span class="cm">                      public Object invoke(MethodInvocation invocation){</span>

<span class="cm">                              Object ret = invocation.proceed();</span>

<span class="cm">                              return ret;</span>

<span class="cm">                      }</span>

<span class="cm">                 }</span>

<span class="cm">       2. 切入点</span>
<span class="cm">             &lt;aop:config</span>
<span class="cm">                 &lt;aop:pointcut id=&quot;&quot;  expression=&quot;execution(* login(..))&quot;/&gt;</span>
<span class="cm"> */</span>
<span class="nd">@Aspect</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyAspect</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&quot;execution(* login(..))&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">arround</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----aspect log ------&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>


<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.aspect.UserServiceImpl&quot;</span><span class="nt">/&gt;</span>

<span class="w">    </span><span class="cm">&lt;!--</span>
<span class="cm">       切面</span>
<span class="cm">         1. 额外功能</span>
<span class="cm">         2. 切入点</span>
<span class="cm">         3. 组装切面</span>


<span class="cm">    --&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;arround&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.aspect.MyAspect&quot;</span><span class="nt">/&gt;</span>

<span class="cm">&lt;!--告知Spring基于注解进行AOP编程--&gt;</span>
<span class="nt">&lt;aop:aspectj-autoproxy</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<h5 id="2_9">2. 细节<a class="headerlink" href="#2_9" title="Permanent link">&para;</a></h5>
<ol>
<li>切入点复用  </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">切入点复用</span><span class="err">：</span><span class="n">在切面类中定义一个函数</span><span class="w"> </span><span class="n">上面</span><span class="nd">@Pointcut注解</span><span class="w"> </span><span class="n">通过这种方式</span><span class="err">，</span><span class="n">定义切入点表达式</span><span class="err">，</span><span class="n">后续更加有利于切入点复用</span><span class="err">。</span>

<span class="nd">@Aspect</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyAspect</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Pointcut</span><span class="p">(</span><span class="s">&quot;execution(* login(..))&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">myPointcut</span><span class="p">(){}</span>

<span class="w">    </span><span class="nd">@Around</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;myPointcut()&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">arround</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----aspect log ------&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>


<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="nd">@Around</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;myPointcut()&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">arround1</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----aspect tx ------&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>


<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<ol>
<li>动态代理的创建方式 </li>
</ol>
<div class="highlight"><pre><span></span><code>AOP底层实现  2种代理创建方式
<span class="k">1.</span>  JDK  通过实现接口 做新的实现类方式 创建代理对象
<span class="k">2.</span>  Cglib通过继承父类 做新的子类      创建代理对象

默认情况 AOP编程 底层应用JDK动态代理创建方式 
如果切换Cglib
<span class="w">     </span><span class="k">1.</span> 基于注解AOP开发
        &lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot; /&gt;
<span class="w">     </span><span class="k">2.</span> 传统的AOP开发
        &lt;aop:config proxy-target-class=&quot;true&quot;&gt;
        &lt;/aop&gt;
</code></pre></div>
<h4 id="aop_3">第七章、AOP开发中的一个坑<a class="headerlink" href="#aop_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">坑</span><span class="err">：</span><span class="n">在同一个业务类中</span><span class="err">，</span><span class="n">进行业务方法间的相互调用</span><span class="err">，</span><span class="n">只有最外层的方法</span><span class="p">,</span><span class="n">才是加入了额外功能</span><span class="p">(</span><span class="n">内部的方法</span><span class="err">，</span><span class="n">通过普通的方式调用</span><span class="err">，</span><span class="n">都调用的是原始方法</span><span class="p">)</span><span class="err">。</span><span class="n">如果想让内层的方法也调用代理对象的方法</span><span class="err">，</span><span class="n">就要AppicationContextAware获得工厂</span><span class="err">，</span><span class="n">进而获得代理对象</span><span class="err">。</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserService</span><span class="p">,</span><span class="w"> </span><span class="n">ApplicationContextAware</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="p">;</span>


<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setApplicationContext</span><span class="p">(</span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="k">this</span><span class="p">.</span><span class="na">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Log</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;UserServiceImpl.register 业务运算 + DAO &quot;</span><span class="p">);</span>
<span class="w">        </span><span class="c1">//throw new RuntimeException(&quot;测试异常&quot;);</span>

<span class="w">        </span><span class="c1">//调用的是原始对象的login方法 ---&gt; 核心功能</span>
<span class="w">        </span><span class="cm">/*</span>
<span class="cm">            设计目的：代理对象的login方法 ---&gt;  额外功能+核心功能</span>
<span class="cm">            ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;/applicationContext2.xml&quot;);</span>
<span class="cm">            UserService userService = (UserService) ctx.getBean(&quot;userService&quot;);</span>
<span class="cm">            userService.login();</span>

<span class="cm">            Spring工厂重量级资源 一个应用中 应该只创建一个工厂</span>
<span class="cm">         */</span>

<span class="w">        </span><span class="n">UserService</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span><span class="w"> </span><span class="n">ctx</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;userService&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">userService</span><span class="p">.</span><span class="na">login</span><span class="p">(</span><span class="s">&quot;suns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;123456&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">login</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;UserServiceImpl.login&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="aop_4">第八章、AOP阶段知识总结<a class="headerlink" href="#aop_4" title="Permanent link">&para;</a></h4>
<p><img alt="1641192332984-43ae1380-d2df-4c94-ad23-9490eef89034.png" src="../img/OXFJdF09t3S74GG_/1641192332984-43ae1380-d2df-4c94-ad23-9490eef89034-686195.png" /></p>
<h3 id="spring-">Spring系列--- 注解编程<a class="headerlink" href="#spring-" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="_8">第一章、注解基础概念<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<h5 id="1_11">1. 什么是注解编程<a class="headerlink" href="#1_11" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="n">指的是在类或者方法上加入特定的注解</span><span class="err">（</span><span class="nd">@XXX</span><span class="p">),</span><span class="n">完成特定功能的开发</span><span class="err">。</span>

<span class="w">    </span><span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">XXX</span><span class="p">{}</span>
</code></pre></div>
<h5 id="2_10">2. 为什么要讲解注解编程<a class="headerlink" href="#2_10" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 注解开发方便
     代码简洁 开发速度大大提高
<span class="k">2.</span> Spring开发潮流
     Spring2.x引入注解  Spring3.x完善注解 SpringBoot普及 推广注解编程
</code></pre></div>
<h5 id="3_5">3. 注解的作用<a class="headerlink" href="#3_5" title="Permanent link">&para;</a></h5>
<ul>
<li>替换XML这种配置形式，简化配置<br />
<img alt="1641192853787-6d1ea5d5-bab8-4a78-9b44-a308cf517868.png" src="../img/OXFJdF09t3S74GG_/1641192853787-6d1ea5d5-bab8-4a78-9b44-a308cf517868-447807.png" /></li>
<li>替换接口，实现调用双方的契约性 <br />
<img alt="1641192891279-7045c3af-ca5b-482d-b68e-5f8529a2a16e.png" src="../img/OXFJdF09t3S74GG_/1641192891279-7045c3af-ca5b-482d-b68e-5f8529a2a16e-797546.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code>通过注解的方式，在功能调用者和功能提供者之间达成约定，进而进行功能的调用。因为注解应用更为方便灵活，所以在现在的开发中，更推荐通过注解的形式，完成
</code></pre></div>
<h5 id="4-spring">4. Spring注解的发展历程<a class="headerlink" href="#4-spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> Spring2.x开始支持注解编程 <span class="ni">@Component</span> <span class="ni">@Service</span> <span class="ni">@Scope</span>..
     目的：提供的这些注解只是为了在某些情况下简化XML的配置,作为XML开发的有益补充。
<span class="k">2.</span> Spring3.x <span class="ni">@Configuration</span> <span class="ni">@Bean</span>..
     目的：彻底替换XML，基于纯注解编程
<span class="k">3.</span> Spring4.x SpringBoot 
     提倡使用注解常见开发
</code></pre></div>
<h5 id="5-spring">5. Spring注解开发的一个问题<a class="headerlink" href="#5-spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>Spring基于注解进行配置后，还能否解耦合呢？

在Spring框架应用注解时，如果对注解配置的内容不满意，可以通过Spring配置文件进行覆盖的。
</code></pre></div>
<h4 id="springspring2x">第二章、Spring的基础注解（Spring2.x）<a class="headerlink" href="#springspring2x" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>这个阶段的注解，仅仅是简化XML的配置，并不能完全替代XML
</code></pre></div>
<h5 id="1_12">1. 对象创建相关注解<a class="headerlink" href="#1_12" title="Permanent link">&para;</a></h5>
<ul>
<li>搭建开发环境  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;context:component-scan</span><span class="w"> </span><span class="na">base-package=</span><span class="s">&quot;com.baizhiedu&quot;</span><span class="nt">/&gt;</span>

作用：让Spring框架在设置包及其子包中扫描对应的注解，使其生效。
</code></pre></div>
<ul>
<li>对象创建相关注解 <ul>
<li><a href="/Component">@Component </a>  <br />
<img alt="1641192916879-81bff43e-2d73-4d30-b8a0-6d9e596e8f7d.png" src="../img/OXFJdF09t3S74GG_/1641192916879-81bff43e-2d73-4d30-b8a0-6d9e596e8f7d-836567.png" /></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code>作用：替换原有spring配置文件中的&lt;bean标签 
注意：
    id属性 component注解 提供了默认的设置方式  首单词首字母小写
    class属性 通过反射获得class内容
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  [@Component ](/Component ) 细节  
    *  如何显示指定工厂创建对象的id值
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@Component</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>    *  Spring配置文件覆盖注解配置内容
</code></pre></div>
<div class="highlight"><pre><span></span><code>applicationContext.xml

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;u&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.bean.User&quot;</span><span class="nt">/&gt;</span>

id值<span class="w"> </span>class的值<span class="w"> </span>要和<span class="w"> </span>注解中的设置保持一值
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  @Component的衍生注解
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="ni">@Repository</span>  ---&gt;  XXXDAO
  <span class="ni">@Repository</span>
  public class UserDAO{

  }
<span class="ni">@Service</span>
  <span class="ni">@Service</span>
  public class UserService{

  }
<span class="ni">@Controller</span> 
  <span class="ni">@Controller</span> 
  public class RegAction{

  }
注意：本质上这些衍生注解就是@Component 
     作用 &lt;bean  
     细节 <span class="ni">@Service</span>(&quot;s&quot;)

目的：更加准确的表达一个类型的作用

注意：Spring整合Mybatis开发过程中 不使用@Repository <span class="ni">@Component</span>
</code></pre></div>
<ul>
<li>@Scope注解  </li>
</ul>
<div class="highlight"><pre><span></span><code>作用：控制简单对象创建次数
注意：不添加@Scope Spring提供默认值 singleton
&lt;bean id=&quot;&quot; class=&quot;&quot; scope=&quot;singleton|prototype&quot;/&gt;
</code></pre></div>
<ul>
<li>@Lazy注解  </li>
</ul>
<div class="highlight"><pre><span></span><code>作用：延迟创建单实例对象
注意：一旦使用了@Lazy注解后，Spring会在使用这个对象时候，进行这个对象的创建
&lt;bean id=&quot;&quot; class=&quot;&quot; lazy=&quot;false&quot;/&gt;
</code></pre></div>
<ul>
<li>生命周期方法相关注解  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 初始化相关方法 <span class="ni">@PostConstruct</span>
   InitializingBean
   &lt;bean init-method=&quot;&quot;/&gt;
<span class="k">2.</span> 销毁方法 <span class="ni">@PreDestroy</span>
   DisposableBean
   &lt;bean destory-method=&quot;&quot;/&gt;
注意：1. 上述的2个注解并不是Spring提供的，JSR(JavaEE规范)520
<span class="w">     </span><span class="k">2.</span> 再一次的验证，通过注解实现了接口的契约性
</code></pre></div>
<h5 id="2_11">2. 注入相关注解<a class="headerlink" href="#2_11" title="Permanent link">&para;</a></h5>
<ul>
<li>用户自定义类型 <a href="/Autowired">@Autowired </a> <br />
<img alt="1641192944288-b1181a2e-55b3-44d7-8f40-8ead8a9a7172.png" src="../img/OXFJdF09t3S74GG_/1641192944288-b1181a2e-55b3-44d7-8f40-8ead8a9a7172-091025.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ni">@Autowired细节</span>
<span class="k">1.</span> Autowired注解基于类型进行注入 [推荐]
   基于类型的注入：注入对象的类型，必须与目标成员变量类型相同或者是其子类（实现类）

<span class="k">2.</span> Autowired Qualifier 基于名字进行注入 [了解]
   基于名字的注入：注入对象的id值，必须与Qualifier注解中设置的名字相同

<span class="k">3.</span> Autowired注解放置位置 
    a) 放置在对应成员变量的set方法上 
    b) 直接把这个注解放置在成员变量之上，Spring通过反射直接对成员变量进行注入（赋值）[推荐]

<span class="k">4.</span> JavaEE规范中类似功能的注解
    JSR250 <span class="ni">@Resouce</span>(name=&quot;userDAOImpl&quot;) 基于名字进行注入
           <span class="ni">@Autowired</span>()
           <span class="ni">@Qualifier</span>(&quot;userDAOImpl&quot;)
           注意：如果在应用Resource注解时，名字没有配对成功，那么他会继续按照类型进行注入。
    JSR330 <span class="ni">@Inject</span> 作用 <span class="ni">@Autowired完全一致</span> 基于类型进行注入 ---》 EJB3.0
          &lt;dependency&gt;
            &lt;groupId&gt;javax.inject&lt;/groupId&gt;
            &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;
            &lt;version&gt;1&lt;/version&gt;
          &lt;/dependency&gt;
</code></pre></div>
<ul>
<li>JDK类型  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ni">@Value注解完成</span>
<span class="k">1.</span> 设置xxx.properties 
   id = 10
   name = suns
<span class="k">2.</span> Spring的工厂读取这个配置文件 
   &lt;context:property-placeholder location=&quot;&quot;/&gt;
<span class="k">3.</span> 代码 
   属性 <span class="ni">@Value</span>(&quot;${key}&quot;)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  [@PropertySource ](/PropertySource )
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 作用：用于替换Spring配置文件中的&lt;context:property-placeholder location=&quot;&quot;/&gt;标签
<span class="k">2.</span> 开发步骤 
<span class="w">    </span><span class="k">1.</span> 设置xxx.properties 
       id = 10
       name = suns
<span class="w">    </span><span class="k">2.</span> 应用@PropertySource
<span class="w">    </span><span class="k">3.</span> 代码
       属性 <span class="ni">@Value</span>()
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  @Value注解使用细节 
    *  @Value注解不能应用在静态成员变量上
</code></pre></div>
<div class="highlight"><pre><span></span><code>如果应用，赋值（注入）失败
</code></pre></div>
<div class="highlight"><pre><span></span><code>    *  @Value注解+Properties这种方式，不能注入集合类型
</code></pre></div>
<div class="highlight"><pre><span></span><code>Spring提供新的配置形式 YAML YML (SpringBoot)
</code></pre></div>
<h5 id="3_6">3. 注解扫描详解<a class="headerlink" href="#3_6" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>&lt;context:component-scan base-package=&quot;com.baizhiedu&quot;/&gt;
当前包 及其 子包
</code></pre></div>
<h6 id="1_13">1. 排除方式<a class="headerlink" href="#1_13" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>&lt;context:component-scan base-package=&quot;com.baizhiedu&quot;&gt;
   &lt;context:exclude-filter type=&quot;&quot; expression=&quot;&quot;/&gt;
   type:assignable:排除特定的类型 不进行扫描
        annotation:排除特定的注解 不进行扫描
        aspectj:切入点表达式
                包切入点： com.baizhiedu.bean..*
                类切入点： *..User
        regex:正则表达式 
        custom：自定义排除策略框架底层开发
&lt;/context:component-scan&gt;

排除策略可以叠加使用 
&lt;context:component-scan base-package=&quot;com.baizhiedu&quot;&gt;
  &lt;context:exclude-filter type=&quot;assignable&quot; expression=&quot;com.baizhiedu.bean.User&quot;/&gt;

  &lt;context:exclude-filter type=&quot;aspectj&quot; expression=&quot;com.baizhiedu.injection..*&quot;/&gt;
&lt;/context:component-scan&gt;
</code></pre></div>
<h6 id="2_12">2. 包含方式<a class="headerlink" href="#2_12" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;context:component-scan</span><span class="w"> </span><span class="na">base-package=</span><span class="s">&quot;com.baizhiedu&quot;</span><span class="w"> </span><span class="na">use-default-filters=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;context:include-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/context:component-scan&gt;</span>

1.<span class="w"> </span>use-default-filters=&quot;false&quot;
<span class="w">   </span>作用：让Spring默认的注解扫描方式<span class="w"> </span>失效。
2.<span class="w"> </span><span class="nt">&lt;context:include-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span>作用：指定扫描那些注解<span class="w"> </span>
<span class="w">   </span>type:assignable:排除特定的类型<span class="w"> </span>不进行扫描
<span class="w">        </span>annotation:排除特定的注解<span class="w"> </span>不进行扫描
<span class="w">        </span>aspectj:切入点表达式
<span class="w">                </span>包切入点：<span class="w"> </span>com.baizhiedu.bean..*
<span class="w">                </span>类切入点：<span class="w"> </span>*..User
<span class="w">        </span>regex:正则表达式<span class="w"> </span>
<span class="w">        </span>custom：自定义排除策略框架底层开发

包含的方式支持叠加
<span class="w"> </span><span class="nt">&lt;context:component-scan</span><span class="w"> </span><span class="na">base-package=</span><span class="s">&quot;com.baizhiedu&quot;</span><span class="w"> </span><span class="na">use-default-filters=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;context:include-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;annotation&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;org.springframework.stereotype.Repository&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;context:include-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;annotation&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;org.springframework.stereotype.Service&quot;</span><span class="nt">/&gt;</span>
<span class="w"> </span><span class="nt">&lt;/context:component-scan&gt;</span>
</code></pre></div>
<h5 id="4_3">4. 对于注解开发的思考<a class="headerlink" href="#4_3" title="Permanent link">&para;</a></h5>
<ul>
<li>配置互通  </li>
</ul>
<div class="highlight"><pre><span></span><code>Spring注解配置 配置文件的配置 互通

<span class="ni">@Repository</span>
public class UserDAOImpl{


}

public class UserServiceImpl{
   private UserDAO userDAO;
   set get
}

&lt;bean id=&quot;userService&quot; class=&quot;com.baizhiedu.UserServiceImpl&quot;&gt;
   &lt;property name=&quot;userDAO&quot; ref=&quot;userDAOImpl&quot;/&gt;
&lt;/bean&gt;
</code></pre></div>
<ul>
<li>什么情况下使用注解 什么情况下使用配置文件  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ni">@Component</span> 替换 &lt;bean 

基础注解（@Component <span class="ni">@Autowired</span> <span class="ni">@Value</span>) 程序员开发类型的配置

<span class="k">1.</span> 在程序员开发的类型上 可以加入对应注解 进行对象的创建 
   User  UserService  UserDAO  UserAction 

<span class="k">2.</span> 应用其他非程序员开发的类型时，还是需要使用&lt;bean 进行配置的
   SqlSessionFactoryBean  MapperScannerConfigure
</code></pre></div>
<h5 id="5-ssm">5.  SSM整合开发（半注解开发）<a class="headerlink" href="#5-ssm" title="Permanent link">&para;</a></h5>
<ul>
<li>搭建开发环境 <ul>
<li>引入相关jar 【SSM POM】</li>
<li>引入相关配置文件 <ul>
<li>applicationContext.xml</li>
<li>struts.xml</li>
<li>log4.properties</li>
<li>XXXMapper.xml</li>
</ul>
</li>
<li>初始化配置 <ul>
<li>Web.xml Spring  (ContextLoaderListener)</li>
<li>Web.xml Struts Filter</li>
</ul>
</li>
</ul>
</li>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code>&lt;context:component-scan base-package=&quot;&quot;/&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  DAO (Spring+Mybatis)
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 配置文件的配置
<span class="w">   </span><span class="k">1.</span> DataSource
<span class="w">   </span><span class="k">2.</span> SqlSessionFactory ----&gt; SqlSessionFactoryBean
<span class="w">      </span><span class="k">1.</span> dataSource
<span class="w">      </span><span class="k">2.</span> typeAliasesPackage
<span class="w">      </span><span class="k">3.</span> mapperLocations 
<span class="w">   </span><span class="k">3.</span> MapperScannerConfigur ---&gt; DAO接口实现类
<span class="k">2.</span> 编码
<span class="w">   </span><span class="k">1.</span> entity 
<span class="w">   </span><span class="k">2.</span> table
<span class="w">   </span><span class="k">3.</span> DAO接口
<span class="w">   </span><span class="k">4.</span> 实现Mapper文件
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  Service
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 原始对象 ---》 注入DAO
   <span class="ni">@Service</span> ---&gt; <span class="ni">@Autowired</span>

<span class="k">2.</span> 额外功能 ---》 DataSourceTransactionManager ---&gt; dataSource
<span class="k">3.</span> 切入点 + 事务属性
   <span class="ni">@Transactional</span>(propagation,readOnly...)
<span class="k">4.</span> 组装切面
   &lt;tx:annotation-driven
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  Controller (Spring+Struts2)
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> <span class="ni">@Controller</span>
   <span class="ni">@Scope</span>(&quot;prototype&quot;)
   public class RegAction implements Action{
      <span class="ni">@Autowired</span>
      private UserService userServiceImpl;

   }
<span class="k">2.</span> struts.xml
    &lt;action class=&quot;spring配置文件中action对应的id值&quot;/&gt;
</code></pre></div>
<h4 id="springspring3x">第三章、Spring的高级注解（Spring3.x 及以上)<a class="headerlink" href="#springspring3x" title="Permanent link">&para;</a></h4>
<h5 id="1-bean">1. 配置Bean<a class="headerlink" href="#1-bean" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="n">Spring在3</span><span class="p">.</span><span class="na">x提供的新的注解</span><span class="err">，</span><span class="n">用于替换XML配置文件</span><span class="err">。</span>

<span class="w">  </span><span class="nd">@Configuration</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig</span><span class="p">{</span>

<span class="p">}</span>
</code></pre></div>
<ol>
<li>配置Bean在应用的过程中 替换了XML具体什么内容呢？<br />
<img alt="1641192978824-4c353922-9e3a-45cd-bd7f-040a4efbf72c.png" src="../img/OXFJdF09t3S74GG_/1641192978824-4c353922-9e3a-45cd-bd7f-040a4efbf72c-506455.png" /></li>
<li>AnnotationConfigApplicationContext  </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 创建工厂代码
   ApplicationContext ctx = new AnnotationConfigApplicationContext();
<span class="k">2.</span> 指定配置文件 
<span class="w">   </span><span class="k">1.</span> 指定配置bean的Class
       ApplicationContext ctx = new AnnotationConfigApplicationContext(AppConfig.class);
<span class="w">   </span><span class="k">2.</span> 指定配置bean所在的路径 
       ApplicationContext ctx = new AnnotationConfigApplicationContext(&quot;com.baizhiedu&quot;);
</code></pre></div>
<ul>
<li>配置Bean开发的细节分析 <ul>
<li>基于注解开发使用日志  </li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code>不能集成Log4j
集成logback
</code></pre></div>
<div class="highlight"><pre><span></span><code>    *  引入相关jar
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nt">&lt;dependency&gt;</span>
<span class="w">      </span><span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">      </span><span class="nt">&lt;artifactId&gt;</span>slf4j-api<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;version&gt;</span>1.7.25<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>

<span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
<span class="w">      </span><span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
<span class="w">      </span><span class="nt">&lt;artifactId&gt;</span>jcl-over-slf4j<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;version&gt;</span>1.7.25<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>

<span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
<span class="w">      </span><span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
<span class="w">      </span><span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>

<span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
<span class="w">      </span><span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
<span class="w">      </span><span class="nt">&lt;artifactId&gt;</span>logback-core<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;version&gt;</span>1.2.3<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>

<span class="w">    </span><span class="nt">&lt;dependency&gt;</span>
<span class="w">      </span><span class="nt">&lt;groupId&gt;</span>org.logback-extensions<span class="nt">&lt;/groupId&gt;</span>
<span class="w">      </span><span class="nt">&lt;artifactId&gt;</span>logback-ext-spring<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">      </span><span class="nt">&lt;version&gt;</span>0.1.4<span class="nt">&lt;/version&gt;</span>
<span class="w">    </span><span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>    *  引入logback配置文件 (logback.xml)
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="w">    </span><span class="cm">&lt;!-- 控制台输出 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;STDOUT&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;encoder&gt;</span>
<span class="w">            </span><span class="cm">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
<span class="w">            </span><span class="nt">&lt;pattern&gt;</span>%d{yyyy-MM-dd<span class="w"> </span>HH:mm:ss.SSS}<span class="w"> </span>[%thread]<span class="w"> </span>%-5level<span class="w"> </span>%logger{50}<span class="w"> </span>-<span class="w"> </span>%msg%n<span class="nt">&lt;/pattern&gt;</span>
<span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
<span class="w">    </span><span class="nt">&lt;/appender&gt;</span>

<span class="w">    </span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;DEBUG&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;STDOUT&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/root&gt;</span>

<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  @Configuration注解的本质
</code></pre></div>
<div class="highlight"><pre><span></span><code>本质：也是@Component注解的衍生注解

可以应用&lt;context:component-scan进行扫描
</code></pre></div>
<h5 id="2-bean">2. @Bean注解<a class="headerlink" href="#2-bean" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="ni">@Bean注解在配置bean中进行使用</span>，等同于XML配置文件中的&lt;bean标签
</code></pre></div>
<h6 id="1-bean_1">1. @Bean注解的基本使用<a class="headerlink" href="#1-bean_1" title="Permanent link">&para;</a></h6>
<ul>
<li>对象的创建<br />
<img alt="1641193002314-b6ae523b-f811-4207-9b56-475eda0dd6cd.png" src="../img/OXFJdF09t3S74GG_/1641193002314-b6ae523b-f811-4207-9b56-475eda0dd6cd-911656.png" /></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 简单对象
   直接能够通过new方式创建的对象 
   User  UserService   UserDAO 
<span class="k">2.</span> 复杂对象
   不能通过new的方式直接创建的对象
   Connection SqlSessionFactory
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  @Bean注解创建复杂对象的注意事项
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">遗留系统整合</span><span class="w"> </span>
<span class="nd">@Bean</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="nf">conn1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Connection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ConnectionFactoryBean</span><span class="w"> </span><span class="n">factoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConnectionFactoryBean</span><span class="p">();</span>
<span class="w">    </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factoryBean</span><span class="p">.</span><span class="na">getObject</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">conn</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>自定义id值  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ni">@Bean</span>(&quot;id&quot;)
</code></pre></div>
<ul>
<li>控制对象创建次数  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nd">@Bean</span>
<span class="nd">@Scope</span><span class="p">(</span><span class="s">&quot;singleton|prototype&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">默认值</span><span class="w"> </span><span class="n">singleton</span>
</code></pre></div>
<h6 id="2-bean_1">2. @Bean注解的注入<a class="headerlink" href="#2-bean_1" title="Permanent link">&para;</a></h6>
<ul>
<li>用户自定义类型  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nd">@Bean</span>
<span class="kd">public</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="nf">userDAO</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserDAOImpl</span><span class="p">();</span>
<span class="p">}</span>

<span class="nd">@Bean</span>
<span class="kd">public</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="nf">userService</span><span class="p">(</span><span class="n">UserDAO</span><span class="w"> </span><span class="n">userDAO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">UserServiceImpl</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span>
<span class="w">  </span><span class="n">userService</span><span class="p">.</span><span class="na">setUserDAO</span><span class="p">(</span><span class="n">userDAO</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">userService</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//简化写法</span>
<span class="nd">@Bean</span>
<span class="kd">public</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="nf">userService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">UserServiceImpl</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span>
<span class="w">  </span><span class="n">userService</span><span class="p">.</span><span class="na">setUserDAO</span><span class="p">(</span><span class="n">userDAO</span><span class="p">());</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">userService</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>JDK类型的注入  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nd">@Bean</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="nf">customer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Customer</span><span class="p">();</span>
<span class="w">  </span><span class="n">customer</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">customer</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="s">&quot;xiaohei&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  JDK类型注入的细节分析
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">如果直接在代码中进行set方法的调用</span><span class="err">，</span><span class="n">会存在耦合的问题</span><span class="w"> </span>

<span class="nd">@Configuration</span>
<span class="nd">@PropertySource</span><span class="p">(</span><span class="s">&quot;classpath:/init.properties&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig1</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${id}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${name}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="nf">customer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Customer</span><span class="w"> </span><span class="n">customer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Customer</span><span class="p">();</span>
<span class="w">        </span><span class="n">customer</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">        </span><span class="n">customer</span><span class="p">.</span><span class="na">setName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="3-componentscan">3. @ComponentScan注解<a class="headerlink" href="#3-componentscan" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="ni">@ComponentScan注解在配置bean中进行使用</span>，等同于XML配置文件中的&lt;context:component-scan&gt;标签

目的：进行相关注解的扫描 （@Component <span class="ni">@Value</span> ...@Autowired)
</code></pre></div>
<h6 id="1_14">1. 基本使用<a class="headerlink" href="#1_14" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="p">(</span><span class="n">basePackages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.baizhiedu.scan&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig2</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="o">&lt;</span><span class="n">context</span><span class="p">:</span><span class="n">component</span><span class="o">-</span><span class="n">scan</span><span class="w"> </span><span class="n">base</span><span class="o">-</span><span class="n">package</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="o">/&gt;</span>
</code></pre></div>
<h6 id="2_13">2. 排除、包含的使用<a class="headerlink" href="#2_13" title="Permanent link">&para;</a></h6>
<ul>
<li>排除  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;context:component-scan</span><span class="w"> </span><span class="na">base-package=</span><span class="s">&quot;com.baizhiedu&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;context:exclude-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;assignable&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;com.baizhiedu.bean.User&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/context:component-scan&gt;</span>

@ComponentScan(basePackages<span class="w"> </span>=<span class="w"> </span>&quot;com.baizhiedu.scan&quot;,
<span class="w">               </span>excludeFilters<span class="w"> </span>=<span class="w"> </span>{@ComponentScan.Filter(type=<span class="w"> </span>FilterType.ANNOTATION,value={Service.class}),
<span class="w">                                 </span>@ComponentScan.Filter(type=<span class="w"> </span>FilterType.ASPECTJ,pattern<span class="w"> </span>=<span class="w"> </span>&quot;*..User1&quot;)})

type<span class="w"> </span>=<span class="w"> </span>FilterType.ANNOTATION<span class="w">          </span>value
<span class="w">                 </span>.ASSIGNABLE_TYPE<span class="w">     </span>value
<span class="w">                 </span>.ASPECTJ<span class="w">             </span>pattern<span class="w">   </span>
<span class="w">                 </span>.REGEX<span class="w">               </span>pattern
<span class="w">                 </span>.CUSTOM<span class="w">              </span>value
</code></pre></div>
<ul>
<li>包含  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;context:component-scan</span><span class="w"> </span><span class="na">base-package=</span><span class="s">&quot;com.baizhiedu&quot;</span><span class="w"> </span><span class="na">use-default-filters=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;context:include-filter</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/context:component-scan&gt;</span>

@ComponentScan(basePackages<span class="w"> </span>=<span class="w"> </span>&quot;com.baizhiedu.scan&quot;,
<span class="w">               </span>useDefaultFilters<span class="w"> </span>=<span class="w"> </span>false,
<span class="w">               </span>includeFilters<span class="w"> </span>=<span class="w"> </span>{@ComponentScan.Filter(type=<span class="w"> </span>FilterType.ANNOTATION,value={Service.class})})

type<span class="w"> </span>=<span class="w"> </span>FilterType.ANNOTATION<span class="w">          </span>value
<span class="w">                 </span>.ASSIGNABLE_TYPE<span class="w">     </span>value
<span class="w">                 </span>.ASPECTJ<span class="w">             </span>pattern<span class="w">   </span>
<span class="w">                 </span>.REGEX<span class="w">               </span>pattern
<span class="w">                 </span>.CUSTOM<span class="w">              </span>value
</code></pre></div>
<h5 id="4-spring_1">4. Spring工厂创建对象的多种配置方式<a class="headerlink" href="#4-spring_1" title="Permanent link">&para;</a></h5>
<h6 id="1_15">1. 多种配置方式的应用场景<a class="headerlink" href="#1_15" title="Permanent link">&para;</a></h6>
<p><img alt="1641193036522-d6c9eba4-c5c8-4329-b397-dba87b9cf74e.png" src="../img/OXFJdF09t3S74GG_/1641193036522-d6c9eba4-c5c8-4329-b397-dba87b9cf74e-958878.png" /></p>
<h6 id="2_14">2. 配置优先级<a class="headerlink" href="#2_14" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="ni">@Component及其衍生注解</span> &lt; <span class="ni">@Bean</span> &lt; 配置文件bean标签
优先级高的配置 覆盖优先级低配置 

<span class="ni">@Component</span>
public class User{

}

<span class="ni">@Bean</span>
public User user(){
  return new User();
}

&lt;bean id=&quot;user&quot; class=&quot;xxx.User&quot;/&gt;

配置覆盖：id值 保持一致
</code></pre></div>
<ul>
<li>解决基于注解进行配置的耦合问题  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nd">@Configuration</span>
<span class="c1">//@ImportResource(&quot;applicationContext.xml&quot;)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig4</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="nf">userDAO</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserDAOImpl</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Configuration</span>
<span class="nd">@ImportResource</span><span class="p">(</span><span class="s">&quot;applicationContext.xml&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig5</span><span class="p">{</span>

<span class="p">}</span>

<span class="n">applicationContext</span><span class="p">.</span><span class="na">xml</span>
<span class="o">&lt;</span><span class="n">bean</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="kd">class</span><span class="err">=&quot;</span><span class="nc">com</span><span class="p">.</span><span class="na">baizhiedu</span><span class="p">.</span><span class="na">injection</span><span class="p">.</span><span class="na">UserDAOImplNew</span><span class="s">&quot;/&gt;</span>
</code></pre></div>
<h5 id="5_2">5. 整合多个配置信息<a class="headerlink" href="#5_2" title="Permanent link">&para;</a></h5>
<ul>
<li>为什么会有多个配置信息</li>
</ul>
<div class="highlight"><pre><span></span><code>拆分多个配置bean的开发，是一种模块化开发的形式，也体现了面向对象各司其职的设计思想
</code></pre></div>
<ul>
<li>多配置信息整合的方式 <ul>
<li>多个配置Bean的整合</li>
<li>配置Bean与@Component相关注解的整合</li>
<li>配置Bean与SpringXML配置文件的整合</li>
</ul>
</li>
<li>整合多种配置需要关注那些要点 <ul>
<li>如何使多配置的信息 汇总成一个整体</li>
<li>如何实现跨配置的注入</li>
</ul>
</li>
</ul>
<h6 id="1-bean_2">1. 多个配置Bean的整合<a class="headerlink" href="#1-bean_2" title="Permanent link">&para;</a></h6>
<ul>
<li>多配置的信息汇总 <ul>
<li>base-package进行多个配置Bean的整合<br />
<img alt="1641193057587-1f42be6a-a617-4fc5-b131-96a9df84a331.png" src="../img/OXFJdF09t3S74GG_/1641193057587-1f42be6a-a617-4fc5-b131-96a9df84a331-355595.png" /></li>
<li><a href="/Import">@Import </a>  <br />
<img alt="1641193074798-f17217dc-f989-4ecf-8185-efdef50abc9b.png" src="../img/OXFJdF09t3S74GG_/1641193074798-f17217dc-f989-4ecf-8185-efdef50abc9b-495456.png" /></li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 可以创建对象
<span class="k">2.</span> 多配置bean的整合
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  在工厂创建时，指定多个配置Bean的Class对象 【了解】
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">AppConfig1</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="n">AppConfig2</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>跨配置进行注入  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">在应用配置Bean的过程中</span><span class="err">，</span><span class="n">不管使用哪种方式进行配置信息的汇总</span><span class="err">，</span><span class="n">其操作方式都是通过成员变量加入</span><span class="nd">@Autowired注解完成</span><span class="err">。</span>
<span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="p">(</span><span class="n">AppConfig2</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig1</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="n">userDAO</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="nf">userService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UserServiceImpl</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span>
<span class="w">        </span><span class="n">userService</span><span class="p">.</span><span class="na">setUserDAO</span><span class="p">(</span><span class="n">userDAO</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">userService</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig2</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="nf">userDAO</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserDAOImpl</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h6 id="2-beancomponent">2. 配置Bean与@Component相关注解的整合<a class="headerlink" href="#2-beancomponent" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nd">@Component</span><span class="p">(</span><span class="nd">@Repository</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserDAOImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDAO</span><span class="p">{</span>

<span class="p">}</span>

<span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AppConfig3</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDAO</span><span class="w"> </span><span class="n">userDAO</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">UserService</span><span class="w"> </span><span class="nf">userService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UserServiceImpl</span><span class="w"> </span><span class="n">userService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UserServiceImpl</span><span class="p">();</span>
<span class="w">        </span><span class="n">userService</span><span class="p">.</span><span class="na">setUserDAO</span><span class="p">(</span><span class="n">userDAO</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">userService</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">ApplicationContext</span><span class="w"> </span><span class="n">ctx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">AppConfig3</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</code></pre></div>
<h6 id="3-bean">3. 配置Bean与配置文件整合<a class="headerlink" href="#3-bean" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">遗留系统的整合</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="n">配置覆盖</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserDAOImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserDAO</span><span class="p">{</span>

<span class="p">}</span>
<span class="o">&lt;</span><span class="n">bean</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="kd">class</span><span class="err">=&quot;</span><span class="nc">com</span><span class="p">.</span><span class="na">baizhiedu</span><span class="p">.</span><span class="na">injection</span><span class="p">.</span><span class="na">UserDAOImpl</span><span class="s">&quot;/&gt;</span>

<span class="s">@Configuration</span>
<span class="s">@ImportResource(&quot;</span><span class="n">applicationContext</span><span class="p">.</span><span class="na">xml</span><span class="s">&quot;)</span>
<span class="s">public class AppConfig4 {</span>

<span class="s">    @Autowired</span>
<span class="s">    private UserDAO userDAO;</span>

<span class="s">    @Bean</span>
<span class="s">    public UserService userService() {</span>
<span class="s">        UserServiceImpl userService = new UserServiceImpl();</span>
<span class="s">        userService.setUserDAO(userDAO);</span>
<span class="s">        return userService;</span>
<span class="s">    }</span>
<span class="s">}</span>

<span class="s">ApplicationContext ctx = new AnnotationConfigApplicationContext(AppConfig4.class);</span>
</code></pre></div>
<h5 id="6-bean">6. 配置Bean底层实现原理<a class="headerlink" href="#6-bean" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>Spring在配置Bean中加入了@Configuration注解后，底层就会通过Cglib的代理方式，来进行对象相关的配置、处理
</code></pre></div>
<p><img alt="1641193103340-161e61e8-57bc-4d6c-b7bc-197abfa8ef87.png" src="../img/OXFJdF09t3S74GG_/1641193103340-161e61e8-57bc-4d6c-b7bc-197abfa8ef87-147217.png" /></p>
<h5 id="7_1">7. 四维一体的开发思想<a class="headerlink" href="#7_1" title="Permanent link">&para;</a></h5>
<h6 id="1_16">1. 什么是四维一体<a class="headerlink" href="#1_16" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>Spring开发一个功能的4种形式，虽然开发方式不同，但是最终效果是一样的。
<span class="k">1.</span> 基于schema
<span class="k">2.</span> 基于特定功能注解
<span class="k">3.</span> 基于原始&lt;bean
<span class="k">4.</span> 基于@Bean注解
</code></pre></div>
<h6 id="2_15">2. 四维一体的开发案例<a class="headerlink" href="#2_15" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="o">&lt;</span><span class="n">context</span><span class="p">:</span><span class="n">property</span><span class="o">-</span><span class="n">placehoder</span>
<span class="mf">2.</span><span class="w"> </span><span class="nd">@PropertySource</span><span class="w">  </span><span class="err">【</span><span class="n">推荐</span><span class="err">】</span>
<span class="mf">3.</span><span class="w"> </span><span class="o">&lt;</span><span class="n">bean</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="kd">class</span><span class="err">=&quot;</span><span class="nc">PropertySourcePlaceholderConfigure</span><span class="s">&quot;/&gt;</span>
<span class="s">4. @Bean            【推荐】</span>
</code></pre></div>
<h5 id="8-aop">8. 纯注解版AOP编程<a class="headerlink" href="#8-aop" title="Permanent link">&para;</a></h5>
<h6 id="1_17">1. 搭建环境<a class="headerlink" href="#1_17" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 应用配置Bean 
<span class="k">2.</span> 注解扫描
</code></pre></div>
<h6 id="2_16">2. 开发步骤<a class="headerlink" href="#2_16" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">原始对象</span>
<span class="w">   </span><span class="nd">@Service</span><span class="p">(</span><span class="nd">@Component</span><span class="p">)</span>
<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserService</span><span class="p">{</span>

<span class="w">   </span><span class="p">}</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">创建切面类</span><span class="w"> </span><span class="err">（</span><span class="n">额外功能</span><span class="w"> </span><span class="n">切入点</span><span class="w"> </span><span class="n">组装切面</span><span class="err">）</span>
<span class="w">    </span><span class="nd">@Aspect</span>
<span class="w">    </span><span class="nd">@Component</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyAspect</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&quot;execution(* login(..))&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">arround</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----aspect log ------&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>


<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">Spring的配置文件中</span>
<span class="w">   </span><span class="o">&lt;</span><span class="n">aop</span><span class="p">:</span><span class="n">aspectj</span><span class="o">-</span><span class="n">autoproxy</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">   </span><span class="nd">@EnableAspectjAutoProxy</span><span class="w"> </span><span class="o">---&gt;</span><span class="w"> </span><span class="n">配置Bean</span>
</code></pre></div>
<h6 id="3-aop">3. 注解AOP细节分析<a class="headerlink" href="#3-aop" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">代理创建方式的切换</span><span class="w"> </span><span class="n">JDK</span><span class="w"> </span><span class="n">Cglib</span><span class="w"> </span>
<span class="w">   </span><span class="o">&lt;</span><span class="n">aop</span><span class="p">:</span><span class="n">aspectj</span><span class="o">-</span><span class="n">autoproxy</span><span class="w"> </span><span class="n">proxy</span><span class="o">-</span><span class="n">target</span><span class="o">-</span><span class="kd">class</span><span class="err">=</span><span class="nc">true</span><span class="o">|</span><span class="kc">false</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">   </span><span class="nd">@EnableAspectjAutoProxy</span><span class="p">(</span><span class="n">proxyTargetClass</span><span class="p">)</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">SpringBoot</span><span class="w"> </span><span class="n">AOP的开发方式</span>
<span class="w">     </span><span class="nd">@EnableAspectjAutoProxy</span><span class="w"> </span><span class="n">已经设置好了</span><span class="w"> </span>

<span class="w">    </span><span class="mf">1.</span><span class="w"> </span><span class="n">原始对象</span>
<span class="w">     </span><span class="nd">@Service</span><span class="p">(</span><span class="nd">@Component</span><span class="p">)</span>
<span class="w">     </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">UserService</span><span class="p">{</span>

<span class="w">     </span><span class="p">}</span>
<span class="w">    </span><span class="mf">2.</span><span class="w"> </span><span class="n">创建切面类</span><span class="w"> </span><span class="err">（</span><span class="n">额外功能</span><span class="w"> </span><span class="n">切入点</span><span class="w"> </span><span class="n">组装切面</span><span class="err">）</span>
<span class="w">      </span><span class="nd">@Aspect</span>
<span class="w">      </span><span class="nd">@Component</span>
<span class="w">      </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyAspect</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&quot;execution(* login(..))&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">arround</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>

<span class="w">          </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;----aspect log ------&quot;</span><span class="p">);</span>

<span class="w">          </span><span class="n">Object</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>


<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="n">Spring</span><span class="w"> </span><span class="n">AOP</span><span class="w"> </span><span class="n">代理默认实现</span><span class="w"> </span><span class="n">JDK</span><span class="w">  </span><span class="n">SpringBOOT</span><span class="w"> </span><span class="n">AOP</span><span class="w"> </span><span class="n">代理默认实现</span><span class="w"> </span><span class="n">Cglib</span>
</code></pre></div>
<h6 id="4-aop">4. 自定义注解实现AOP<a class="headerlink" href="#4-aop" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.aop.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.annotation.*</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/9 19:59</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">RUNTIME</span><span class="p">)</span>
<span class="nd">@Target</span><span class="p">({</span><span class="n">ElementType</span><span class="p">.</span><span class="na">METHOD</span><span class="p">})</span>
<span class="nd">@Documented</span>
<span class="kd">public</span><span class="w"> </span><span class="nd">@interface</span><span class="w"> </span><span class="n">AopAnnotation</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//操作内容</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">operation</span><span class="p">()</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.aop.aspects</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.aop.anno.AopAnnotation</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.Signature</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.aspectj.lang.annotation.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Arrays</span><span class="p">;</span>

<span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LogUtilsAnno</span><span class="w"> </span><span class="p">{</span>


<span class="w">    </span><span class="nd">@Around</span><span class="p">(</span><span class="s">&quot;@annotation(annotation)&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">logUtil</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">,</span><span class="w"> </span><span class="n">AopAnnotation</span><span class="w"> </span><span class="n">annotation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="n">Signature</span><span class="w"> </span><span class="n">methodSignature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">getSignature</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">getArgs</span><span class="p">();</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;【&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">methodSignature</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;】方法开始执行，用的参数列表【&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;】&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joinPoint</span><span class="p">.</span><span class="na">proceed</span><span class="p">();</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;【&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">methodSignature</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;】方法正常执行完成，计算结果是：&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">throwable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;【&quot;</span><span class="o">+</span><span class="n">methodSignature</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;】方法执行出现异常了，异常信息是：&quot;</span><span class="o">+</span><span class="n">throwable</span><span class="p">.</span><span class="na">getCause</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;；这个异常已经通知测试小组进行排查&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">throwable</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;【&quot;</span><span class="o">+</span><span class="n">methodSignature</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;】方法最终结束了&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>


<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">Calculator</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">sub</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">mul</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">div</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.aop.impl</span><span class="p">;</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.aop.anno.AopAnnotation</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.aop.interfaces.Calculator</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyMathCalculator</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Calculator</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@AopAnnotation</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@AopAnnotation</span><span class="p">(</span><span class="n">operation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;减法&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">sub</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@AopAnnotation</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">mul</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//方法的兼容性；</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@AopAnnotation</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">div</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<h5 id="9-springmybatis">9. 纯注解版Spring+MyBatis整合<a class="headerlink" href="#9-springmybatis" title="Permanent link">&para;</a></h5>
<ul>
<li>基础配置 （配置Bean）  </li>
</ul>
<div class="highlight"><pre><span></span><code>1.<span class="w"> </span>连接池
<span class="w">  </span><span class="cm">&lt;!--连接池--&gt;</span>
<span class="w">  </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;driverClassName&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.mysql.jdbc.Driver&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;url&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;jdbc:mysql://localhost:3306/suns?useSSL=false&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;username&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;root&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;password&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;123456&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">   </span>@Bean
<span class="w">   </span>public<span class="w"> </span>DataSource<span class="w"> </span>dataSource(){
<span class="w">      </span>DruidDataSource<span class="w"> </span>dataSource<span class="w"> </span>=<span class="w"> </span>new<span class="w"> </span>DruidDataSource();
<span class="w">      </span>dataSource.setDriverClassName(&quot;&quot;);
<span class="w">      </span>dataSource.setUrl();
<span class="w">      </span>...
<span class="w">      </span>return<span class="w"> </span>dataSource;
<span class="w">   </span>}

2.<span class="w"> </span>SqlSessionFactoryBean
<span class="w">    </span><span class="cm">&lt;!--创建SqlSessionFactory SqlSessionFactoryBean--&gt;</span>
<span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;sqlSessionFactoryBean&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;typeAliasesPackage&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.baizhiedu.entity&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mapperLocations&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;list&gt;</span>
<span class="w">          </span><span class="nt">&lt;value&gt;</span>classpath:com.baizhiedu.mapper/*Mapper.xml<span class="nt">&lt;/value&gt;</span>
<span class="w">        </span><span class="nt">&lt;/list&gt;</span>
<span class="w">      </span><span class="nt">&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">    </span>@Bean
<span class="w">    </span>public<span class="w"> </span>SqlSessionFactoryBean<span class="w"> </span>sqlSessionFactoryBean(DataSource<span class="w"> </span>dataSource){
<span class="w">         </span>SqlSessionFactoryBean<span class="w"> </span>sqlSessionFactoryBean<span class="w"> </span>=<span class="w"> </span>new<span class="w"> </span>SqlSessionFactoryBean();
<span class="w">         </span>sqlSessionFactoryBean.setDataSource(dataSource);
<span class="w">         </span>sqlSessionFactoryBean.setTypeAliasesPackage(&quot;&quot;);
<span class="w">         </span>...
<span class="w">         </span>return<span class="w"> </span>sqlSessionFactoryBean;
<span class="w">    </span>}

3.<span class="w"> </span>MapperScannerConfigure<span class="w"> </span>
<span class="w">   </span><span class="cm">&lt;!--创建DAO对象 MapperScannerConfigure--&gt;</span>
<span class="w">  </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;scanner&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sqlSessionFactoryBeanName&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sqlSessionFactoryBean&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;basePackage&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.baizhiedu.dao&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">  </span>@MapperScan(basePackages={&quot;com.baizhiedu.dao&quot;})<span class="w"> </span>---&gt;<span class="w"> </span>配置bean完成
</code></pre></div>
<ul>
<li>编码      </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 实体
<span class="k">2.</span> 表
<span class="k">3.</span> DAO接口
<span class="k">4.</span> Mapper文件
</code></pre></div>
<h6 id="1-mapperlocations">1. MapperLocations编码时通配的写法<a class="headerlink" href="#1-mapperlocations" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="c1">//设置Mapper文件的路径</span>
<span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setMapperLocations</span><span class="p">(</span><span class="n">Resource</span><span class="p">..);</span>
<span class="n">Resource</span><span class="w"> </span><span class="n">resouce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassPathResouce</span><span class="p">(</span><span class="s">&quot;UserDAOMapper.xml&quot;</span><span class="p">)</span>

<span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setMapperLocations</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ClassPathResource</span><span class="p">(</span><span class="s">&quot;UserDAOMapper.xml&quot;</span><span class="p">));</span>

<span class="o">&lt;</span><span class="n">property</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;mapperLocations&quot;</span><span class="o">&gt;</span>
<span class="w">   </span><span class="o">&lt;</span><span class="n">list</span><span class="o">&gt;</span>
<span class="w">     </span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">classpath</span><span class="p">:</span><span class="n">com</span><span class="p">.</span><span class="na">baizhiedu</span><span class="p">.</span><span class="na">mapper</span><span class="o">/*</span><span class="n">Mapper</span><span class="p">.</span><span class="na">xml</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="w">   </span><span class="o">&lt;/</span><span class="n">list</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">property</span><span class="o">&gt;</span>
<span class="n">一组Mapper文件</span><span class="w"> </span>

<span class="n">ResourcePatternResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PathMatchingResourcePatternResolver</span><span class="p">();</span>
<span class="n">Resource</span><span class="o">[]</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolver</span><span class="p">.</span><span class="na">getResources</span><span class="p">(</span><span class="s">&quot;com.baizhi.mapper/*Mapper.xml&quot;</span><span class="p">);</span>
<span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setMapperLocations</span><span class="p">(</span><span class="n">resources</span><span class="p">)</span>
</code></pre></div>
<h6 id="2-bean_2">2. 配置Bean数据耦合的问题<a class="headerlink" href="#2-bean_2" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="n">mybatis</span><span class="p">.</span><span class="na">driverClassName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">mysql</span><span class="p">.</span><span class="na">jdbc</span><span class="p">.</span><span class="na">Driver</span>
<span class="n">mybatis</span><span class="p">.</span><span class="na">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdbc</span><span class="p">:</span><span class="n">mysql</span><span class="p">:</span><span class="c1">//localhost:3306/suns?useSSL=false</span>
<span class="n">mybatis</span><span class="p">.</span><span class="na">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span>
<span class="n">mybatis</span><span class="p">.</span><span class="na">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">123456</span>
<span class="n">mybatis</span><span class="p">.</span><span class="na">typeAliasesPackages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">baizhiedu</span><span class="p">.</span><span class="na">mybatis</span>
<span class="n">mybatis</span><span class="p">.</span><span class="na">mapperLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">baizhiedu</span><span class="p">.</span><span class="na">mapper</span><span class="o">/*</span><span class="n">Mapper</span><span class="p">.</span><span class="na">xml</span>

<span class="nd">@Component</span>
<span class="nd">@PropertySource</span><span class="p">(</span><span class="s">&quot;classpath:mybatis.properties&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MybatisProperties</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.driverClassName}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">driverClassName</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.url}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">url</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.username}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.password}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.typeAliasesPackages}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">typeAliasesPackages</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&quot;${mybatis.mapperLocations}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">mapperLocations</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyBatisAutoConfiguration</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MybatisProperties</span><span class="w"> </span><span class="n">mybatisProperties</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DataSource</span><span class="w"> </span><span class="nf">dataSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">DruidDataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DruidDataSource</span><span class="p">();</span>
<span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setDriverClassName</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getDriverClassName</span><span class="p">());</span>
<span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setUrl</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getUrl</span><span class="p">());</span>
<span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setUsername</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getUsername</span><span class="p">());</span>
<span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getPassword</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataSource</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="nf">sqlSessionFactoryBean</span><span class="p">(</span><span class="n">DataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="p">();</span>
<span class="w">        </span><span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setDataSource</span><span class="p">(</span><span class="n">dataSource</span><span class="p">);</span>
<span class="w">        </span><span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setTypeAliasesPackage</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getTypeAliasesPackages</span><span class="p">());</span>
<span class="w">        </span><span class="c1">//sqlSessionFactoryBean.setMapperLocations(new ClassPathResource(&quot;UserDAOMapper.xml&quot;));</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ResourcePatternResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PathMatchingResourcePatternResolver</span><span class="p">();</span>
<span class="w">            </span><span class="n">Resource</span><span class="o">[]</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolver</span><span class="p">.</span><span class="na">getResources</span><span class="p">(</span><span class="n">mybatisProperties</span><span class="p">.</span><span class="na">getMapperLocations</span><span class="p">());</span>
<span class="w">            </span><span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setMapperLocations</span><span class="p">(</span><span class="n">resources</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="10">10. 纯注解版事务编程<a class="headerlink" href="#10" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>1.<span class="w"> </span>原始对象<span class="w"> </span>XXXService
<span class="w">   </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.service.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">     </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">   </span>@Service
<span class="w">   </span>public<span class="w"> </span>class<span class="w"> </span>UserServiceImpl<span class="w"> </span>implements<span class="w"> </span>UserService{
<span class="w">         </span>@Autowired
<span class="w">         </span>private<span class="w"> </span>UserDAO<span class="w"> </span>userDAO;
<span class="w">   </span>}

2.<span class="w"> </span>额外功能
<span class="w">   </span><span class="cm">&lt;!--DataSourceTransactionManager--&gt;</span>
<span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">    </span>@Bean
<span class="w">    </span>public<span class="w"> </span>DataSourceTransactionManager<span class="w"> </span>dataSourceTransactionManager(DataSource<span class="w"> </span>dataSource){
<span class="w">          </span>DataSourceTransactionManager<span class="w"> </span>dstm<span class="w"> </span>=<span class="w"> </span>new<span class="w"> </span>DataSourceTransactionManager();
<span class="w">          </span>dstm.setDataSource(dataSource);
<span class="w">          </span>return<span class="w"> </span>dstm<span class="w"> </span>
<span class="w">    </span>}

3.<span class="w"> </span>事务属性
<span class="w">    </span>@Transactional
<span class="w">    </span>@Service
<span class="w">    </span>public<span class="w"> </span>class<span class="w"> </span>UserServiceImpl<span class="w"> </span>implements<span class="w"> </span>UserService<span class="w"> </span>{
<span class="w">        </span>@Autowired
<span class="w">        </span>private<span class="w"> </span>UserDAO<span class="w"> </span>userDAO;

4.<span class="w"> </span>基于Schema的事务配置<span class="w"> </span>
<span class="w">   </span><span class="nt">&lt;tx:annotation-driven</span><span class="w"> </span><span class="na">transaction-manager=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span>@EnableTransactionManager<span class="w"> </span>---&gt;<span class="w"> </span>配置Bean
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> ApplicationContext ctx = new AnnotationConfigApplicationContext(&quot;com.baizhiedu.mybatis&quot;);
   SpringBoot 实现思想
<span class="k">2.</span> 注解版MVC整合，SpringMVC中进行详细讲解
   SpringMyBatis ---&gt;DAO  事务基于注解 --&gt; Service   Controller 
   org.springframework.web.context.ContextLoaderListener ---&gt; XML工厂 无法提供 new AnnotationConfigApplicationContext
</code></pre></div>
<h5 id="11-springyml">11. Spring框架中YML的使用<a class="headerlink" href="#11-springyml" title="Permanent link">&para;</a></h5>
<h6 id="1-yml">1. 什么是YML<a class="headerlink" href="#1-yml" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>YML(YAML)是一种新形式的配置文件，比XML更简单，比Properties更强大。

YAML is a nice human-readable format for configuration, and it has some useful hierarchical properties. It&#39;s more or less a superset of JSON, so it has a lot of similar features.
</code></pre></div>
<h6 id="2-properties">2. Properties进行配置问题<a class="headerlink" href="#2-properties" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> Properties表达过于繁琐,无法表达数据的内在联系. 
<span class="k">2.</span> Properties无法表达对象 集合类型
</code></pre></div>
<h6 id="3-yml">3. YML语法简介<a class="headerlink" href="#3-yml" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">1. 定义yml文件</span><span class="w"> </span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">xxx.yml xxx.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">2. 语法</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">1. 基本语法</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">suns</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">123456</span>
<span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">2. 对象概念</span><span class="w"> </span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">account</span><span class="p p-Indicator">:</span><span class="w"> </span>
<span class="w">         </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">         </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">123456</span>
<span class="w w-Error">   </span><span class="l l-Scalar l-Scalar-Plain">3. 定义集合</span><span class="w"> </span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">service</span><span class="p p-Indicator">:</span><span class="w"> </span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11111</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">22222</span>
</code></pre></div>
<h6 id="4-springyml">4. Spring与YML集成思路的分析<a class="headerlink" href="#4-springyml" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 准备yml配置文件 
   init.yml
   name: suns
   password: 123456
<span class="k">2.</span> 读取yml 转换成 Properties
   YamlPropertiesFactoryBean.setResources( yml配置文件的路径 ) new ClassPathResource();
   YamlPropertiesFactoryBean.getObject() ---&gt; Properties 
<span class="k">3.</span> 应用PropertySourcesPlaceholderConfigurer
   PropertySourcesPlaceholderConfigurer.setProperties();
<span class="k">4.</span> 类中 <span class="ni">@Value注解</span> 注入
</code></pre></div>
<h6 id="5-springyml">5. Spring与YML集成编码<a class="headerlink" href="#5-springyml" title="Permanent link">&para;</a></h6>
<ul>
<li>环境搭建  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.yaml<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>snakeyaml<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.23<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
最低版本<span class="w"> </span>1.18
</code></pre></div>
<ul>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">准备yml配置文件</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">配置Bean中操作</span><span class="w"> </span><span class="n">完成YAML读取</span><span class="w"> </span><span class="n">与</span><span class="w"> </span><span class="n">PropertySourcePlaceholderConfigure的创建</span><span class="w"> </span>
<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PropertySourcesPlaceholderConfigurer</span><span class="w"> </span><span class="nf">configurer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">YamlPropertiesFactoryBean</span><span class="w"> </span><span class="n">yamlPropertiesFactoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">YamlPropertiesFactoryBean</span><span class="p">();</span>
<span class="w">        </span><span class="n">yamlPropertiesFactoryBean</span><span class="p">.</span><span class="na">setResources</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ClassPathResource</span><span class="p">(</span><span class="s">&quot;init.yml&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">Properties</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yamlPropertiesFactoryBean</span><span class="p">.</span><span class="na">getObject</span><span class="p">();</span>

<span class="w">        </span><span class="n">PropertySourcesPlaceholderConfigurer</span><span class="w"> </span><span class="n">configurer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertySourcesPlaceholderConfigurer</span><span class="p">();</span>
<span class="w">        </span><span class="n">configurer</span><span class="p">.</span><span class="na">setProperties</span><span class="p">(</span><span class="n">properties</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">configurer</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">类</span><span class="w"> </span><span class="n">加入</span><span class="w"> </span><span class="nd">@Value注解</span>
</code></pre></div>
<h6 id="6-springyml">6. Spring与YML集成的问题<a class="headerlink" href="#6-springyml" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 集合处理的问题
   SpringEL表达式解决
   <span class="ni">@Value</span>(&quot;#{&#39;${list}&#39;.split(&#39;,&#39;)}&quot;)
<span class="k">2.</span> 对象类型的YAML进行配置时 过于繁琐 
   <span class="ni">@Value</span>(&quot;${account.name}&quot;)

SpringBoot  <span class="ni">@ConfigurationProperties</span>
</code></pre></div>
<h5 id="conditional">@Conditional注解<a class="headerlink" href="#conditional" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Conditional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.Period</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:05</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Configuration</span>
<span class="c1">//类中组件统一设置。满足当前条件，这个类中配置的所有bean注册才能生效；</span>
<span class="c1">//@Conditional({WindowsCondition.class})</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * @Conditional({Condition}) ： 按照一定的条件进行判断，满足条件给容器中注册bean</span>
<span class="cm">     *</span>
<span class="cm">     * 如果系统是windows，给容器中注册(&quot;bill&quot;)</span>
<span class="cm">     * 如果是linux系统，给容器中注册(&quot;linux&quot;)</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Bean</span><span class="p">(</span><span class="s">&quot;bill&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@Conditional</span><span class="p">({</span><span class="n">WindowsCondition</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="nf">person01</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;bill&quot;</span><span class="p">,</span><span class="s">&quot;Windows&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span><span class="p">(</span><span class="s">&quot;linux&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@Conditional</span><span class="p">({</span><span class="n">LinuxCondition</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="nf">person02</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="s">&quot;linux&quot;</span><span class="p">,</span><span class="s">&quot;linux&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.config.ConfigurableListableBeanFactory</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.support.BeanDefinitionRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Condition</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.ConditionContext</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.env.Environment</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.type.AnnotatedTypeMetadata</span><span class="p">;</span>

<span class="c1">//判断是否linux系统</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LinuxCondition</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ConditionContext：判断条件能使用的上下文（环境）</span>
<span class="cm">     * AnnotatedTypeMetadata：注释信息</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="n">ConditionContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AnnotatedTypeMetadata</span><span class="w"> </span><span class="n">metadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO是否linux系统</span>
<span class="w">        </span><span class="c1">//1、能获取到ioc使用的beanfactory</span>
<span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getBeanFactory</span><span class="p">();</span>
<span class="w">        </span><span class="c1">//2、获取类加载器</span>
<span class="w">        </span><span class="n">ClassLoader</span><span class="w"> </span><span class="n">classLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">();</span>
<span class="w">        </span><span class="c1">//3、获取当前环境信息</span>
<span class="w">        </span><span class="n">Environment</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getEnvironment</span><span class="p">();</span>
<span class="w">        </span><span class="c1">//4、获取到bean定义的注册类</span>
<span class="w">        </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getRegistry</span><span class="p">();</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;os.name&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//可以判断容器中的bean注册情况，也可以给容器中注册bean</span>
<span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="na">containsBeanDefinition</span><span class="p">(</span><span class="s">&quot;person&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">property</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;linux&quot;</span><span class="p">)){</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Condition</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.ConditionContext</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.env.Environment</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.type.AnnotatedTypeMetadata</span><span class="p">;</span>

<span class="c1">//判断是否windows系统</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WindowsCondition</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">matches</span><span class="p">(</span><span class="n">ConditionContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">AnnotatedTypeMetadata</span><span class="w"> </span><span class="n">metadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Environment</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getEnvironment</span><span class="p">();</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;os.name&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">property</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;Windows&quot;</span><span class="p">)){</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:03</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//他们创造的操作系统</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">system</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Test:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.ConditionBeanConfig</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.Person</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>
<span class="kd">class</span> <span class="nc">SbApplicationTests</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test01</span><span class="p">(){</span>
<span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">ConditionBeanConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanNamesForType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">Person</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanNamesForType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;s = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Person</span><span class="o">&gt;</span><span class="w"> </span><span class="n">beansOfType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeansOfType</span><span class="p">(</span><span class="n">Person</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beansOfType = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beansOfType</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<h6 id="conditionalonbean-beanbean">@ConditionalOnBean : 给定的在bean存在时,则实例化当前Bean<a class="headerlink" href="#conditionalonbean-beanbean" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanNameForTypes</span><span class="w"> </span><span class="o">=</span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">xxx</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="c1">//查看容器中有没有这个xxx组件</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">pritln</span><span class="p">(</span><span class="n">beanNameForTypes</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
</code></pre></div>
<h6 id="conditionalonmissingbean-beanbean">@ConditionalOnMissingBean: 当给定的在bean不存在时,则实例化当前Bean<a class="headerlink" href="#conditionalonmissingbean-beanbean" title="Permanent link">&para;</a></h6>
<h6 id="conditionalonclass-bean">@ConditionalOnClass: 当给定的类名在类路径上存在，则实例化当前Bean<a class="headerlink" href="#conditionalonclass-bean" title="Permanent link">&para;</a></h6>
<h6 id="conditionalonmissingclass-bean">@ConditionalOnMissingClass :当给定的类名在类路径上不存在，则实例化当前Bean<a class="headerlink" href="#conditionalonmissingclass-bean" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="nd">@Configuration</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Demo</span><span class="w"> </span><span class="nf">Demo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Demo</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="nd">@ConditionalOnBean</span><span class="p">(</span><span class="n">Demo</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="c1">//有Bean就加载</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ClassAA</span><span class="w"> </span><span class="nf">classAA</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassAA</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="nd">@ConditionalOnMissingBean</span><span class="p">(</span><span class="n">Demo</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="c1">//没有Bean就加载</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ClassBB</span><span class="w"> </span><span class="nf">ClassBB</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassBB</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="nd">@ConditionalOnClass</span><span class="p">(</span><span class="n">Demo</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="c1">//有class就加载</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ClassC</span><span class="w"> </span><span class="nf">classC</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassC</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="nd">@ConditionalOnMissingClass</span><span class="p">(</span><span class="s">&quot;com.xzh.customer.technical.boot.MyConditionBeanConfig&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">//没有class就加载</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ClassD</span><span class="w"> </span><span class="nf">classD</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassD</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="nd">@ConditionalOnMissingClass</span><span class="p">(</span><span class="s">&quot;com.xzh.customer.technical.boot.MyConditionBeanConfig.NoThisBean.class&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ClassE</span><span class="w"> </span><span class="nf">classE</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ClassE</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Demo</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassAA</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassBB</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassC</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassD</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ClassE</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@SpringBootTest</span><span class="p">(</span><span class="n">classes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CustomerApplication</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="nd">@RunWith</span><span class="p">(</span><span class="n">SpringRunner</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="nd">@WebAppConfiguration</span>
<span class="nd">@Slf4j</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionTest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Autowired</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyConditionBeanConfig</span><span class="p">.</span><span class="na">ClassAA</span><span class="w"> </span><span class="n">classA</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Autowired</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyConditionBeanConfig</span><span class="p">.</span><span class="na">ClassBB</span><span class="w"> </span><span class="n">classB</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Autowired</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyConditionBeanConfig</span><span class="p">.</span><span class="na">ClassC</span><span class="w"> </span><span class="n">classC</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Autowired</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyConditionBeanConfig</span><span class="p">.</span><span class="na">ClassD</span><span class="w"> </span><span class="n">classD</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Autowired</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyConditionBeanConfig</span><span class="p">.</span><span class="na">ClassE</span><span class="w"> </span><span class="n">classE</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;classA: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">classA</span><span class="p">);</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;classB: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">classB</span><span class="p">);</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;classC: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">classC</span><span class="p">);</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;classD: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">classD</span><span class="p">);</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;classE: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">classE</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>测试</p>
<p><img alt="1641482876532-308a8813-9ae4-47c1-99f4-60deb39d526f.png" src="../img/OXFJdF09t3S74GG_/1641482876532-308a8813-9ae4-47c1-99f4-60deb39d526f-105274.png" /></p>
<p>将MyConditionBeanConfig中Demo类的@Bean注解注释掉：</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1">//@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Demo</span><span class="w"> </span><span class="nf">Demo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Demo</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>测试结果：</p>
<p><img alt="1641482917110-bd530b04-49d4-4d1a-bc59-e3dee6f184aa.png" src="../img/OXFJdF09t3S74GG_/1641482917110-bd530b04-49d4-4d1a-bc59-e3dee6f184aa-151938.png" /></p>
<h5 id="import">@Import注解:给容器中注册组<a class="headerlink" href="#import" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 给容器中注册组件；</span>
<span class="cm">     * 1）、包扫描+组件标注注解（@Controller/@Service/@Repository/@Component）[自己写的类]</span>
<span class="cm">     * 2）、@Bean[导入的第三方包里面的组件]</span>
<span class="cm">     * 3）、@Import[快速给容器中导入一个组件]</span>
<span class="cm">     *      1）、@Import(要导入到容器中的组件)；容器中就会自动注册这个组件，id默认是全类名</span>
<span class="cm">     *      2）、ImportSelector:返回需要导入的组件的全类名数组；</span>
<span class="cm">     *      3）、ImportBeanDefinitionRegistrar:手动注册bean到容器中</span>
<span class="cm">     * 4）、使用Spring提供的 FactoryBean（工厂Bean）;</span>
<span class="cm">     *      1）、默认获取到的是工厂bean调用getObject创建的对象</span>
<span class="cm">     *      2）、要获取工厂Bean本身，我们需要给id前面加一个&amp;</span>
<span class="cm">     *          &amp;colorFactoryBean</span>
<span class="cm">     */</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.imports</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:36</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Color</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//颜色</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:05</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="c1">//导入一个Color组件</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
<p>Test:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test01</span><span class="p">(){</span>
<span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">ConditionBeanConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beanDefinitionName = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h6 id="import-importselector">@import 中的属性 importselector<a class="headerlink" href="#import-importselector" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.bean</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/5 8:37</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Yellow</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.bean</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/5 8:36</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Blue</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.imports</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.ImportSelector</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.type.AnnotationMetadata</span><span class="p">;</span>

<span class="c1">//自定义逻辑返回需要导入的组件</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyImportSelector</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ImportSelector</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//返回值，就是到导入到容器中的组件全类名</span>
<span class="w">    </span><span class="c1">//AnnotationMetadata:当前标注@Import注解的类的所有注解信息</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">selectImports</span><span class="p">(</span><span class="n">AnnotationMetadata</span><span class="w"> </span><span class="n">importingClassMetadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO Auto-generated method stub</span>
<span class="w">        </span><span class="c1">//importingClassMetadata</span>
<span class="w">        </span><span class="c1">//方法不要返回null值</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="p">{</span><span class="s">&quot;com.bh.anno.bean.Blue&quot;</span><span class="p">,</span><span class="s">&quot;com.bh.anno.bean.Yellow&quot;</span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>


<span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.Color</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.imports.MyImportSelector</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Conditional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:05</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="p">({</span><span class="n">MyImportSelector</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="c1">//Test</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test01</span><span class="p">(){</span>
<span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">ConditionBeanConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beanDefinitionName = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h6 id="importbeandefinitionregistrar">ImportBeanDefinitionRegistrar<a class="headerlink" href="#importbeandefinitionregistrar" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.config</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.RainBow</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.support.BeanDefinitionRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.support.RootBeanDefinition</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.ImportBeanDefinitionRegistrar</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.type.AnnotationMetadata</span><span class="p">;</span>



<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyImportBeanDefinitionRegistrar</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ImportBeanDefinitionRegistrar</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * AnnotationMetadata：当前类的注解信息</span>
<span class="cm">     * BeanDefinitionRegistry:BeanDefinition注册类；</span>
<span class="cm">     *      把所有需要添加到容器中的bean；调用</span>
<span class="cm">     *      BeanDefinitionRegistry.registerBeanDefinition手工注册进来</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanDefinitions</span><span class="p">(</span><span class="n">AnnotationMetadata</span><span class="w"> </span><span class="n">importingClassMetadata</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="na">containsBeanDefinition</span><span class="p">(</span><span class="s">&quot;com.bh.anno.bean.Red&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">definition2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="na">containsBeanDefinition</span><span class="p">(</span><span class="s">&quot;com.bh.anno.bean.Blue&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">definition</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">definition2</span><span class="p">){</span>
<span class="w">            </span><span class="c1">//指定Bean定义信息；（Bean的类型，Bean。。。）</span>
<span class="w">            </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">beanDefinition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="p">(</span><span class="n">RainBow</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">            </span><span class="c1">//注册一个Bean，指定bean名</span>
<span class="w">            </span><span class="n">registry</span><span class="p">.</span><span class="na">registerBeanDefinition</span><span class="p">(</span><span class="s">&quot;rainBow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>


<span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.Color</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.Red</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.config.MyImportBeanDefinitionRegistrar</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.imports.MyImportSelector</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Conditional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:05</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Configuration</span>
<span class="nd">@Import</span><span class="p">({</span><span class="n">Red</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MyImportSelector</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MyImportBeanDefinitionRegistrar</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>
<span class="p">}</span>

<span class="c1">//Test</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test01</span><span class="p">(){</span>
<span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">ConditionBeanConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beanDefinitionName = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h6 id="factorybean">FactoryBean<a class="headerlink" href="#factorybean" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno.bean</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.FactoryBean</span><span class="p">;</span>

<span class="c1">//创建一个Spring定义的FactoryBean</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ColorFactoryBean</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">FactoryBean</span><span class="o">&lt;</span><span class="n">Color</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//返回一个Color对象，这个对象会添加到容器中</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Color</span><span class="w"> </span><span class="nf">getObject</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO Auto-generated method stub</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;ColorFactoryBean...getObject...&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Color</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="nf">getObjectType</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO Auto-generated method stub</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//是单例？</span>
<span class="w">    </span><span class="c1">//true：这个bean是单实例，在容器中保存一份</span>
<span class="w">    </span><span class="c1">//false：多实例，每次获取都会创建一个新的bean；</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSingleton</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO Auto-generated method stub</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>



<span class="kn">package</span><span class="w"> </span><span class="nn">com.bh.anno</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.Color</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.ColorFactoryBean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.bean.Red</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.config.MyImportBeanDefinitionRegistrar</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.bh.anno.imports.MyImportSelector</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Bean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Conditional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * @author ：HB</span>
<span class="cm"> * @date ：Created in 2022/1/4 21:05</span>
<span class="cm"> * @description：</span>
<span class="cm"> */</span>
<span class="nd">@Configuration</span>
<span class="c1">//类中组件统一设置。满足当前条件，这个类中配置的所有bean注册才能生效；</span>
<span class="c1">//@Conditional({WindowsCondition.class})</span>
<span class="nd">@Import</span><span class="p">({</span><span class="n">Red</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MyImportSelector</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">MyImportBeanDefinitionRegistrar</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ConditionBeanConfig</span><span class="w"> </span><span class="p">{</span>


<span class="w">    </span><span class="nd">@Bean</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ColorFactoryBean</span><span class="w"> </span><span class="nf">colorFactoryBean</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ColorFactoryBean</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">//Test</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test01</span><span class="p">(){</span>
<span class="w">        </span><span class="n">AnnotationConfigApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AnnotationConfigApplicationContext</span><span class="p">(</span><span class="n">ConditionBeanConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanDefinitionNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;beanDefinitionName = &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinitionName</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h4 id="springboot">第四章 SpringBoot中的注解<a class="headerlink" href="#springboot" title="Permanent link">&para;</a></h4>
<h5 id="1-enableconfigurationproperties">1. <font style="color:rgb(64, 64, 64);">@EnableConfigurationProperties</font><a class="headerlink" href="#1-enableconfigurationproperties" title="Permanent link">&para;</a></h5>
<p><font style="color:rgb(64, 64, 64);">@EnableConfigurationProperties注解的作用是：使 使用 @ConfigurationProperties 注解的类生效。也可以理解为开启</font>@ConfigurationProperties，或者使@ConfigurationProperties注解生效。</p>
<p><font style="color:rgb(64, 64, 64);">tips: </font><font style="color:rgb(64, 64, 64);">@EnableConfigurationProperties+@Configuration + </font>@ConfigurationProperties<font style="color:rgb(64, 64, 64);">一起使用</font></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.InetAddress</span><span class="p">;</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.context.properties.ConfigurationProperties</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.context.properties.EnableConfigurationProperties</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>

<span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="s">&quot;my.service&quot;</span><span class="p">)</span>
<span class="nd">@Configuration</span>
<span class="nd">@EnableConfigurationProperties</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyProperties</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//默认是false</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//默认是null</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">InetAddress</span><span class="w"> </span><span class="n">remoteAddress</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>使用yaml进行修改默认值：</p>
<div class="highlight"><pre><span></span><code><span class="nt">my</span><span class="p">:</span>
<span class="w">  </span><span class="nt">service</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">remote-address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
</code></pre></div>
<p>测试：</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/testProperties&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">testProperties</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">myProperties</span><span class="p">.</span><span class="na">getRemoteAddress</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="n">myProperties</span><span class="p">.</span><span class="na">isEnabled</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="c1">//http://localhost:8080/testProperties</span>
<span class="n">输出</span><span class="err">：</span><span class="o">/</span><span class="mf">127.0.0.1</span><span class="kc">true</span>
</code></pre></div>
<h5 id="2-configurationproperties">2. <font style="color:rgb(64, 64, 64);">@ConfigurationProperties</font><a class="headerlink" href="#2-configurationproperties" title="Permanent link">&para;</a></h5>
<p><a href="https://www.cnblogs.com/jimoer/p/11374229.html">https://www.cnblogs.com/jimoer/p/11374229.html</a></p>
<p><font style="color:rgb(0, 0, 0);">在编写项目代码时，我们要求更灵活的配置，更好的模块化整合。在 Spring Boot 项目中，为满足以上要求，我们将大量的参数配置在 application.properties 或 application.yml 文件中，通过 </font><font style="color:rgb(232, 62, 140);background-color:rgb(246, 246, 246);">@ConfigurationProperties</font><font style="color:rgb(0, 0, 0);"> 注解，我们可以方便的获取这些参数值。</font></p>
<p><font style="color:rgb(0, 0, 0);"></font></p>
<p>作用是：将类的属性与yaml进行绑定。</p>
<h5 id="3-configurationpropertiesscan">3. <font style="color:rgb(36, 41, 46);">@ConfigurationPropertiesScan</font><a class="headerlink" href="#3-configurationpropertiesscan" title="Permanent link">&para;</a></h5>
<p><font style="color:rgb(36, 41, 46);">@ConfigurationPropertiesScan  （标注在启动类中）+</font>@ConfigurationProperties</p>
<div class="highlight"><pre><span></span><code><span class="nd">@SpringBootApplication</span>
<span class="nd">@ConfigurationPropertiesScan</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SbApplication</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">SbApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.InetAddress</span><span class="p">;</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.context.properties.ConfigurationProperties</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.context.properties.EnableConfigurationProperties</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Configuration</span><span class="p">;</span>

<span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="s">&quot;my.service&quot;</span><span class="p">)</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyProperties</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">InetAddress</span><span class="w"> </span><span class="n">remoteAddress</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="-importresourcespring"><font style="color:rgb(79, 79, 79);">底层注解-@ImportResource导入Spring配置文件</font><a class="headerlink" href="#-importresourcespring" title="Permanent link">&para;</a></h5>
<p><font style="color:rgb(77, 77, 77);">比如，公司使用bean.xml文件生成配置bean，然而你为了省事，想继续复用bean.xml，</font><font style="color:rgb(232, 62, 140);background-color:rgb(246, 246, 246);">@ImportResource</font><font style="color:rgb(77, 77, 77);">粉墨登场。</font></p>
<p><font style="color:rgb(77, 77, 77);">bean.xml：</font></p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;beans</span><span class="w"> </span><span class="err">...&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;haha&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.lun.boot.bean.User&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;zhangsan&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;age&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;18&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;/bean&gt;</span>

<span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;hehe&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.lun.boot.bean.Pet&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;tomcat&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;/bean&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div>
<p><font style="color:rgb(77, 77, 77);">使用方法：</font></p>
<div class="highlight"><pre><span></span><code>@ImportResource(&quot;classpath:beans.xml&quot;)
public<span class="w"> </span>class<span class="w"> </span>MyConfig<span class="w"> </span>{
...
}
</code></pre></div>
<p><font style="color:rgb(77, 77, 77);">测试类：</font></p>
<div class="highlight"><pre><span></span><code>public<span class="w"> </span>static<span class="w"> </span>void<span class="w"> </span>main(String[]<span class="w"> </span>args)<span class="w"> </span>{
<span class="w">    </span>//1、返回我们IOC容器
<span class="w">    </span>ConfigurableApplicationContext<span class="w"> </span>run<span class="w"> </span>=<span class="w"> </span>SpringApplication.run(MainApplication.class,<span class="w"> </span>args);

<span class="w">    </span>boolean<span class="w"> </span>haha<span class="w"> </span>=<span class="w"> </span>run.containsBean(&quot;haha&quot;);
<span class="w">    </span>boolean<span class="w"> </span>hehe<span class="w"> </span>=<span class="w"> </span>run.containsBean(&quot;hehe&quot;);
<span class="w">    </span>System.out.println(&quot;haha：&quot;+haha);//true
<span class="w">    </span>System.out.println(&quot;hehe：&quot;+hehe);//true
}
</code></pre></div>
<h3 id="spring_8">Spring系列 — 持久层整合<a class="headerlink" href="#spring_8" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="_9">第一章、持久层整合<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<h5 id="1spring">1.Spring框架为什么要与持久层技术进行整合<a class="headerlink" href="#1spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> JavaEE开发需要持久层进行数据库的访问操作。
<span class="k">2.</span> JDBC Hibernate MyBatis进行持久开发过程存在大量的代码冗余
<span class="k">3.</span> Spring基于模板设计模式对于上述的持久层技术进行了封装
</code></pre></div>
<h5 id="2-spring_2">2. Spring可以与那些持久层技术进行整合？<a class="headerlink" href="#2-spring_2" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> JDBC
     |-  JDBCTemplate 
<span class="k">2.</span> Hibernate (JPA)
     |-  HibernateTemplate
<span class="k">3.</span> MyBatis
     |-  SqlSessionFactoryBean MapperScannerConfigure
</code></pre></div>
<h4 id="springmybatis">第二章、Spring与MyBatis整合<a class="headerlink" href="#springmybatis" title="Permanent link">&para;</a></h4>
<h5 id="1-mybatis">1. MyBatis开发步骤的回顾<a class="headerlink" href="#1-mybatis" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 实体
<span class="k">2.</span> 实体别名  
<span class="k">3.</span> 表
<span class="k">4.</span> 创建DAO接口
<span class="k">5.</span> 实现Mapper文件
<span class="k">6.</span> 注册Mapper文件
<span class="k">7.</span> MybatisAPI调用
</code></pre></div>
<h5 id="2-mybatis">2. Mybatis在开发过程中存在问题<a class="headerlink" href="#2-mybatis" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>配置繁琐  代码冗余 

<span class="k">1.</span> 实体
<span class="k">2.</span> 实体别名         配置繁琐 
<span class="k">3.</span> 表
<span class="k">4.</span> 创建DAO接口
<span class="k">5.</span> 实现Mapper文件
<span class="k">6.</span> 注册Mapper文件   配置繁琐 
<span class="k">7.</span> MybatisAPI调用  代码冗余
</code></pre></div>
<h5 id="3-springmybatis">3. Spring与Mybatis整合思路分析<a class="headerlink" href="#3-springmybatis" title="Permanent link">&para;</a></h5>
<p><img alt="1641193246664-c4318ead-778b-4933-84df-d751a2b0ad57.png" src="../img/OXFJdF09t3S74GG_/1641193246664-c4318ead-778b-4933-84df-d751a2b0ad57-164976.png" /></p>
<h5 id="4-springmybatis">4. Spring与Mybatis整合的开发步骤<a class="headerlink" href="#4-springmybatis" title="Permanent link">&para;</a></h5>
<ul>
<li>配置文件（ApplicationContext.xml) 进行相关配置  </li>
</ul>
<div class="highlight"><pre><span></span><code>#配置<span class="w"> </span>是需要配置一次<span class="w"> </span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span><span class="w"> </span>

<span class="cm">&lt;!--创建SqlSessionFactory--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;ssfb&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;SqlSessionFactoryBean&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;typeAliasesPackage&quot;</span><span class="nt">&gt;</span>
<span class="w">         </span>指定<span class="w"> </span>实体类所在的包<span class="w">  </span>com.baizhiedu.entity<span class="w">  </span>User
<span class="w">                                                 </span>Product
<span class="w">    </span><span class="nt">&lt;/property&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mapperLocations&quot;</span><span class="nt">&gt;</span>
<span class="w">          </span>指定<span class="w"> </span>配置文件(映射文件)的路径<span class="w"> </span>还有通用配置<span class="w"> </span>
<span class="w">          </span>com.baizhiedu.mapper/*Mapper.xml<span class="w"> </span>
<span class="w">    </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--DAO接口的实现类</span>
<span class="cm">    session ---&gt;</span><span class="w"> </span>session.getMapper()<span class="w"> </span>---<span class="w"> </span>xxxDAO实现类对象<span class="w"> </span>
<span class="w">    </span>XXXDAO<span class="w">  </span>---&gt;<span class="w"> </span>xXXDAO
--&gt;
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;scanner&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;MapperScannerConfigure&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sqlSessionFactoryBeanName&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;ssfb&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;basePacakge&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>指定<span class="w"> </span>DAO接口放置的包<span class="w">  </span>com.baizhiedu.dao<span class="w"> </span>
<span class="w">    </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<ul>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="gh"># 实战经常根据需求 写的代码</span>
<span class="k">1.</span> 实体
<span class="k">2.</span> 表
<span class="k">3.</span> 创建DAO接口
<span class="k">4.</span> 实现Mapper文件
</code></pre></div>
<h5 id="5-springmybatis">5. Spring与Mybatis整合编码<a class="headerlink" href="#5-springmybatis" title="Permanent link">&para;</a></h5>
<ul>
<li>搭建开发环境(jar)  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>spring-jdbc<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>5.1.14.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>mybatis-spring<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>2.0.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>com.alibaba<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>druid<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>1.1.18<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>5.1.48<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>3.4.6<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<ul>
<li>Spring配置文件的配置  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!--连接池--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;driverClassName&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.mysql.jdbc.Driver&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;url&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;jdbc:mysql://localhost:3306/suns?useSSL=false&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;username&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;root&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;password&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;123456&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--创建SqlSessionFactory SqlSessionFactoryBean--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;sqlSessionFactoryBean&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;typeAliasesPackage&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.baizhiedu.entity&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;mapperLocations&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;list&gt;</span>
<span class="w">      </span><span class="nt">&lt;value&gt;</span>classpath:com.baizhiedu.mapper/*Mapper.xml<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;/list&gt;</span>
<span class="w">  </span><span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--创建DAO对象 MapperScannerConfigure--&gt;</span>

<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;scanner&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;sqlSessionFactoryBeanName&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;sqlSessionFactoryBean&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;basePackage&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;com.baizhiedu.dao&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div>
<ul>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 实体
<span class="k">2.</span> 表
<span class="k">3.</span> DAO接口
<span class="k">4.</span> Mapper文件配置
</code></pre></div>
<h5 id="6-springmybatis">6. Spring与Mybatis整合细节<a class="headerlink" href="#6-springmybatis" title="Permanent link">&para;</a></h5>
<ul>
<li>问题：Spring与Mybatis整合后，为什么DAO不提交事务，但是数据能够插入数据库中？  </li>
</ul>
<div class="highlight"><pre><span></span><code>Connection --&gt; tx
Mybatis(Connection)

本质上控制连接对象(Connection) ---&gt; 连接池(DataSource)
<span class="k">1.</span> Mybatis提供的连接池对象 ---&gt; 创建Connection
     Connection.setAutoCommit(false) 手工的控制了事务 ， 操作完成后，手工提交
<span class="k">2.</span> Druid（C3P0 DBCP）作为连接池        ---&gt; 创建Connection
     Connection.setAutoCommit(true) true默认值 保持自动控制事务，一条sql 自动提交 
答案：因为Spring与Mybatis整合时，引入了外部连接池对象，保持自动的事务提交这个机制(Connection.setAutoCommit(true)),不需要手工进行事务的操作，也能进行事务的提交 

注意：未来实战中，还会手工控制事务(多条sql一起成功，一起失败)，后续Spring通过事务控制解决这个问题。
</code></pre></div>
<h4 id="spring_9">第三章、Spring的事务处理<a class="headerlink" href="#spring_9" title="Permanent link">&para;</a></h4>
<h5 id="1_18">1. 什么是事务？<a class="headerlink" href="#1_18" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>保证业务操作完整性的一种数据库机制

事务的4特点： A C I D
<span class="k">1.</span> A 原子性
<span class="k">2.</span> C 一致性
<span class="k">3.</span> I 隔离性
<span class="k">4.</span> D 持久性
</code></pre></div>
<h5 id="2_17">2. 如何控制事务<a class="headerlink" href="#2_17" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>JDBC:
    Connection.setAutoCommit(false);
    Connection.commit();
    Connection.rollback();
Mybatis：
    Mybatis自动开启事务

    sqlSession(Connection).commit();
    sqlSession(Connection).rollback();

结论：控制事务的底层 都是Connection对象完成的。
</code></pre></div>
<h5 id="3spring">3.Spring控制事务的开发<a class="headerlink" href="#3spring" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>Spring是通过AOP的方式进行事务开发
</code></pre></div>
<h6 id="1_19">1. 原始对象<a class="headerlink" href="#1_19" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>public class XXXUserServiceImpl{
   private xxxDAO xxxDAO
   set get

<span class="w">   </span><span class="k">1.</span> 原始对象 ---》 原始方法 ---》核心功能 (业务处理+DAO调用)
<span class="w">   </span><span class="k">2.</span> DAO作为Service的成员变量，依赖注入的方式进行赋值
}
</code></pre></div>
<h6 id="2_18">2. 额外功能<a class="headerlink" href="#2_18" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> org.springframework.jdbc.datasource.DataSourceTransactionManager
<span class="k">2.</span> 注入DataSource 
<span class="k">1.</span> MethodInterceptor
   public Object invoke(MethodInvocation invocation){
      try{
        Connection.setAutoCommit(false);
        Object ret = invocation.proceed();
        Connection.commit();
      }catch(Exception e){
        Connection.rollback();
      }
        return ret;
   }
<span class="k">2.</span> <span class="ni">@Aspect</span>
   <span class="ni">@Around</span>
</code></pre></div>
<h6 id="3_7">3. 切入点<a class="headerlink" href="#3_7" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>@Transactional 
事务的额外功能加入给那些业务方法。

1. 类上：类中所有的方法都会加入事务
2. 方法上：这个方法会加入事务
</code></pre></div>
<h6 id="4_4">4 组装切面<a class="headerlink" href="#4_4" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 切入点
<span class="k">2.</span> 额外功能

&lt;tx:annotation-driven transaction-manager=&quot;&quot;/&gt;
</code></pre></div>
<h5 id="4-spring_2">4. Spring控制事务的编码<a class="headerlink" href="#4-spring_2" title="Permanent link">&para;</a></h5>
<ul>
<li>搭建开发环境 (jar)  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;dependency&gt;</span>
<span class="w">  </span><span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
<span class="w">  </span><span class="nt">&lt;artifactId&gt;</span>spring-tx<span class="nt">&lt;/artifactId&gt;</span>
<span class="w">  </span><span class="nt">&lt;version&gt;</span>5.1.14.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>
<ul>
<li>编码  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.service.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--DataSourceTransactionManager--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

@Transactional
public<span class="w"> </span>class<span class="w"> </span>UserServiceImpl<span class="w"> </span>implements<span class="w"> </span>UserService<span class="w"> </span>{
<span class="w">    </span>private<span class="w"> </span>UserDAO<span class="w"> </span>userDAO;

<span class="nt">&lt;tx:annotation-driven</span><span class="w"> </span><span class="na">transaction-manager=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<ul>
<li>细节  </li>
</ul>
<div class="highlight"><pre><span></span><code>&lt;tx:annotation-driven transaction-manager=&quot;dataSourceTransactionManager&quot; proxy-target-class=&quot;true&quot;/&gt;
进行动态代理底层实现的切换   proxy-target-class
    默认 false JDK
        true  Cglib
</code></pre></div>
<h4 id="springtransaction-attribute">第四章、 Spring中的事务属性(Transaction Attribute)<a class="headerlink" href="#springtransaction-attribute" title="Permanent link">&para;</a></h4>
<h5 id="1_20">1. 什么是事务属性<a class="headerlink" href="#1_20" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>属性：描述物体特征的一系列值
     性别 身高 体重 ...
事务属性：描述事务特征的一系列值 
<span class="k">1.</span> 隔离属性
<span class="k">2.</span> 传播属性
<span class="k">3.</span> 只读属性
<span class="k">4.</span> 超时属性
<span class="k">5.</span> 异常属性
</code></pre></div>
<h5 id="2_19">2. 如何添加事务属性<a class="headerlink" href="#2_19" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="ni">@Transactional</span>(isloation=,propagation=,readOnly=,timeout=,rollbackFor=,noRollbackFor=,)
</code></pre></div>
<h5 id="3_8">3. 事务属性详解<a class="headerlink" href="#3_8" title="Permanent link">&para;</a></h5>
<h6 id="1-isolation">1. 隔离属性 (ISOLATION)<a class="headerlink" href="#1-isolation" title="Permanent link">&para;</a></h6>
<ul>
<li>隔离属性的概念  </li>
</ul>
<div class="highlight"><pre><span></span><code>概念：他描述了事务解决并发问题的特征
<span class="k">1.</span> 什么是并发
       多个事务(用户)在同一时间，访问操作了相同的数据

       同一时间：0.000几秒 微小前 微小后
<span class="k">2.</span> 并发会产生那些问题
<span class="w">       </span><span class="k">1.</span> 脏读
<span class="w">       </span><span class="k">2.</span> 不可重复读
<span class="w">       </span><span class="k">3.</span> 幻影读
<span class="k">3.</span> 并发问题如何解决
       通过隔离属性解决，隔离属性中设置不同的值，解决并发处理过程中的问题。
</code></pre></div>
<ul>
<li>事务并发产生的问题 <ul>
<li>脏读  </li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code>一个事务，读取了另一个事务中没有提交的数据。会在本事务中产生数据不一致的问题
解决方案  <span class="ni">@Transactional</span>(isolation=Isolation.READ_COMMITTED)
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  不可重复读
</code></pre></div>
<div class="highlight"><pre><span></span><code>一个事务中，多次读取相同的数据，但是读取结果不一样。会在本事务中产生数据不一致的问题
注意：1 不是脏读 2 一个事务中
解决方案 <span class="ni">@Transactional</span>(isolation=Isolation.REPEATABLE_READ)
本质： 一把行锁
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  幻影读
</code></pre></div>
<div class="highlight"><pre><span></span><code>一个事务中，多次对整表进行查询统计，但是结果不一样，会在本事务中产生数据不一致的问题
解决方案 <span class="ni">@Transactional</span>(isolation=Isolation.SERIALIZABLE)
本质：表锁
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  总结
</code></pre></div>
<div class="highlight"><pre><span></span><code>并发安全： SERIALIZABLE&gt;REPEATABLE_READ&gt;READ_COMMITTED
运行效率： READ_COMMITTED&gt;REPEATABLE_READ&gt;SERIALIZABLE
</code></pre></div>
<ul>
<li>数据库对于隔离属性的支持   </li>
</ul>
<table>
<thead>
<tr>
<th>隔离属性的值</th>
<th>MySQL</th>
<th>Oracle</th>
</tr>
</thead>
<tbody>
<tr>
<td>ISOLATION_READ_COMMITTED</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>IOSLATION_REPEATABLE_READ</td>
<td>✅</td>
<td>❎</td>
</tr>
<tr>
<td>ISOLATION_SERIALIZABLE</td>
<td>✅</td>
<td>✅</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code>Oracle不支持REPEATABLE_READ值 如何解决不可重复读
采用的是多版本比对的方式 解决不可重复读的问题
</code></pre></div>
<ul>
<li>默认隔离属性  </li>
</ul>
<div class="highlight"><pre><span></span><code>ISOLATION_DEFAULT：会调用不同数据库所设置的默认隔离属性

MySQL : REPEATABLE_READ 
Oracle: READ_COMMITTED
</code></pre></div>
<div class="highlight"><pre><span></span><code>-  查看数据库默认隔离属性 
    *  MySQL
</code></pre></div>
<div class="highlight"><pre><span></span><code>select @@tx_isolation;
</code></pre></div>
<div class="highlight"><pre><span></span><code>    *  Oracle
</code></pre></div>
<div class="highlight"><pre><span></span><code>SELECT s.sid, s.serial#,
   CASE BITAND(t.flag, POWER(2, 28))
      WHEN 0 THEN &#39;READ COMMITTED&#39;
      ELSE &#39;SERIALIZABLE&#39;
   END AS isolation_level
FROM v$transaction t 
JOIN v$session s ON t.addr = s.taddr
AND s.sid = sys_context(&#39;USERENV&#39;, &#39;SID&#39;);
</code></pre></div>
<ul>
<li>隔离属性在实战中的建议  </li>
</ul>
<div class="highlight"><pre><span></span><code>推荐使用Spring指定的ISOLATION_DEFAULT
<span class="w"> </span><span class="k">1.</span> MySQL   repeatable_read
<span class="w"> </span><span class="k">2.</span> Oracle  read_commited 

未来实战中，并发访问情况 很低 

如果真遇到并发问题，乐观锁 
   Hibernate(JPA)  Version 
   MyBatis         通过拦截器自定义开发
</code></pre></div>
<h6 id="2-propagation">2. 传播属性(PROPAGATION)<a class="headerlink" href="#2-propagation" title="Permanent link">&para;</a></h6>
<ul>
<li>传播属性的概念  </li>
</ul>
<div class="highlight"><pre><span></span><code>概念：他描述了事务解决嵌套问题的特征

什么叫做事务的嵌套：他指的是一个大的事务中，包含了若干个小的事务

问题：大事务中融入了很多小的事务，他们彼此影响，最终就会导致外部大的事务，丧失了事务的原子性
</code></pre></div>
<ul>
<li>传播属性的值及其用法  </li>
</ul>
<table>
<thead>
<tr>
<th>传播属性的值</th>
<th>外部不存在事务</th>
<th>外部存在事务</th>
<th>用法</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>REQUIRED</td>
<td>开启新的事务</td>
<td>融合到外部事务中</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.REQUIRED">@Transactional(propagation </a></td>
<td>增删改方法</td>
</tr>
<tr>
<td>SUPPORTS</td>
<td>不开启事务</td>
<td>融合到外部事务中</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.SUPPORTS">@Transactional(propagation </a></td>
<td>查询方法</td>
</tr>
<tr>
<td>REQUIRES_NEW</td>
<td>开启新的事务</td>
<td>挂起外部事务，创建新的事务</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.REQUIRES_NEW">@Transactional(propagation </a></td>
<td>日志记录方法中</td>
</tr>
<tr>
<td>NOT_SUPPORTED</td>
<td>不开启事务</td>
<td>挂起外部事务</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.NOT_SUPPORTED">@Transactional(propagation </a></td>
<td>及其不常用</td>
</tr>
<tr>
<td>NEVER</td>
<td>不开启事务</td>
<td>抛出异常</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.NEVER">@Transactional(propagation </a></td>
<td>及其不常用</td>
</tr>
<tr>
<td>MANDATORY</td>
<td>抛出异常</td>
<td>融合到外部事务中</td>
<td><a href="/Transactional(propagation )&lt;br/&gt; = Propagation.MANDATORY">@Transactional(propagation </a></td>
<td>及其不常用</td>
</tr>
</tbody>
</table>
<ul>
<li>默认的传播属性  </li>
</ul>
<div class="highlight"><pre><span></span><code>REQUIRED是传播属性的默认值
</code></pre></div>
<ul>
<li>推荐传播属性的使用方式  </li>
</ul>
<div class="highlight"><pre><span></span><code>增删改 方法：直接使用默认值REQUIRED 
查询   操作：显示指定传播属性的值为SUPPORTS
</code></pre></div>
<h6 id="3-readonly">3. 只读属性(readOnly)<a class="headerlink" href="#3-readonly" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>针对于只进行查询操作的业务方法，可以加入只读属性，提供运行效率

默认值：false
</code></pre></div>
<h6 id="4-timeout">4. 超时属性(timeout)<a class="headerlink" href="#4-timeout" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>指定了事务等待的最长时间

<span class="k">1.</span> 为什么事务进行等待？
   当前事务访问数据时，有可能访问的数据被别的事务进行加锁的处理，那么此时本事务就必须进行等待。
<span class="k">2.</span> 等待时间 秒
<span class="k">3.</span> 如何应用 <span class="ni">@Transactional</span>(timeout=2)
<span class="k">4.</span> 超时属性的默认值 -1 
   最终由对应的数据库来指定
</code></pre></div>
<h6 id="5_3">5. 异常属性<a class="headerlink" href="#5_3" title="Permanent link">&para;</a></h6>
<div class="highlight"><pre><span></span><code>Spring事务处理过程中
默认 对于RuntimeException及其子类 采用的是回滚的策略
默认 对于Exception及其子类 采用的是提交的策略

rollbackFor = {java.lang.Exception,xxx,xxx} 
noRollbackFor = {java.lang.RuntimeException,xxx,xx}

<span class="ni">@Transactional</span>(rollbackFor = {java.lang.Exception.class},noRollbackFor = {java.lang.RuntimeException.class})

建议：实战中使用RuntimeExceptin及其子类 使用事务异常属性的默认值
</code></pre></div>
<h5 id="4_5">4. 事务属性常见配置总结<a class="headerlink" href="#4_5" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="k">1.</span> 隔离属性   默认值 
<span class="k">2.</span> 传播属性   Required(默认值) 增删改   Supports 查询操作
<span class="k">3.</span> 只读属性   readOnly false  增删改   true 查询操作
<span class="k">4.</span> 超时属性   默认值 -1
<span class="k">5.</span> 异常属性   默认值 

增删改操作   <span class="ni">@Transactional</span>
查询操作     <span class="ni">@Transactional</span>(propagation=Propagation.SUPPORTS,readOnly=true)
</code></pre></div>
<h5 id="5_4">5. 基于标签的事务配置方式(事务开发的第二种形式)<a class="headerlink" href="#5_4" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>基于注解<span class="w"> </span>@Transaction的事务配置回顾
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.service.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--DataSourceTransactionManager--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

@Transactional(isolation=,propagation=,...)
public<span class="w"> </span>class<span class="w"> </span>UserServiceImpl<span class="w"> </span>implements<span class="w"> </span>UserService<span class="w"> </span>{
<span class="w">    </span>private<span class="w"> </span>UserDAO<span class="w"> </span>userDAO;

<span class="nt">&lt;tx:annotation-driven</span><span class="w"> </span><span class="na">transaction-manager=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="nt">/&gt;</span>

基于标签的事务配置
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.service.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--DataSourceTransactionManager--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

事务属性<span class="w"> </span>
<span class="nt">&lt;tx:advice</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;txAdvice&quot;</span><span class="w"> </span><span class="na">transacation-manager=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;tx:attributes&gt;</span>
<span class="w">          </span><span class="nt">&lt;tx:method</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;register&quot;</span><span class="w"> </span><span class="na">isoloation=</span><span class="s">&quot;&quot;</span><span class="err">,</span><span class="na">propagation=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;/tx:method&gt;</span>
<span class="w">          </span><span class="nt">&lt;tx:method</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;login&quot;</span><span class="w"> </span><span class="err">.....</span><span class="nt">&gt;&lt;/tx:method&gt;</span>
<span class="w">          </span>等效于<span class="w"> </span>
<span class="w">          </span>@Transactional(isolation=,propagation=,)
<span class="w">          </span>public<span class="w"> </span>void<span class="w"> </span>register(){

<span class="w">          </span>}

<span class="w">    </span><span class="nt">&lt;/tx:attributes&gt;</span>
<span class="nt">&lt;/tx:advice&gt;</span>

<span class="nt">&lt;aop:config&gt;</span>
<span class="w">     </span><span class="nt">&lt;aop:pointcut</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;pc&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;execution(* com.baizhiedu.service.UserServiceImpl.register(..))&quot;</span><span class="nt">&gt;&lt;/aop:pointcut&gt;</span>
<span class="w">     </span><span class="nt">&lt;aop:advisor</span><span class="w"> </span><span class="na">advice-ref=</span><span class="s">&quot;txAdvice&quot;</span><span class="w"> </span><span class="na">pointcut-ref=</span><span class="s">&quot;pc&quot;</span><span class="nt">&gt;&lt;/aop:advisor&gt;</span>
<span class="nt">&lt;/aop:config&gt;</span>
</code></pre></div>
<ul>
<li>基于标签的事务配置在实战中的应用方式  </li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;userService&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.baizhiedu.service.UserServiceImpl&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;userDAO&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;userDAO&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="cm">&lt;!--DataSourceTransactionManager--&gt;</span>
<span class="nt">&lt;bean</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dataSource&quot;</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;dataSource&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

编程时候<span class="w"> </span>service中负责进行增删改操作的方法<span class="w"> </span>都以modify开头
<span class="w">                       </span>查询操作<span class="w"> </span>命名无所谓<span class="w"> </span>
<span class="nt">&lt;tx:advice</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;txAdvice&quot;</span><span class="w"> </span><span class="na">transacation-manager=</span><span class="s">&quot;dataSourceTransactionManager&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;tx:attributes&gt;</span>
<span class="w">          </span><span class="nt">&lt;tx:method</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;register&quot;</span><span class="nt">&gt;&lt;/tx:method&gt;</span>
<span class="w">          </span><span class="nt">&lt;tx:method</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;modify*&quot;</span><span class="nt">&gt;&lt;/tx:method&gt;</span>
<span class="w">          </span><span class="nt">&lt;tx:method</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="na">propagation=</span><span class="s">&quot;SUPPORTS&quot;</span><span class="w">  </span><span class="na">read-only=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/tx:method&gt;</span>
<span class="w">    </span><span class="nt">&lt;/tx:attributes&gt;</span>
<span class="nt">&lt;/tx:advice&gt;</span>

应用的过程中，service放置到service包中
<span class="nt">&lt;aop:config&gt;</span>
<span class="w">     </span><span class="nt">&lt;aop:pointcut</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;pc&quot;</span><span class="w"> </span><span class="na">expression=</span><span class="s">&quot;execution(* com.baizhiedu.service..*.*(..))&quot;</span><span class="nt">&gt;&lt;/aop:pointcut&gt;</span>
<span class="w">     </span><span class="nt">&lt;aop:advisor</span><span class="w"> </span><span class="na">advice-ref=</span><span class="s">&quot;txAdvice&quot;</span><span class="w"> </span><span class="na">pointcut-ref=</span><span class="s">&quot;pc&quot;</span><span class="nt">&gt;&lt;/aop:advisor&gt;</span>
<span class="nt">&lt;/aop:config&gt;</span>
</code></pre></div>
<h6 id="_10"><a class="headerlink" href="#_10" title="Permanent link">&para;</a></h6>
<h6 id="_11"><a class="headerlink" href="#_11" title="Permanent link">&para;</a></h6>
<h6 id="_12"><a class="headerlink" href="#_12" title="Permanent link">&para;</a></h6>
<p></p>
<h5 id="_13"><a class="headerlink" href="#_13" title="Permanent link">&para;</a></h5>
<blockquote>
<p>更新: 2022-01-09 20:35:36<br />
原文: <a href="https://www.yuque.com/u12209896/it1egr/ggkp9r">https://www.yuque.com/u12209896/it1egr/ggkp9r</a></p>
</blockquote>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>