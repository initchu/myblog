# 0 面向对象

## 抽象思想
**抽象**始终贯穿在编程里面，是一种编程思想，即把一类事务的共有属性（字段）和行为（方法）提取出来，形成一个物理模型（模板），这种研究问题的方法被称为**抽象（****<font style="color:rgb(51, 51, 51);">Abstraction）</font>**。<font style="color:rgb(51, 51, 51);">一个类就是这样一种</font>[抽象](https://baike.baidu.com/item/%E6%8A%BD%E8%B1%A1/9021815#viewPageContent)<font style="color:rgb(51, 51, 51);">，它反映了与应用有关的重要性质，而忽略其他一些无关内容。任何类的划分都是主观的，但必须与具体的应用有关。</font>

[Go语言基础：结构体和方法](https://www.yuque.com/xiaoshan_wgo/fpuzg3/pywlu9)

Go中没有类的概念，是结构体的概念。

结构体定义实例：

```go
package model
type UserInfo struct{
    Name string
    Age int
    Height float32
    Eduschool string
    Hobby []string
    MoreInfo map[string] interface{}
}
```

```go
package main
Alice := model.UserInfo{
    Name: "Alice",
    Age := 18,
    Height: 160,
    Eduschool:"华中师范大学",
    Hobby: []string{"coding","dancing"},
    MoreInfo: nil,
}
fmt.Println(Alice.Name,Alice.Age)
```

注： model包的使用，其中定义了UserInfo结构体。

## 封装 - 方法和工厂模式
封装就是把抽象出的**字段和对字段的操作**封装在一起，数据被保护在内部，程序的其他包只有通过被授权的操作（方法），才能对字段进行操作。目的是，不对外暴露公开的接口，增强安全，简化编程。

Go语言中可以使用[工厂模式](https://www.yuque.com/xiaoshan_wgo/fpuzg3/smo4ix)来生成对象，或者说Go语言用工厂模式来实现封装：

```go
//对上面的那个结构体进行封装，使用下面的这个方法就是被授权的操作，这样就实现了对字段的保护。
func NewUserInfo(name string, age int, height float32, eduSchool string, hobby []string,moreInfo map[string]interface{}) *userInfo{
    return &userInfo{
    	Name: name,
    	Age := age,
    	Height: height,
    	Eduschool: eduSchool,
    	Hobby: hobby,
    	MoreInfo: moreInfo,
        
    }
}
```

这样外部可以直接调用`NewUserInfo`而可以不需要调用`UserInfo`，使用工厂模式的时候将首字母大写的`UserInfo`修改为`userInfo`，在Go语言中，首字母大写为公开类/结构体/方法。使用工厂模式/继承的办法，就可以实现安全和简化编程。

## 继承 - 匿名结构体
继承解决了代码复用的问题。

子类继承父类，自动拥有父类的属性和方法。

重写，父类引用指向子类对象。

在Golang中，继承的实现方法是使用**匿名结构体**，这个结构体可以直接访问匿名结构体的字段和方法，从而实现继承特性。

基本语法如下：

```go
type Goods struct{
    Name string
    Price int
}
type Book struct{
    Goods //这个就是匿名结构体
    Write string
}
```

具体的案例使用

```go
package main
type Student struct{
    Name string
    Age int
    Score int
}
func (stu *Student) ShowInfo{
    fmt.Println(stu.Name,stu.Age,stu.Score)
}
func (stu *Student) SetScore(score int){
    stu.Score = score //把设置的参数赋值给对象的字段
}
type Pupil struct{
    Student //嵌入匿名结构体
}
func(p *Pupil)testing(){
    fmt.Println("Pupil is testing")
}
type Graduate struct{
    Student //嵌入匿名结构体
}
func(p *Graduate)testing(){
    fmt.Println("Graduate is testing")
}
func main(){
    pupil := &Pupil{}
    pupil.Student.Name = "Tom~"
    pupil.Student.Age = 8
    pupil.testing()
    pupil.Student.SetSocre(70)//pupil继承了Student的方法SetScore
    pupil.Student.ShowInfo()
    
    graduate := &Graduate{}
    graduate.Student.Name = "Bob~"
    graduate.Student.Age = 28
    graduate.testing()
    graduate.Student.SetSocre(80)//pupil继承了Student的方法SetScore
    graduate.Student.ShowInfo()
}
```

注意事项:

（1）结构体可以使用嵌套结构体所有字段和方法，不论首字母的大小写都可以使用。

（2）匿名结构体字段访问是可以简化的，如上述的代码`graduate.Student.Age`可以直接写成`graduate.Age`。

（3）当结构体和匿名结构体有相同的字段和方法的时候，采用**就近原则**。所以有时候，赋值字段的时候要明确是匿名结构体的字段（或方法）还是结构体的字段（或方法）。

（4）结构体嵌入**两个或多个**匿名结构体（匿名结构体之间不同名），如果两个匿名结构体有相同的字段和方法，则**必须指名**匿名结构体的名字，否则编译报错。

（5）如果struct嵌套了一个有名结构体，这种模式就是**组合**，如果是组合关系，那么在访问组合的结构体的字段和方法的时候，就必须带上结构体名字。

（6）嵌套匿名结构体后，也可以在创建结构体变量（实例）时，直接指定各个匿名结构体字段的值。例如：

```go
package main
type Student struct{
    Name string
    Age int
    Score int
}
type Pupil struct{
    *Student //嵌入匿名结构体
}
pupil := Pupil{&Student{Name: "Toms",
                       Age : 8,
                       Score: 90
                      },
              }
fmt.Println("pupil",*Pupil.Student) //不加*，那么输出的就是地址，而不是值，如果有多个匿名函数取地址了，那么需要在后面再加一个*Puppil.xxxxx。
```

## 多态 - 接口
多态就是，多种形态，Go中，通过接口来实现。

[1 接口](https://www.yuque.com/xiaoshan_wgo/gonotes/kybspv)

在Go语言中，多态特征是通过接口实现的，**可以按照统一的接口来调用不同的实现，这时接口的变量就呈现不同的形态**。我们在实现接口方法过程中，**括号里面的变量**会根据传入的参数来判断到底要实现的是哪个实例的方法，这样就可以实现一个方法多个实例使用（多态）。

接口体现多态有两种形式：

+ 多态参数：
    - 比如在接口的Usb案例中，既可以接收手机变量，又可以接收相机变量，这就体现了Usb接口多态。
+ 多态数组：
    - 比如在Usb数组中，存放Phone结构体和Computer结构体变量。

```go
package main
type Usber interface{ //接口和它的两个没有实现的方法
    Start()
    Stop()
}
type Phone struct{
}
type Camera struct{
}

func (p Phone) Start(){ //程序员1写的方法
	fmt.Println("手机开始工作。。")
}
func (p Phone) Stop(){//程序员2写的方法
	fmt.Println("手机停止工作。。")
}

func (c Camera) Start(){
	fmt.Println("相机开始工作。。")
}
func (c Camera) Stop(){
	fmt.Println("相机停止工作。。")
}

func main(){
    var usbArr [3]Usb //多态数组
    usbArr[0] = Phone{"vivo"}
    usbArr[1] = Phone{"小米"}
    usbArr[2] = Camera{"尼康"}
}
```





> 更新: 2022-10-21 09:11:01  
> 原文: <https://www.yuque.com/xiaoshan_wgo/codingnotes/mume7m>